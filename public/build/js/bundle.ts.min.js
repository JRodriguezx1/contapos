"use strict";const mobilemenu=document.querySelector("#mobile-menu"),sidebar=document.querySelector(".sidebar"),btnmenux=document.querySelector("#mobile-menux"),barra=document.querySelector(".barra-mobile"),nametop=document.querySelector(".nametop");window.POS=window.POS||{},mobilemenu&&mobilemenu.addEventListener("click",(function(){sidebar&&barra&&(sidebar.classList.toggle("mostrar"),barra.classList.toggle("ocultarmenu"))})),btnmenux&&btnmenux.addEventListener("click",(function(){sidebar&&barra&&(sidebar.classList.toggle("mostrar"),barra.classList.toggle("ocultarmenu"))})),document.querySelector(".sidebartoggle").addEventListener("click",e=>{sidebar&&(null==sidebar||sidebar.classList.toggle("minsidebar")),nametop&&nametop.classList.toggle("noneElement"),$(".btnav").toggleClass("noneElement")});const configdatatables={paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}},configdatatables25reg={pageLength:25,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}},configdatatablesgenerico={layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"informe"},{extend:"csvHtml5",title:"informe"},{extend:"pdfHtml5",title:"informe"},{extend:"print",title:"informe",text:"Imprimir"},"colvis"],pageLength:"pageLength"}},pageLength:25,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}},configdatatablesstockrapido={layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",exportOptions:{columns:[1,2,3,4,5]},title:"Stock-inventario"},{extend:"csvHtml5",exportOptions:{columns:[1,2,3,4,5]},title:"Stock-inventario"},{extend:"pdfHtml5",exportOptions:{columns:[1,2,3,4,5]},title:"Stock-inventario"},{extend:"print",exportOptions:{columns:[1,3,4]},title:"Stock-inventario",text:"Imprimir"},"colvis"],pageLength:"pageLength"}},pageLength:25,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}},configdatatablesajustarcostos={layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",exportOptions:{columns:[1,3,4,5,6]},title:"costo por producto"},{extend:"csvHtml5",exportOptions:{columns:[1,3,4,5,6]},title:"costo por producto"},{extend:"pdfHtml5",exportOptions:{columns:[1,3,4,5,6]},title:"costo por producto"},{extend:"print",exportOptions:{columns:[1,3,4,5,6]},title:"costo por producto",text:"Imprimir"},"colvis"],pageLength:"pageLength"}},pageLength:25,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}},configdatatablescaja={paging:!1,order:[[3,"desc"]],searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando 1 de _MAX_ registros",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}};function msjAlert(e,t,o){o.insertAdjacentHTML("beforeend",`<div class="alerta alerta__${e}">\n      <p><i class="fa-solid fa-circle-exclamation"></i> ${t}</p></div>`),borrarMsjAlert(o)}function borrarMsjAlert(e){document.querySelector(".alerta")&&setTimeout(()=>{for(;e.firstChild;)e.removeChild(e.firstChild)},5e3)}function msjalertToast(e,t,o){Swal.fire({icon:e,title:t,text:o,toast:!0,position:"top-end",showConfirmButton:!1,timer:2700})}if(document.querySelectorAll(".count-charts").forEach(e=>{var t;e.textContent=(parseInt(e.dataset.num)-e.previousElementSibling.value.length).toString(),null===(t=e.previousElementSibling)||void 0===t||t.addEventListener("input",t=>{if(e.textContent=parseInt(e.dataset.num)-t.target.value.length+"",parseInt(e.dataset.num)-t.target.value.length<=0){let o=t.target.value.slice(0,parseInt(e.dataset.num));t.target.value=o,e.textContent="0"}})}),document.querySelector("#tabulacion")){const e=document.querySelector('#tabulacion input[type="radio"]:checked').nextElementSibling;document.querySelector("."+e.id).style.display="block";const t=document.querySelectorAll(".tabs span"),o=document.querySelectorAll(".paginas");t.forEach(e=>{e.addEventListener("click",e=>{const t=e.target;o.forEach(e=>e.style.display="none"),document.querySelector("."+t.id).style.display="block"})})}function mesyañoactual(){const e=new Date;return[e.toLocaleString("es-CO",{month:"long"}),e.getFullYear()]}var __awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t,o;if(document.querySelector(".clientes")){const a=document.querySelector("#crearCliente"),i=document.querySelector("#crearDireccion"),r=document.querySelector("#miDialogoCliente"),d=document.querySelector("#miDialogoCrearDireccion"),c=document.querySelector("#miDialogoUpDireccion"),l=document.querySelector("#selectdirecciones"),s=document.querySelector("#btnCerrarUpDireccion");let u,m,p=0,v=0,f=[],g=[];function n(e){e.target!==r&&e.target!==d&&e.target!==c&&"salir"!==e.target.value||(r.close(),d.close(),c.close(),document.removeEventListener("click",n))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allclientes",t=yield fetch(e);g=yield t.json(),console.log(g)}catch(e){console.log(e)}})),u=$("#tablaClientes").DataTable(configdatatables),null==a||a.addEventListener("click",e=>{v=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateCliente"))||void 0===e||e.reset()}(),document.querySelector("#modalCliente").textContent="Crear cliente",document.querySelector("#btnEditarCrearCliente").value="Crear",r.showModal(),document.addEventListener("click",n)}),null==i||i.addEventListener("click",e=>{v=0,document.querySelector("#modalDireccion").textContent="Crear direccion",document.querySelector("#btnEditarCrearDireccion").value="Crear",d.showModal(),document.addEventListener("click",n),$("#selectcliente").select2({dropdownParent:$("#miDialogoCrearDireccion"),placeholder:"Seleccionar el cliente",maximumSelectionLength:1})}),null===(e=document.querySelector("#tablaClientes"))||void 0===e||e.addEventListener("click",e=>{var t,o,a,i;const d=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarClientes"))||(null===(o=e.target.parentElement)||void 0===o?void 0:o.classList.contains("editarClientes")))&&function(e){var t,o,a,i,d,c,l,s,u;let p=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(o=e.target)||void 0===o?void 0:o.tagName)&&(p=null===(i=null===(a=e.target.parentElement)||void 0===a?void 0:a.parentElement)||void 0===i?void 0:i.id);v=1,document.querySelector("#modalCliente").textContent="Actualizar cliente",document.querySelector("#btnEditarCrearCliente").value="Actualizar",m=g.find(e=>e.id===p),document.querySelector("#nombre").value=null==m?void 0:m.nombre,document.querySelector("#apellido").value=null==m?void 0:m.apellido,$("#tipodocumento").val(null!==(d=null==m?void 0:m.tipodocumento)&&void 0!==d?d:""),document.querySelector("#identificacion").value=null!==(c=null==m?void 0:m.identificacion)&&void 0!==c?c:"",document.querySelector("#telefono").value=null!==(l=null==m?void 0:m.telefono)&&void 0!==l?l:"",document.querySelector("#email").value=null!==(s=null==m?void 0:m.email)&&void 0!==s?s:"",document.querySelector("#fecha_nacimiento").value=null!==(u=null==m?void 0:m.fecha_nacimiento)&&void 0!==u?u:"",r.showModal(),document.addEventListener("click",n)}(e),((null==d?void 0:d.classList.contains("eliminarClientes"))||(null===(a=d.parentElement)||void 0===a?void 0:a.classList.contains("eliminarClientes")))&&function(e){let t=e.target.parentElement.id,o=u.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);p=u.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el cliente?",text:"El cliente sera eliminado por completo.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarCliente",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(u.row(p+o.start).remove().draw(),u.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e),((null==d?void 0:d.classList.contains("editarEliminarDireccion"))||(null===(i=d.parentElement)||void 0===i?void 0:i.classList.contains("editarEliminarDireccion")))&&function(e){let t=e.target.parentElement.id;u.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/direccionesXcliente?id="+t,o=yield fetch(e),n=yield o.json();f=n,function(e){for(;null==l?void 0:l.firstChild;)l.removeChild(null==l?void 0:l.firstChild);e.forEach(e=>{const t=document.createElement("option");t.textContent=e.direccion,t.value=e.id,t.dataset.idcliente=e.idcliente,t.dataset.idtarifa=e.idtarifa,l.appendChild(t)}),$("#uptarifa").val(e[0].idtarifa),document.querySelector("#updepartamento").value=e[0].departamento,document.querySelector("#upciudad").value=e[0].ciudad,document.querySelector("#updireccion").value=e[0].direccion}(n)}catch(e){console.log(e)}}))})(),c.showModal(),document.addEventListener("click",n)}(e)}),null===(t=document.querySelector("#formCrearUpdateCliente"))||void 0===t||t.addEventListener("submit",e=>{if(v){e.preventDefault();var t=u.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",m.id),e.append("nombre",$("#nombre").val()),e.append("apellido",$("#apellido").val()),e.append("tipodocumento",$("#tipodocumento").val()),e.append("identificacion",$("#identificacion").val()),e.append("telefono",$("#telefono").val()),e.append("email",$("#email").val()),e.append("fecha_nacimiento",$("#fecha_nacimiento").val());try{const o="/admin/api/actualizarCliente",a=yield fetch(o,{method:"POST",body:e}),i=yield a.json();if(console.log(i),void 0!==i.exito){msjalertToast("success","¡Éxito!",i.exito[0]),g.forEach(e=>{e.id==m.id&&(e=Object.assign(e,i.cliente[0]))});const e=u.row(p).data();e[1]=$("#nombre").val(),e[2]=$("#apellido").val(),e[3]=$("#telefono").val(),e[4]=$("#email").val(),u.row(p).data(e).draw(),u.page(t.page).draw("page")}else msjalertToast("error","¡Error!",i.error[0]);r.close(),document.removeEventListener("click",n)}catch(e){console.log(e)}}))}}),null==l||l.addEventListener("change",e=>{var t;const o=e.target,n=o.options[o.selectedIndex].value,a=f.find(e=>e.id==n);$("#uptarifa").val(null!==(t=null==a?void 0:a.idtarifa)&&void 0!==t?t:1),document.querySelector("#updepartamento").value=a.departamento,document.querySelector("#upciudad").value=a.ciudad,document.querySelector("#updireccion").value=a.direccion}),null===(o=document.querySelector("#formUpDireccion"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault()}),s.addEventListener("click",()=>c.close())}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};!function(){if(document.querySelector(".inicio")){function e(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const o=yield fetch(e),n=yield o.json();"ventasVsGastos"==t&&function(e){const t=document.getElementById("chartVentasGastos").getContext("2d");new Chart(t,{data:{labels:e.periodo,datasets:[{type:"bar",label:"Ventas",data:e.ventastotales,backgroundColor:"rgba(239,68,68,0.8)"},{type:"line",label:"Gastos",data:e.gastostotales,borderColor:"#4F46E5",backgroundColor:"rgba(79,70,229,0.15)",tension:.3,fill:!0,yAxisID:"y1"}]},options:{responsive:!0,plugins:{legend:{position:"bottom"}},scales:{y:{beginAtZero:!0,position:"left",title:{display:!0,text:"Ventas (COP)"}},y1:{beginAtZero:!0,position:"right",grid:{drawOnChartArea:!1},title:{display:!0,text:"Gastos (COP)"}}}}})}(n),"ultimos7dias"==t&&function(e){const t=document.getElementById("chartIngresosDias").getContext("2d");new Chart(t,{type:"bar",data:{labels:e.map(e=>e.dia),datasets:[{label:"Ingresos",data:e.map(e=>e.ventas_totales),backgroundColor:"#10B981"}]},options:{responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})}(n)}catch(e){console.log(e)}}))}e("/admin/api/ventasVsGastos","ventasVsGastos"),e("/admin/api/ultimos7dias","ultimos7dias")}}();const mobilemenu1=document.querySelector("#mobile-menu1"),miDialogomenumovil=document.querySelector("#miDialogomenumovil");function cerrarDialogoExterno(e){e.target===miDialogomenumovil&&(miDialogomenumovil.close(),miDialogomenumovil.setAttribute("hidden","true"),document.removeEventListener("click",cerrarDialogoExterno))}miDialogomenumovil.close(),miDialogomenumovil.setAttribute("hidden","true"),mobilemenu1.addEventListener("click",()=>{miDialogomenumovil.showModal(),miDialogomenumovil.removeAttribute("hidden"),document.addEventListener("click",cerrarDialogoExterno)}),(()=>{if(document.querySelector(".perfil")){const t=document.querySelector("#btnCambiarEmail"),o=document.querySelector("#miDialogoUpEmail");function e(t){t.target!==o&&"salir"!==t.target.value||(o.close(),document.removeEventListener("click",e))}null==t||t.addEventListener("click",t=>{o.showModal(),document.addEventListener("click",e)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".caja")){const a=document.querySelector("#gastosIngresos"),i=document.querySelector("#cambioMedioPago"),r=document.querySelector("#btnGastosingresos"),d=document.querySelector("#operacion"),c=document.querySelectorAll('input[name="origengasto"]'),l=document.querySelectorAll(".mediopago"),s=document.querySelector("#totalPagado"),u=document.querySelector("#numfactura");let m,p,v,f,g="0",y=[];const h=new Set,b=new Map;function o(){var e,t,o,n,a,i;const r=document.querySelector('input[name="origengasto"]:checked');"gastocaja"==(null==r?void 0:r.id)?(null===(e=document.querySelector("#showcajas"))||void 0===e||e.classList.remove("hidden"),null===(t=document.querySelector("#showcajas"))||void 0===t||t.setAttribute("required",""),null===(o=document.querySelector("#showbancos"))||void 0===o||o.classList.add("hidden"),null===(n=document.querySelector("#showbancos"))||void 0===n||n.removeAttribute("required")):(null===(a=document.querySelector("#showbancos"))||void 0===a||a.classList.remove("hidden"),null===(i=document.querySelector("#showbancos"))||void 0===i||i.setAttribute("required",""))}function n(e){e.target!==a&&e.target!==i&&"cancelar"!==e.target.value||(a.close(),i.close(),document.removeEventListener("click",n))}m=$("#tablaListaPedidos").DataTable(configdatatablescaja),null==r||r.addEventListener("click",()=>{a.showModal(),document.addEventListener("click",n)}),null==d||d.addEventListener("change",e=>{var t,n,a,i,r,d,c,l;const s=e.target,u=document.querySelector(".tipodegasto");"gasto"==s.value?(u.style.display="flex",null===(t=document.querySelector("#tipodegasto"))||void 0===t||t.setAttribute("required",""),null===(n=document.querySelector("#origengasto"))||void 0===n||n.classList.remove("hidden"),null===(a=document.querySelector("#origengasto"))||void 0===a||a.classList.add("flex"),o()):(u.style.display="none",null===(i=document.querySelector("#tipodegasto"))||void 0===i||i.removeAttribute("required"),null===(r=document.querySelector("#origengasto"))||void 0===r||r.classList.add("hidden"),null===(d=document.querySelector("#origengasto"))||void 0===d||d.classList.remove("flex"),null===(c=document.querySelector("#showcajas"))||void 0===c||c.classList.remove("hidden"),null===(l=document.querySelector("#showbancos"))||void 0===l||l.classList.add("hidden"))}),c.forEach(e=>e.addEventListener("click",o)),null===(e=document.querySelector("#tablaListaPedidos"))||void 0===e||e.addEventListener("click",e=>{var t,o,a;const r=e.target;((null==r?void 0:r.classList.contains("mediosdepago"))||(null===(t=r.parentElement)||void 0===t?void 0:t.classList.contains("mediosdepago")))&&function(e){var t,o,a,r,d,c,m;g=e.id,v=e,p=null!==(t=e.dataset.estado)&&void 0!==t?t:"",s.textContent=Number(null!==(o=e.dataset.totalpagado)&&void 0!==o?o:"0").toLocaleString(),"BUTTON"==e.tagName&&(g=e.parentElement.id,v=e.parentElement,p=null!==(r=null===(a=e.parentElement)||void 0===a?void 0:a.dataset.estado)&&void 0!==r?r:"",s.textContent=Number(null!==(d=e.parentElement.dataset.totalpagado)&&void 0!==d?d:"0").toLocaleString());(function(){u.textContent="Factura N° : "+g,(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/mediospagoXfactura?id="+g,t=yield fetch(e);f=yield t.json(),console.log(f),f.forEach(e=>h.add(e.idmediopago)),l.forEach(e=>{e.value="0";for(let t=0;t<f.length;t++)if(e.id==f[t].idmediopago){e.value=Number(f[t].valor).toLocaleString(),b.set(e.id,Number(f[t].valor));break}})}catch(e){console.log(e)}}))})()})(),"Eliminada"==p&&(null===(c=document.querySelector("#btnEnviarCambioMedioPago"))||void 0===c||c.classList.add("!hidden"));"Paga"==p&&(null===(m=document.querySelector("#btnEnviarCambioMedioPago"))||void 0===m||m.classList.remove("!hidden"));i.showModal(),document.addEventListener("click",n)}(r),((null==r?void 0:r.classList.contains("printPOS"))||(null===(o=r.parentElement)||void 0===o?void 0:o.classList.contains("printPOS")))&&function(e){let t=e.parentElement.id;"I"===e.tagName&&(t=e.parentElement.parentElement.id);window.open("/admin/printPDFPOS?id="+t,"_blank")}(r),((null==r?void 0:r.classList.contains("printPDF"))||(null===(a=r.parentElement)||void 0===a?void 0:a.classList.contains("printPDF")))&&function(e){var t,o;let n=e.parentElement.id,a=null===(t=e.parentElement)||void 0===t?void 0:t.dataset.cotizacion,i="/printfacturacarta?id=";"I"===e.tagName&&(n=e.parentElement.parentElement.id,a=null===(o=e.parentElement.parentElement)||void 0===o?void 0:o.dataset.cotizacion);"1"===a&&(i="/printcotizacion?id=");const r=window.open(i+n,"_blank");r&&(r.onload=()=>{null==r||r.focus(),null==r||r.print(),setTimeout(()=>{null==r||r.close()},200)})}(r)}),l.forEach(e=>{e.addEventListener("input",e=>{let t=0;l.forEach((e,o)=>{t+=parseInt(e.value.replace(/[,.]/g,""))}),t<=parseInt(s.textContent.replace(/[,.]/g,""))?(b.set(e.target.id,parseInt(e.target.value.replace(/[,.]/g,""))),document.querySelector("#diferencia").textContent=(parseInt(s.textContent.replace(/[,.]/g,""))-t).toLocaleString()):b.has(e.target.id)?e.target.value=b.get(e.target.id).toLocaleString():e.target.value="0"})}),null===(t=document.querySelector("#formCambioMedioPago"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault();let t=0;y.length=0,l.forEach((e,o)=>{t+=parseInt(e.value.replace(/[,.]/g,"")),"0"!=e.value&&(y=[...y,{idmediopago:e.id,valor:e.value.replace(/[,.]/g,"")}])}),t==parseInt(s.textContent.replace(/[,.]/g,""))?function(){__awaiter(this,void 0,void 0,(function*(){var e,t,o,a;const r=new Set(y.map(e=>e.idmediopago)),d=f.filter(e=>r.has(e.idmediopago)),c=y.filter(e=>!h.has(e.idmediopago)),l=f.filter(e=>!r.has(e.idmediopago)),s=new FormData;s.append("id_factura",g),s.append("efectivoDB",null!==(t=null===(e=f.find(e=>"1"==e.idmediopago))||void 0===e?void 0:e.valor)&&void 0!==t?t:"0"),s.append("nuevoEfectivo",null!==(a=null===(o=y.find(e=>"1"==e.idmediopago))||void 0===o?void 0:o.valor)&&void 0!==a?a:"0"),s.append("mediospagocompartidos",JSON.stringify(d)),s.append("nuevosMediosPagoNoEnDB",JSON.stringify(c)),s.append("mediosPagoDBNoEnNuevos",JSON.stringify(l)),s.append("nuevosMediosPago",JSON.stringify(y));try{const e="/admin/api/cambioMedioPago",t=yield fetch(e,{method:"POST",body:s}),o=yield t.json();void 0!==o.exito?(msjalertToast("success","¡Éxito!",o.exito[0]),function(e){for(;v.firstChild;)v.removeChild(v.firstChild);e.forEach(e=>{const t=document.createElement("button");t.classList.add("btn-xs","btn-light","mr-2"),t.textContent=e.mediopago,v.appendChild(t)})}(o.mediosPagoUpdate)):msjalertToast("error","¡Error!",o.error[0])}catch(e){console.log(e)}i.close(),document.removeEventListener("click",n)}))}():msjAlert("error","Valor diferente al pagado",document.querySelector("#divmsjalerta2"))})}})(),(()=>{var e;if(document.querySelector(".categoriasgastos")){const o=document.querySelector("#btnCrearCategoriaGasto"),n=document.querySelector("#miDialogoCategoriaGasto");let a;function t(e){const o=e.target;o!==n&&"Salir"!==o.value&&"Actualizar"!==o.value||(n.close(),document.removeEventListener("click",t))}a=$("#tablaCategoriasGastos").DataTable(configdatatables25reg),null==o||o.addEventListener("click",e=>{!function(){var e;null===(e=document.querySelector("#formCrearUpdateCategoriaGasto"))||void 0===e||e.reset(),document.querySelector("#formCrearUpdateCategoriaGasto").action="/admin/caja/crear_categoriaGasto"}(),document.querySelector("#modalCategoriaGasto").textContent="Crear categoria de gasto",document.querySelector("#btnEditarCrearCategoriaGasto").value="Crear",n.showModal(),document.addEventListener("click",t)}),null===(e=document.querySelector("#tablaCategoriasGastos"))||void 0===e||e.addEventListener("click",e=>{var o,a,i=e.target;((null==i?void 0:i.classList.contains("editarCategoriaGasto"))||(null===(o=i.parentElement)||void 0===o?void 0:o.classList.contains("editarCategoriaGasto")))&&function(e){var o,a,i,r,d;let c=null===(o=e.target.parentElement)||void 0===o?void 0:o.id;"I"===(null===(a=e.target)||void 0===a?void 0:a.tagName)&&(c=null===(r=null===(i=e.target.parentElement)||void 0===i?void 0:i.parentElement)||void 0===r?void 0:r.id);document.querySelector("#formCrearUpdateCategoriaGasto").action="/admin/caja/editarcategoriagasto",document.querySelector("#modalCategoriaGasto").textContent="Actualizar categoria de gasto",document.querySelector("#btnEditarCrearCategoriaGasto").value="Actualizar",document.querySelector("#idCategoriaGasto").value=c,document.querySelector("#nombre").value=null===(d=e.target.closest(".acciones-btns"))||void 0===d?void 0:d.dataset.categoriagasto,n.showModal(),document.addEventListener("click",t)}(e),((null==i?void 0:i.classList.contains("eliminarCategoriaGasto"))||(null===(a=i.parentElement)||void 0===a?void 0:a.classList.contains("eliminarCategoriaGasto")))&&function(e){let t=e.target.parentElement;"I"===e.target.tagName&&(t=t.parentElement);Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la categoria de gasto?",text:"La categoria de gasto sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&t.submit()})}(e)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".cerrarcaja")){const o=document.querySelector("#modalArqueocaja"),n=document.querySelector("#Modalcerrarcaja"),a=document.querySelector("#modalCambiarCaja"),i=document.querySelector("#btnArqueocaja"),r=document.querySelector("#btnCerrarcaja"),d=document.querySelector("#btnImprimirDetalleCaja"),c=document.querySelector("#btnCambiarCaja"),l=document.querySelectorAll(".inputmediopago"),s=document.querySelector("#formArqueocaja"),u=document.querySelector("#formCambiarCaja");null==i||i.addEventListener("click",()=>{o.showModal(),document.addEventListener("click",t)}),null==r||r.addEventListener("click",()=>{n.showModal(),document.addEventListener("click",t)}),null==c||c.addEventListener("click",()=>{a.showModal(),document.addEventListener("click",t)}),null==s||s.addEventListener("submit",e=>{var n;e.preventDefault(),function(){const e=document.querySelector("#Efectivo"),t=Array.from(document.querySelectorAll(".denominacion")).reduce((e,t)=>Number(t.dataset.moneda)*Number(t.value)+e,0);e.value=t+"";const o=new Event("input");e.dispatchEvent(o)}();const a=new FormData(s);a.append("idcierrecaja",null===(n=document.querySelector("#idCierrecaja"))||void 0===n?void 0:n.textContent),__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/arqueocaja",n=yield fetch(e,{method:"POST",body:a}),i=yield n.json();void 0!==i.exito?(o.close(),document.removeEventListener("click",t),msjalertToast("success","¡Éxito!",i.exito[0])):msjalertToast("error","¡Error!",i.error[0])}catch(e){console.log(e)}}))}),l.forEach(e=>{e.addEventListener("input",e=>{const t=e.target,o=parseInt(e.target.value.replace(/[,.]/g,""));__awaiter(void 0,void 0,void 0,(function*(){var e;const n=new FormData;n.append("id_mediopago",t.dataset.idmediopago+""),n.append("nombremediopago",t.name),n.append("valordeclarado",o+""),n.append("idcierrecaja",null===(e=document.querySelector("#idCierrecaja"))||void 0===e?void 0:e.textContent);try{const e="/admin/api/declaracionDinero",a=yield fetch(e,{method:"POST",body:n}),i=yield a.json();void 0!==i.exito?(t.style.color="#02db02",t.style.fontWeight="500",function(e,t,o){var n,a;const i=document.querySelector(`.coldeclarado[data-mediopagoid="${e}"]`);if(i){const e=i.nextElementSibling;i.textContent=Number(t).toLocaleString("es-ES",{useGrouping:!0});const o=null===(a=null===(n=i.previousElementSibling)||void 0===n?void 0:n.textContent)||void 0===a?void 0:a.replace(/[.,]/g,"");e.textContent=(Number(t)-Number(o)).toLocaleString("es-ES",{useGrouping:!0})}else{const n=document.querySelector(".cuerpoanalisis");null==n||n.insertAdjacentHTML("beforeend",`\n          <tr class="${"Efectivo"==o?"!border-2 !border-indigo-600":""}">\n            <td class="">${o}</td> \n            <td class="colsistem">0</td>\n            <td class="coldeclarado" data-mediopagoid="${e}">${Number(t).toLocaleString("es-ES",{useGrouping:!0})}</td>\n            <td class="coldif">${Number(t).toLocaleString("es-ES",{useGrouping:!0})}</td>\n          </tr>`)}}(t.dataset.idmediopago,o+"",t.name)):msjalertToast("error","¡Error!",i.error[0])}catch(e){console.log(e)}}))})});const m=null===(e=document.querySelector("#idCierrecaja"))||void 0===e?void 0:e.textContent;function t(e){(e.target===o||e.target===n||e.target===a||"Cancelar"===e.target.value||e.target.closest(".salircerrarcaja")||e.target.closest(".finCerrarcaja"))&&(o.close(),n.close(),a.close(),document.removeEventListener("click",t),e.target.closest(".finCerrarcaja")&&function(){var e;const o=new FormData;o.append("idcierrecaja",null===(e=document.querySelector("#idCierrecaja"))||void 0===e?void 0:e.textContent),document.querySelector(".content-spinner1").style.display="grid",n.close(),document.removeEventListener("click",t),(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/cierrecajaconfirmado",t=yield fetch(e,{method:"POST",body:o}),n=yield t.json();void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),setTimeout(()=>{document.querySelector(".content-spinner1").style.display="none",window.location.href="/admin/caja/detallecierrecaja?id="+n.ultimocierre[0]},1600)):(document.querySelector(".content-spinner1").style.display="none",msjalertToast("error","¡Error!",n.error[0]))}catch(e){console.log(e)}}))})()}())}null==d||d.addEventListener("click",()=>{const e=window.open("/printdetallecierre?id="+m,"_blank");e&&(e.onload=()=>{null==e||e.focus(),null==e||e.print(),setTimeout(()=>{null==e||e.close()},200)})}),null==u||u.addEventListener("submit",e=>{e.preventDefault();const o=new FormData;o.append("idcaja",$("#CambiarCaja").val()),__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/datoscajaseleccionada",n=yield fetch(e,{method:"POST",body:o}),i=yield n.json();void 0!==i.exito?(a.close(),document.removeEventListener("click",t),console.log(i),document.querySelector("#nombreCaja").textContent=$("#CambiarCaja option:selected").text(),document.querySelector("#idCierrecaja").textContent=i.ultimocierre.id,function(e){const t=document.querySelector("#tablaMediosPago tbody");for(;t.firstChild;)t.removeChild(t.firstChild);e.forEach(e=>{const o=document.createElement("tr");o.innerHTML=`<td class="">${e.mediopago}</td> \n                        <td class=""><strong>$ </strong>${Number(e.valor).toLocaleString()}</td>\n                      `,t.appendChild(o)})}(i.discriminarmediospagos),function(e){const t=Number(e.basecaja),o=Number(e.ventasenefectivo),n=Number(e.gastoscaja),a=Number(e.domicilios),i=Number(e.ingresoventas),r=Number(e.totaldescuentos);document.querySelector("#basecajaResumen").textContent="$"+t.toLocaleString(),document.querySelector("#gastoscajaResumen").textContent="$"+n.toLocaleString(),document.querySelector("#domiciliosResumen").textContent="$"+a.toLocaleString(),document.querySelector("#ingresoventasResumen").textContent="$"+i.toLocaleString(),document.querySelector("#totalfacturasResumen").textContent=e.totalfacturas,document.querySelector("#totalcotizacionesResumen").textContent=e.totalcotizaciones,document.querySelector("#baseIngresoCaja").textContent="+ $"+t.toLocaleString(),document.querySelector("#ventasEfectivo").textContent="+ $"+o.toLocaleString(),document.querySelector("#gastosCaja").textContent="- $"+n.toLocaleString(),document.querySelector("#dineroCaja").textContent="= $"+(t+o-n).toLocaleString(),document.querySelector("#domicilios").textContent="- $"+a.toLocaleString(),document.querySelector("#realCaja").textContent="= $"+(t+o-n-a).toLocaleString(),document.querySelector("#ingresoVentasTotal").textContent="+ $"+i.toLocaleString(),document.querySelector("#totalGastosCaja").textContent="- $"+n.toLocaleString(),document.querySelector("#totalDescuentos").textContent="- $"+r.toLocaleString(),document.querySelector("#totalDomicilios").textContent="= $"+a.toLocaleString(),document.querySelector("#realVentas").textContent="= $"+(i-r-a-n).toLocaleString(),document.querySelector("#totalBaseGravable").textContent="+ $"+Number(e.basegravable).toLocaleString(),document.querySelector("#impuestoTotal").textContent="+ $"+Number(e.valorimpuestototal).toLocaleString(),document.querySelector("#otrosGastosBancarios").textContent="+ $"+Number(e.gastosbanco).toLocaleString(),document.querySelector("#cantidadFacturasFE").textContent=e.facturaselectronicas,document.querySelector("#cantidadFacturasPOS").textContent=e.facturaspos}(i.ultimocierre),function(e){const t=document.querySelector("#sobranteFaltante tbody");for(;t.firstChild;)t.removeChild(t.firstChild);e.forEach(e=>{const o=document.createElement("tr");"Efectivo"==e.nombremediopago&&o.classList.add("!border-2","!border-indigo-600"),o.innerHTML=`<td class="">${e.nombremediopago}</td> \n                        <td class="colsistem">${e.valorsistema.toLocaleString()}</td>\n                        <td class="coldeclarado" data-mediopagoid="${e.id_mediopago}">${e.valordeclarado.toLocaleString()}</td>\n                        <td class="coldif">${(e.valordeclarado-e.valorsistema).toLocaleString()}</td>\n                      `,t.appendChild(o)})}(i.sobrantefaltante),function(e){const t=document.querySelector("#ventasXUsuario tbody");for(;t.firstChild;)t.removeChild(t.firstChild);e.forEach(e=>{const o=document.createElement("tr");o.innerHTML=`<td class="">${e.Nombre}</td>\n                        <td class="">${e.N_ventas}</td>\n                        <td class=""><strong>$ </strong>${Number(e.ventas).toLocaleString()}</td>\n                      `,t.appendChild(o)})}(i.ventasxusuarios),function(e){const t=document.querySelector("#tablaVentas tbody");for(;t.firstChild;)t.removeChild(t.firstChild);e.forEach((e,o)=>{const n=document.createElement("tr");n.innerHTML=`<td class="">${o}</td>        \n                        <td class="">${e.fechapago}</td> \n                        <td class="">${e.cliente}</td> \n                        <td class="">${e.id}</td>\n                        <td>\n                            <div data-estado="${e.estado}" data-totalpagado="${e.total}" id="${e.id}" class="mediosdepago max-w-full flex flex-wrap gap-2">\n                                ${e.mediosdepago.map(e=>`<button class="btn-xs btn-light">${e.mediopago}</button>`).join(" ")}\n                            </div>\n                        </td>\n                        <td class="${"Paga"==e.estado?"btn-xs btn-lima":"btn-xs btn-blueintense"}">${e.estado}</td>\n                        <td class="">$ ${Number(e.subtotal).toLocaleString()}</td>\n                        <td class="">$ ${Number(e.total).toLocaleString()}</td>\n                        <td class="accionestd"><div class="acciones-btns" id="${e.id}">\n                                <a class="btn-xs btn-turquoise" href="/admin/caja/ordenresumen?id=${e.id}">Ver</a> <button class="btn-xs btn-light"><i class="fa-solid fa-print"></i></button>\n                            </div>\n                        </td>\n                      `,t.appendChild(n)})}(i.facturas),msjalertToast("success","¡Éxito!",i.exito[0])):msjalertToast("error","¡Error!",i.error[0])}catch(e){console.log(e)}}))})}})(),(()=>{var e;if(document.querySelector(".detallecierrecaja")){const t=document.querySelector("#btnImprimirDetalleCaja"),o=null!==(e=new URLSearchParams(window.location.search).get("id"))&&void 0!==e?e:"";null==t||t.addEventListener("click",()=>{if(""!=o){const e=window.open("/printdetallecierre?id="+o,"_blank");e&&(e.onload=()=>{null==e||e.focus(),null==e||e.print(),setTimeout(()=>{null==e||e.close()},200)})}})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".fechazetadiario")){const o=document.querySelectorAll(".btnmultiselect"),n=document.querySelectorAll(".caja"),a=document.querySelector("#consultarZDiario"),i=document.querySelector("#tablaMediosPago tbody"),r=document.querySelector("#base"),d=document.querySelector("#valorImpuestoTotal"),c=document.querySelector("#ingresoVentas"),l=document.querySelector("#totalDescuentos"),s=document.querySelector("#realVentas"),u=document.querySelector("#cantidadElectronicas"),m=document.querySelector("#cantidadPOS"),p=document.querySelector("#valorElectronicas"),v=document.querySelector("#valorPOS");let f="",g="";function t(){const e=document.querySelectorAll('input.caja[type="checkbox"]:checked'),t=document.querySelector("#cajastext");t.textContent=". ",e.forEach((o,n)=>{var a,i;n<e.length-1?t.textContent+=(null===(a=o.nextElementSibling)||void 0===a?void 0:a.textContent)+" - ":t.textContent+=null===(i=o.nextElementSibling)||void 0===i?void 0:i.textContent})}o.forEach((e,t)=>{e.addEventListener("click",n=>{!function(e){o.forEach((t,o)=>{o==e&&t.classList.contains("open")||t.classList.remove("open")})}(t),e.classList.toggle("open")})}),null===(e=document.querySelector(".fechazetadiario"))||void 0===e||e.addEventListener("click",e=>{if(!e.target.closest(".btnmultiselect")&&!e.target.closest(".list-items")){const e=document.querySelector(".open");e&&e.classList.toggle("open")}}),n.forEach(e=>{e.addEventListener("click",t)}),$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");f=o,g=n,document.querySelector("#fechainicio").textContent=f,document.querySelector("#fechafin").textContent=g})),a.addEventListener("click",()=>{if(""==f||""==g)return void msjalertToast("error","¡Error!","Elegir fechas a consultar");const e=document.querySelectorAll('input.caja[type="checkbox"]:checked'),t=document.querySelectorAll('input.facturador[type="checkbox"]:checked'),o=Array.from(e).map(e=>e.value),n=Array.from(t).map(e=>e.value);document.querySelector(".content-spinner1").style.display="grid",__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("fechainicio",f),e.append("fechafin",g),e.append("cajas",JSON.stringify(o)),e.append("facturadores",JSON.stringify(n));try{const o="/admin/api/consultafechazetadiario",n=yield fetch(o,{method:"POST",body:e}),a=yield n.json();console.log(a),document.querySelector(".content-spinner1").style.display="none",function(){for(;i.firstChild;)i.removeChild(i.firstChild);c.textContent="",l.textContent="",s.textContent="",u.textContent="",m.textContent="",p.textContent="",v.textContent=""}(),a.datosmediospago.forEach(e=>{const t=document.createElement("tr");t.innerHTML=`<td class="">${e.nombre}</td> \n                        <td class="">$${Number(e.valor).toLocaleString()}</td>`,i.appendChild(t)}),t=a.datosventa,r.textContent="$"+Number(t.base).toLocaleString(),d.textContent="$"+Number(t.valorimpuestototal).toLocaleString(),c.textContent="$"+Number(t.subtotalventa).toLocaleString(),l.textContent="$"+(Number(t.subtotalventa)-Number(t.totalventa)).toLocaleString(),s.textContent="$"+Number(t.totalventa).toLocaleString(),u.textContent=t.ELECTRONICAS,m.textContent=t.POS,p.textContent="$"+Number(t.total_ELECTRONICAS).toLocaleString(),v.textContent="$"+Number(t.total_POS).toLocaleString()}catch(e){console.log(e)}var t}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t,o,n,a,i,r;if(document.querySelector(".ordenresumen")){const s=document.querySelector("#miDialogoFacturar"),u=document.querySelector("#miDialogoEliminarOrden"),m=document.querySelector("#btnfacturar"),p=document.querySelector("#btneliminarorden"),v=document.querySelector("#caja"),f=document.querySelector("#facturador"),g=document.querySelectorAll(".mediopago"),y=document.querySelectorAll('input[name="devolverinventario"]'),h=document.querySelectorAll(".inputInv"),b=document.querySelector("#printcarta"),S=document.querySelector("#printcotizacion"),w=(document.querySelector("#numOrden"),document.querySelector("#referenciaFactura"),document.querySelector("#enviarEmail")),x=document.querySelector("#miDialogoEnviarEmailCliente"),E=document.querySelector("#inputEliminarClave"),q={subtotal:0,impuesto:0,dctox100:0,descuento:0,idtarifa:0,valortarifa:0,total:0},C=new Map;let _;function d(e){var t;$("#facturador").val(null!==(t=e.options[e.selectedIndex].dataset.idfacturador)&&void 0!==t?t:"1")}function c(e){e=e.replace(/[,.]/g,""),Number(e)>C.get("1")?document.querySelector("#cambio").textContent=(Number(e)-C.get("1")).toLocaleString()+"":document.querySelector("#cambio").textContent="0"}function l(e){const t=e.target;(e.target===s||e.target===u||e.target===x||"cancelar"===t.value||"Salir"===t.value||t.closest(".noeliminar"))&&(s.close(),u.close(),x.close(),document.removeEventListener("click",l))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/getPasswords",t=yield fetch(e),o=yield t.json();_=o}catch(e){console.log(e)}})),q.subtotal=Number(null===(e=document.querySelector("#subTotal"))||void 0===e?void 0:e.textContent),q.total=Number(null===(o=null===(t=document.querySelector("#total"))||void 0===t?void 0:t.textContent)||void 0===o?void 0:o.replace(/[^\d]/g,"")),d(v),v.addEventListener("change",e=>d(e.target)),null==b||b.addEventListener("click",()=>{const e=new URLSearchParams(window.location.search).get("id"),t=window.open("/printfacturacarta?id="+e,"_blank");t&&(t.onload=()=>{null==t||t.focus(),null==t||t.print(),setTimeout(()=>{null==t||t.close()},200)})}),null==S||S.addEventListener("click",()=>{const e=new URLSearchParams(window.location.search).get("id"),t=window.open("/printcotizacion?id="+e,"_blank");t&&(t.onload=()=>{null==t||t.focus(),null==t||t.print(),setTimeout(()=>{null==t||t.close()},200)})}),null==m||m.addEventListener("click",()=>{!function(){document.querySelector("#totalPagar").textContent=""+q.total.toLocaleString();let e=0;g.forEach((t,o)=>{o>0&&(e+=parseInt(t.value.replace(/[,.]/g,"")))}),q.total<e&&(e=0,C.clear(),$(".mediopago").val(0));document.querySelector(".Efectivo").value=""+(q.total-e).toLocaleString(),C.set("1",q.total-e),q.total-e==0&&C.has("1")&&C.delete("1");c(document.querySelector("#recibio").value)}(),s.showModal(),document.addEventListener("click",l)}),null==p||p.addEventListener("click",()=>{u.showModal(),document.addEventListener("click",l)}),w.addEventListener("click",()=>{x.showModal(),document.addEventListener("click",l)}),null===(n=document.querySelector("#formEnviarEmailCliente"))||void 0===n||n.addEventListener("submit",e=>{e.preventDefault();const t=document.querySelector("#idorden").dataset.idorden;if(null!=t&&Number(t)>0){const e=new FormData;e.append("id",t),e.append("email",document.querySelector("#inputEmail").value),x.close(),document.removeEventListener("click",l),__awaiter(void 0,void 0,void 0,(function*(){try{const t="/admin/api/sendOrdenEmailToCustemer",o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();null!=n.exito?msjalertToast("success","¡Éxito!",n.exito[0]):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))}}),y.forEach(e=>{e.addEventListener("change",e=>{var t;null===(t=document.querySelector("#productsInv"))||void 0===t||t.classList.toggle("hidden"),"1"===e.target.value?document.querySelectorAll(".inputInv").forEach(e=>e.setAttribute("required","")):document.querySelectorAll(".inputInv").forEach(e=>e.removeAttribute("required"))})}),h.forEach(e=>{e.addEventListener("input",e=>{var t,o;const n=e.target;n.value!=(null===(t=n.parentElement)||void 0===t?void 0:t.dataset.qty)?(n.classList.add("border-2","border-rose-600"),document.querySelector(".alerta")||msjAlert("error","Cantidad diferente a devolver a inventario",document.querySelector("#divmsjalerta1"))):(n.classList.remove("border-2","border-rose-600"),null===(o=document.querySelector(".alerta"))||void 0===o||o.remove())})}),g.forEach(e=>{e.addEventListener("input",e=>{!function(e){var t;let o=0;g.forEach((e,t)=>{t>0&&(o+=parseInt(e.value.replace(/[,.]/g,"")))}),o<=q.total?(C.set("1",q.total-o),q.total-o==0&&C.has("1")&&C.delete("1"),C.set(e.target.id,parseInt(e.target.value.replace(/[,.]/g,""))),"0"==e.target.value&&C.has(e.target.id)&&C.delete(e.target.id)):C.has(e.target.id)?e.target.value=C.get(e.target.id).toLocaleString():e.target.value="0";g[0].value=(null!==(t=C.get("1"))&&void 0!==t?t:0).toLocaleString(),c(document.querySelector("#recibio").value)}(e)})}),null===(a=document.querySelector("#recibio"))||void 0===a||a.addEventListener("input",e=>{c(e.target.value)}),null===(i=document.querySelector("#formfacturar"))||void 0===i||i.addEventListener("submit",e=>{e.preventDefault(),function(e){__awaiter(this,void 0,void 0,(function*(){const t=document.querySelector('input[name="imprimir"]:checked'),o=new FormData;o.append("id",document.querySelector("#idorden").dataset.idorden),o.append("idcaja",v.value),o.append("idconsecutivo",f.value),o.append("caja",document.querySelector("#caja option:checked").textContent),o.append("tipofacturador",f.options[f.selectedIndex].textContent),o.append("mediosPago",JSON.stringify(Array.from(C,([e,t])=>({idmediopago:e,id_factura:0,valor:t})))),o.append("recibido",document.querySelector("#recibio").value),o.append("transaccion",""),o.append("estado",e),o.append("cambioaventa","1"),o.append("observacion",document.querySelector("#observacion").value);try{const e="/admin/api/facturarCotizacion",a=yield fetch(e,{method:"POST",body:o}),i=yield a.json();console.log(i),void 0!==i.exito?(msjalertToast("success","¡Éxito!",i.exito[0]),i.idfactura&&"1"===t.value&&(n=i.idfactura,setTimeout(()=>{window.open("/admin/printPDFPOS?id="+n,"_blank")},1200)),function(){m&&(m.style.display="none");document.querySelector("#abrirOrden").style.display="none",document.querySelector("#estadoOrden").textContent="Paga"}()):msjalertToast("error","¡Error!",i.error[0])}catch(e){console.log(e)}var n;s.close(),document.removeEventListener("click",l)}))}("Guardado")}),null===(r=document.querySelector(".sieliminar"))||void 0===r||r.addEventListener("click",e=>{e.target.closest(".sieliminar")&&function(){var e=[];if(!function(){const e=_.find(e=>"clave_para_eliminar_factura"==e.clave);if(null!==(null==e?void 0:e.valor_final)&&E.value!==(null==e?void 0:e.valor_final))return msjAlert("error","El password es invalido",document.querySelector("#divmsjalerta1")),0;return 1}())return;h.forEach(t=>{const o=t;e=[...e,{id:o.id,idproducto:o.id,tipoproducto:o.dataset.tipoproducto,tipoproduccion:o.dataset.tipoproduccion,rendimientoestandar:o.dataset.rendimientoestandar,cantidad:o.value}]}),(()=>{__awaiter(this,void 0,void 0,(function*(){const t=new FormData;t.append("id",document.querySelector("#idorden").dataset.idorden),t.append("inv",JSON.stringify(e)),t.append("devolverinv",document.querySelector('input[name="devolverinventario"]:checked').value);try{const e="/admin/api/eliminarOrden",o=yield fetch(e,{method:"POST",body:t}),n=yield o.json();void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),u.close(),document.removeEventListener("click",l),p.style.display="none",w.style.display="none",document.querySelector("#estadoOrden").textContent="Eliminada"):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))})()}()})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".pedidosguardados")){let t,o=0;t=$("#tablaPedidosGuardados").DataTable(configdatatables),null===(e=document.querySelector("#tablaPedidosGuardados"))||void 0===e||e.addEventListener("click",e=>{var n;const a=e.target;((null==a?void 0:a.classList.contains("eliminarPedidoGuardado"))||(null===(n=a.parentElement)||void 0===n?void 0:n.classList.contains("eliminarPedidoGuardado")))&&function(e){let n=e.target.parentElement.id,a=t.page.info();"I"===e.target.tagName&&(n=e.target.parentElement.parentElement.id);o=t.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:`Desea eliminar la orden guardado #${n}?`,text:"La orden/cotizacion guardado sera eliminado definitivamente del sistema.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",n);try{const n="/admin/api/eliminarPedidoGuardado",i=yield fetch(n,{method:"POST",body:e}),r=yield i.json();void 0!==r.exito?(t.row(o).remove().draw(),t.page(a.page).draw("page"),Swal.fire(r.exito[0],"","success")):Swal.fire(r.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".ajustarcostos")){let t,o=[];__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",n=yield fetch(e);o=yield n.json(),console.log(o),o.forEach(e=>{var t,o;let n=null===(t=document.querySelector(`tr[data-idsubproducto="${e.idsubproducto}"]`))||void 0===t?void 0:t.children[5].children[0];null==n&&(n=null===(o=document.querySelector(`tr[data-idproducto="${e.idproducto}"]`))||void 0===o?void 0:o.children[5].children[0]);const a=document.createElement("option");a.textContent=e.nombreunidaddestino,a.dataset.factor=e.factorconversion,null==n||n.appendChild(a)}),t=$("#tablaAjustarCostos").DataTable(configdatatablesajustarcostos)}catch(e){console.log(e)}})),null===(e=document.querySelector("#tablaAjustarCostos"))||void 0===e||e.addEventListener("input",e=>{var t,o=e.target;let n="",a="";if(o.classList.contains("inputAjustarCosto")){var i=o.closest("tr");const e=null==i?void 0:i.querySelector(".formulario__select"),d=Number(e.options[e.selectedIndex].dataset.factor);var r=o.closest(".fila");r||(r=null===(t=o.closest("tr"))||void 0===t?void 0:t.previousSibling),r.classList.contains("producto")?(a=r.dataset.idproducto,n="0"):(a=r.dataset.idsubproducto,n="1"),function(e,t,o,n){""==n.value&&(n.value="0");const a=Number(n.value)/o;console.log(a),(()=>{__awaiter(this,void 0,void 0,(function*(){const o=new FormData;o.append("tipoelemento",e),o.append("idelemento",t),o.append("precio_compra",a+"");try{const e="/admin/api/actualizarcostos",t=yield fetch(e,{method:"POST",body:o}),a=yield t.json();void 0!==a.exito?(n.style.color="#02db02",n.style.fontWeight="500"):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))})()}(n,a,d,o)}})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t,o;if(document.querySelector(".almacen")){const r=document.querySelector("#btntrasladoinvnetario"),d=document.querySelector("#btnXCerrarTrasladoInvnetario"),c=document.querySelector("#miDialogoTrasladoInvnetario"),l=document.querySelector("#reinciarinv"),s=document.querySelector("#miDialogoStock"),u=document.querySelector("#modalStock"),m=document.querySelector("#selectStockRapidoUndmedida");let p=document.querySelector("#cantidadStockRapido");const v=document.querySelector("#miDialogoIngresarProduccion"),f=document.querySelector("#itemAproducir"),g=document.querySelectorAll(".btnproduccion"),y=document.querySelector("#selectIngresarProduccionUnidadmedida"),h=document.querySelector("#stockIngresarProduccion");let b,S,w=0,x=0,E="",q=0,C="",_="";const L=document.querySelector("#sedes");let D=[],k=[];function n(e){document.querySelector("#stock").textContent=Number(e.stock).toLocaleString(),document.querySelector("#costoProduccion").textContent="$"+Number(e.precio_compra).toLocaleString(),document.querySelector("#precioVenta").textContent="$"+Number(e.precio_venta).toLocaleString()}function a(e,t){e.forEach(e=>{b.rows().every((function(){var o,n,a,i;const r=this.node();let d=e.subproductoid,c=r.getAttribute("data-idsubproducto");if("0"==t&&(c=r.getAttribute("data-idproducto"),d=e.productoid),c&&c===d){this.cell(this.index(),3).data(`<div class="text-center px-3 py-4 rounded-lg">${e.stock}</div>`);const t=b.cell(this.index(),3).node();Number(e.stock)<=Number(e.stockminimo)?(null===(o=t.firstElementChild)||void 0===o||o.classList.remove("bg-cyan-50","text-cyan-600"),null===(n=t.firstElementChild)||void 0===n||n.classList.add("bg-red-50","text-red-800")):(null===(a=t.firstElementChild)||void 0===a||a.classList.remove("bg-red-50","text-red-800"),null===(i=t.firstElementChild)||void 0===i||i.classList.add("bg-cyan-50","text-cyan-600"))}}))})}function i(e){var t;const o=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;e.target!==c&&"btnXCerrarTrasladoInvnetario"!=o&&e.target!==d&&e.target!==s&&e.target!==v&&"salir"!==e.target.value||(s.close(),v.close(),c.close(),document.removeEventListener("click",i))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",t=yield fetch(e);k=yield t.json()}catch(e){console.log(e)}})),r.addEventListener("click",()=>{c.showModal(),document.addEventListener("click",i)}),l.addEventListener("click",e=>{Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea reiniciar el inventario a cero?",text:"Todos los productos e insumos del inventario se reiniciaran a cero.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(document.querySelector(".content-spinner1").style.display="grid",__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/reiniciarinv",t=yield fetch(e),o=yield t.json();document.querySelector(".content-spinner1").style.display="none",void 0!==o.exito?(msjalertToast("success","¡Éxito!",o.exito[0]),setTimeout(()=>{window.location.reload()},1270)):msjalertToast("error","¡Error!",o.error[0])}catch(e){console.log(e)}})))})}),null==L||L.addEventListener("change",e=>{e.target.checked&&(document.querySelector(".content-spinner1").style.display="grid",__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/getStockproductosXsucursal",t=yield fetch(e);D=yield t.json(),function(){const e=[...new Set(D.map(e=>e.sucursal))],t={};D.forEach(e=>{e.productoid&&(t["p"+e.productoid]||(t["p"+e.productoid]={nombreproducto:e.nombreproducto,stocks:{}}),t["p"+e.productoid].stocks[e.sucursal]=e.stock),e.subproductoid&&(t["s"+e.subproductoid]||(t["s"+e.subproductoid]={nombreproducto:"S-"+e.nombreproducto,stocks:{}}),t["s"+e.subproductoid].stocks[e.sucursal]=e.stock)});const o=[{title:"Producto",data:"nombreproducto"}];e.forEach(e=>{o.push({title:e,data:e})});const n=Object.values(t).map(t=>{const o={nombreproducto:t.nombreproducto};return e.forEach(e=>{var n;o[e]=null!==(n=t.stocks[e])&&void 0!==n?n:0}),o});S=$("#tablaInventarioSedes").DataTable({data:n,columns:o,layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"InventarioXsede"},{extend:"pdfHtml5",title:"InventarioXsede"},{extend:"print",title:"InventarioXsede",text:"Imprimir"},"colvis"],pageLength:"pageLength"}},pageLength:25,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando 1 de _MAX_ registros",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},destroy:!0})}(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}})))}),b=$("#tablaStockRapido").DataTable(configdatatablesstockrapido),null===(e=document.querySelector("#tablaStockRapido"))||void 0===e||e.addEventListener("click",e=>{var t,o,n,a,r,d;let c="";const l=e.target;for(l.closest(".btnsproducto")&&(_=l.closest(".btnsproducto").id,C="0",w=Number(l.closest(".btnsproducto").dataset.stock),document.querySelector("#nombreItemstockrapido").textContent=l.closest(".btnsproducto").dataset.nombre),l.closest(".btnssubproducto")&&(_=l.closest(".btnssubproducto").id,C="1",w=Number(l.closest(".btnssubproducto").dataset.stock),document.querySelector("#nombreItemstockrapido").textContent=l.closest(".btnssubproducto").dataset.nombre);m.firstChild;)m.removeChild(m.firstChild);if("0"==C){k.filter(e=>e.idproducto==_).forEach(e=>c+=`<option data-factor="${e.factorconversion}" value="${e.idproducto}" >${e.nombreunidaddestino}</option>`),m.insertAdjacentHTML("afterbegin",c)}if("1"==C){k.filter(e=>e.idsubproducto==_).forEach(e=>c+=`<option data-factor="${e.factorconversion}" value="${e.idsubproducto}" >${e.nombreunidaddestino}</option>`),m.insertAdjacentHTML("afterbegin",c)}((null===(t=e.target)||void 0===t?void 0:t.classList.contains("descontarStock"))||(null===(o=e.target.parentElement)||void 0===o?void 0:o.classList.contains("descontarStock")))&&function(e){u.textContent="Descontar cantidad a inventario",E="descontarstock",x=b.row(e.target.closest("tr")).index(),s.showModal(),document.addEventListener("click",i)}(e),((null===(n=e.target)||void 0===n?void 0:n.classList.contains("aumentarStock"))||(null===(a=e.target.parentElement)||void 0===a?void 0:a.classList.contains("aumentarStock")))&&function(e){u.textContent="Ingreasar cantidad a inventario",E="aumentarstock",x=b.row(e.target.closest("tr")).index(),s.showModal(),document.addEventListener("click",i)}(e),((null===(r=e.target)||void 0===r?void 0:r.classList.contains("ajustarStock"))||(null===(d=e.target.parentElement)||void 0===d?void 0:d.classList.contains("ajustarStock")))&&function(e){u.textContent="Ajustar cantidad a inventario",E="ajustarstock",x=b.row(e.target.closest("tr")).index(),s.showModal(),document.addEventListener("click",i)}(e)}),null===(t=document.querySelector("#formStock"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault(),q=Number(m.options[m.selectedIndex].dataset.factor);b.page.info();let t=q*Number(p.value);"descontarstock"==E&&(w-=t),"aumentarstock"==E&&(w+=t),"ajustarstock"==E&&(w=t),__awaiter(void 0,void 0,void 0,(function*(){var e;const o=new FormData;o.append("tipoitem",C),o.append("iditem",_),o.append("cantidad",t.toString());try{const t="/admin/api/"+E,n=yield fetch(t,{method:"POST",body:o}),r=yield n.json();void 0!==r.exito?(msjalertToast("success","¡Éxito!",r.exito[0]),null===(e=document.querySelector("#formStock"))||void 0===e||e.reset(),a([r.item[0]],C)):msjalertToast("error","¡Error!",r.error[0]),s.close(),document.removeEventListener("click",i)}catch(e){console.log(e)}}))}),$("#itemAproducir").select2({maximumSelectionLength:1}),$("#itemAproducir").on("change",e=>{const t=e.target.value,o=$("#itemAproducir option:selected");if(t){let e;!function(e){for(;null==y?void 0:y.firstChild;)y.removeChild(null==y?void 0:y.firstChild);e.forEach(e=>{const t=document.createElement("option");t.textContent=e.nombreunidaddestino,t.value=e.id,t.dataset.factor=e.factorconversion,y.appendChild(t)})}(k.filter(e=>e.idproducto==t)),e={stock:o.data("stock"),precio_compra:o.data("precio_compra"),precio_venta:o.data("precio_venta")},n(e)}}),g.forEach((e,t)=>{e.addEventListener("click",e=>{f.value&&(document.querySelector("#nombreItemAProducir").textContent=f.options[f.selectedIndex].textContent,0===t&&(E="aumentarstock",document.querySelector("#modalIngresarProduccion").textContent="Ingreasar produccion a inventario"),1===t&&(E="descontarstock",document.querySelector("#modalIngresarProduccion").textContent="Descontar catnidad de inventario"),2===t&&(E="ajustarstock",document.querySelector("#modalIngresarProduccion").textContent="Ajustar cantidad de inventario"),v.showModal(),document.addEventListener("click",i))})}),null===(o=document.querySelector("#formIngresarProduccion"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault(),q=Number(y.options[y.selectedIndex].dataset.factor);let t=q*Number(h.value);__awaiter(void 0,void 0,void 0,(function*(){var e;const o=new FormData;o.append("tipoitem","0"),o.append("iditem",f.value),o.append("cantidad",t.toString()),o.append("construccion","1");try{const t="/admin/api/"+E,r=yield fetch(t,{method:"POST",body:o}),d=yield r.json();void 0!==d.exito?(msjalertToast("success","¡Éxito!",d.exito[0]),null===(e=document.querySelector("#formIngresarProduccion"))||void 0===e||e.reset(),n(d.item[0]),void 0!==d.insumos&&a(d.insumos[0],"1"),$("#itemAproducir option:selected").data("stock",d.item[0].stock)):msjalertToast("error","¡Error!",d.error[0]),v.close(),document.removeEventListener("click",i)}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".categorias")){const n=document.querySelector("#crearCategoria"),a=document.querySelector("#miDialogoCategoria");let i,r=0,d=0;function o(e){e.target!==a&&"Salir"!==e.target.value&&"Actualizar"!==e.target.value||(a.close(),document.removeEventListener("click",o))}i=$("#tablaCategorias").DataTable(configdatatables),null==n||n.addEventListener("click",e=>{d=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateCategoria"))||void 0===e||e.reset(),document.querySelector("#formCrearUpdateCategoria").action="/admin/almacen/crear_categoria",document.querySelector("#idcategoria").value="0"}(),document.querySelector("#modalCategoria").textContent="Crear categoria",document.querySelector("#btnEditarCrearCategoria").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaCategorias"))||void 0===e||e.addEventListener("click",e=>{var t,n,c;const l=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarCategoria"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarCategoria")))&&function(e){var t,n,c,l,s;d=1;let u=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(u=null===(l=null===(c=e.target.parentElement)||void 0===c?void 0:c.parentElement)||void 0===l?void 0:l.id);document.querySelector("#modalCategoria").textContent="Actualizar categoria",document.querySelector("#btnEditarCrearCategoria").value="Actualizar",document.querySelector("#idcategoria").value=u,document.querySelector("#categoria").value=null===(s=e.target.closest(".acciones-btns"))||void 0===s?void 0:s.dataset.categoria,r=i.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==l?void 0:l.classList.contains("eliminarCategoria"))||(null===(c=l.parentElement)||void 0===c?void 0:c.classList.contains("eliminarCategoria")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);r=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la categoria?",text:"La categoria y sus productos asociados, seran eliminados definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarCategoria",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();a.length||void 0!==a.exito?(i.row(r+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateCategoria"))||void 0===t||t.addEventListener("submit",e=>{if(d){e.preventDefault();var t=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",$("#idcategoria").val()),e.append("nombre",$("#categoria").val());try{const n="/admin/api/actualizar_categoria",a=yield fetch(n,{method:"POST",body:e}),d=yield a.json();if(console.log(d),void 0!==d.exito){msjalertToast("success","¡Éxito!",d.exito[0]);const e=i.row(r+=t.start).data();e[1]=$("#categoria").val(),e[3]=`<div class="acciones-btns" id="${$("#idcategoria").val()}" data-categoria="${$("#categoria").val()}"><button class="btn-md btn-turquoise editarCategoria"><i class="fa-solid fa-pen-to-square"></i></button><button class="btn-md btn-red eliminarCategoria"><i class="fa-solid fa-trash-can"></i></button></div>`,i.row(r).data(e).draw(),i.page(t.page).draw("page")}else msjalertToast("error","¡Error!",d.error[0]);document.addEventListener("click",o)}catch(e){console.log(e)}}))}})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".compras")){const a=document.querySelector("#proveedor"),i=document.querySelector("#inputimpuesto"),r=document.querySelector("#nfactura"),d=document.querySelector("#fecha"),c=document.querySelector("#origenPago"),l=document.querySelector("#origenCaja"),s=document.querySelector("#origenBanco"),u=(document.querySelector("#formapago"),document.querySelector("#observacion")),m=document.querySelector("#btnvaciar"),p=document.querySelector("#miDialogoVaciar"),v=document.querySelector("#miDialogoRegistrarcompra"),f=document.querySelector("#tablaCompras tbody");let g,y=[],h=[];function t(){document.querySelector("#impuesto").textContent="% "+i.value,document.querySelector("#total").textContent="$ "+y.reduce((e,t)=>t.valorcompra+e,0).toLocaleString()}function o(){for(y.length=0;null==f?void 0:f.firstChild;)f.removeChild(null==f?void 0:f.firstChild);document.querySelector("#impuesto").textContent="% 0",document.querySelector("#total").textContent="$ 0"}function n(e){const t=e.target;(t===p||t===v||t.closest(".novaciar")||t.closest(".sivaciar")||t.closest(".nocomprar")||t.closest(".sicomprar"))&&(p.close(),v.close(),document.removeEventListener("click",n),t.closest(".sicomprar")&&(y.some(e=>Number.isNaN(e.valorcompra)||0==e.valorcompra)?msjalertToast("error","¡Error!","Verifica el valor de compra de la lista de productos"):function(e){__awaiter(this,void 0,void 0,(function*(){var t;const n=new FormData;n.append("idproveedor",a.options[a.selectedIndex].value),n.append("idorigencaja",l.options[l.selectedIndex].value),n.append("idorigenbanco",s.options[s.selectedIndex].value),n.append("nombreproveedor",a.options[a.selectedIndex].textContent),n.append("nfactura",r.value),n.append("impuesto",i.value),n.append("origenpago",c.options[c.selectedIndex].value),n.append("nombreorigenpago",c.options[c.selectedIndex].textContent+""),n.append("nombreorigencaja",l.options[l.selectedIndex].textContent+""),n.append("nombreorigenbanco",s.options[s.selectedIndex].value?s.options[s.selectedIndex].textContent+"":""),n.append("cantidaditems",y.reduce((e,t)=>t.cantidad+e,0)+""),n.append("observacion",u.value),n.append("estado",e),n.append("subtotal",y.reduce((e,t)=>t.valorcompra+e,0)+""),n.append("valortotal",y.reduce((e,t)=>t.valorcompra+e,0)+""),n.append("fechacompra",d.value),n.append("carrito",JSON.stringify(y)),n.append("subID",JSON.stringify(y.map(e=>{if(e.idsx)return e.idsx})));try{const e="/admin/api/registrarCompra",a=yield fetch(e,{method:"POST",body:n}),i=yield a.json();void 0!==i.exito?(msjalertToast("success","¡Éxito!",i.exito[0]),o(),null===(t=document.querySelector("#formComprar"))||void 0===t||t.reset()):msjalertToast("error","¡Error!",i.error[0])}catch(e){console.log(e)}}))}("paga")),t.closest(".sivaciar")&&o())}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",t=yield fetch(e);h=yield t.json(),console.log(h)}catch(e){console.log(e)}})),__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/totalitems",t=yield fetch(e),o=yield t.json();g=o.map(e=>{var t;return{id:e.id,text:e.nombre,tipo:null!==(t=e.tipoproducto)&&void 0!==t?t:"1",sku:e.sku,unidadmedida:e.unidadmedida}}),function(e){$("#articulo").select2({data:e,placeholder:"Selecciona un item",maximumSelectionLength:1})}(g)}catch(e){console.log(e)}})),null==i||i.addEventListener("input",()=>t()),c.addEventListener("change",e=>{var t,o,n,a;"0"==e.target.value?(null===(t=document.querySelector("#divBanco"))||void 0===t||t.classList.add("hidden"),null===(o=document.querySelector("#divBanco"))||void 0===o||o.removeAttribute("required")):(null===(n=document.querySelector("#divBanco"))||void 0===n||n.classList.remove("hidden"),null===(a=document.querySelector("#divBanco"))||void 0===a||a.setAttribute("required",""))}),$("#articulo").on("change",e=>{let t=$("#articulo").select2("data")[0];if(t){if(-1==y.findIndex(e=>e.iditem==t.id&&e.tipo==t.tipo)){const e=g.find(e=>e.id==t.id&&e.tipo==t.tipo),o={iditem:null==e?void 0:e.id,idpx:"0"==e.tipo?e.id:"NULL",idsx:"1"==e.tipo?e.id:"NULL",tipo:e.tipo,nombreitem:e.text,unidad:e.unidadmedida,cantidad:1,cantidadcomprado:1,factor:1,impuesto:0,valorunidad:0,subtotal:0,precio_compra:0,valorcompra:0};y=[...y,o],function(e,t,o){let n=`<option data-factor="1" value="" >${o}</option>`;const a=g.find(o=>o.id==e&&o.tipo==t);if("1"==t){n="";h.filter(t=>t.idsubproducto==e).forEach(e=>n+=`<option data-factor="${e.factorconversion}" value="${e.idsubproducto}" >${e.nombreunidaddestino}</option>`)}if("0"==t){n="";h.filter(t=>t.idproducto==e).forEach(e=>n+=`<option data-factor="${e.factorconversion}" value="${e.idproducto}" >${e.nombreunidaddestino}</option>`)}const i=document.createElement("TR");i.classList.add("itemselect"),i.dataset.id=""+e,i.dataset.tipo=""+t,i.insertAdjacentHTML("afterbegin",`<td class="!px-0 !py-2 text-xl text-gray-500 leading-5">${null==a?void 0:a.text}</td> \n            <td class="!p-2 text-xl text-gray-500 leading-5">\n                <select class="formulario__select selectunidad">\n                    ${n}  \n                </select>\n            </td>\n            <td class="!px-0 !py-2"><div class="flex"><button type="button"><span class="menos material-symbols-outlined">remove</span></button><input type="text" class="inputcantidad w-20 px-2 text-center" value="1" oninput="this.value = parseInt(this.value.replace(/[,.]/g, '')||1)"><button type="button"><span class="mas material-symbols-outlined">add</span></button></div></td>\n            <td class="!p-2 text-xl text-gray-500 leading-5"><input type="text" placeholder="Ingresa Valor Total Producto" class="inputcompra text-base sm:text-lg md:text-xl lg:text-2xl placeholder:text-sm sm:placeholder:text-base md:placeholder:text-lg lg:placeholder:text-xl bg-gray-50 border border-gray-300 text-gray-900 rounded-lg focus:border-indigo-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white h-14 focus:outline-none focus:ring-1" value="" oninput="this.value = parseInt(this.value.replace(/[,.]/g, '')||0)"></td>\n            <td class="accionestd"><div class="acciones-btns"><button class="btn-md btn-red eliminarItem"><i class="fa-solid fa-trash-can"></i></button></div></td>`),null==f||f.appendChild(i)}(t.id,t.tipo,t.unidadmedida)}}}),null==f||f.addEventListener("click",e=>{var o,n,a,i,r;const d=null===(o=e.target)||void 0===o?void 0:o.closest(".itemselect"),c=d.dataset.id,l=d.dataset.tipo,s=y.find(e=>e.iditem==c&&e.tipo==l);e.target.classList.contains("selectunidad")&&"eventSelect"!=e.target.dataset.event&&(null===(n=e.target)||void 0===n||n.addEventListener("change",e=>{const t=e.target;s.factor=Number(t.options[t.selectedIndex].dataset.factor)}),e.target.dataset.event="eventSelect"),e.target.classList.contains("menos")&&(s.cantidadcomprado--,s.cantidadcomprado<0&&(s.cantidadcomprado=0)),e.target.classList.contains("inputcantidad")&&"eventInput"!=e.target.dataset.event&&(null===(a=e.target)||void 0===a||a.addEventListener("input",e=>{s.cantidadcomprado=Number(e.target.value),s.cantidad=s.cantidadcomprado*s.factor}),e.target.dataset.event="eventInput"),e.target.classList.contains("mas")&&s.cantidadcomprado++,(null==f?void 0:f.querySelector(`TR[data-id="${c}"][data-tipo="${l}"] .inputcantidad`)).value=(null==s?void 0:s.cantidadcomprado)+"",e.target.classList.contains("inputcompra")&&"eventInput"!=e.target.dataset.event&&(null===(i=e.target)||void 0===i||i.addEventListener("input",e=>{s.valorcompra=Number(e.target.value),s.precio_compra=s.valorcompra/s.cantidad,t()}),e.target.dataset.event="eventInput"),(e.target.classList.contains("eliminarItem")||"I"==e.target.tagName)&&(y=y.filter(e=>e.iditem!=c||e.tipo!=l),null===(r=null==f?void 0:f.querySelector(`TR[data-id="${c}"][data-tipo="${l}"]`))||void 0===r||r.remove(),t()),s.cantidad=s.cantidadcomprado*s.factor}),null==m||m.addEventListener("click",()=>{y.length&&(p.showModal(),document.addEventListener("click",n))}),null===(e=document.querySelector("#formComprar"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault(),v.showModal(),document.addEventListener("click",n)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".ensamblaje")){const n=document.querySelector(".listaSubproductos"),a=document.querySelector("#unidadmedida");let i=document.querySelector("#cantidad"),r=[],d=0;function o(){var e;const t=null===(e=a.options[a.selectedIndex])||void 0===e?void 0:e.value,o=r.find(e=>e.id==t);d=Number(null==o?void 0:o.factorconversion)}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",t=yield fetch(e);r=yield t.json()}catch(e){console.log(e)}})),$("#subproducto").select2({maximumSelectionLength:1}),$("#subproducto").on("change",e=>{const t=e.target.value;!function(e){for(;null==a?void 0:a.firstChild;)a.removeChild(null==a?void 0:a.firstChild);e.forEach(e=>{const t=document.createElement("option");t.textContent=e.nombreunidaddestino,t.value=e.id,a.appendChild(t)}),o()}(r.filter(e=>e.idsubproducto==t))}),a.addEventListener("change",o),document.querySelector("#cantidad").addEventListener("input",e=>{o()}),null===(e=document.querySelector("#rendimientoestandar"))||void 0===e||e.addEventListener("input",e=>{const t=e.target;__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",document.querySelector("#idproducto").value),e.append("rendimientoestandar",t.value);try{const o="/admin/api/setrendimientoestandar",n=yield fetch(o,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(t.style.color="#02db02",t.style.fontWeight="500"):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))}),null===(t=document.querySelector("#formAddSubproducto"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault();const t=$("#subproducto").find("option:selected"),o=$("#unidadmedida").find("option:selected").text();let a=d*Number(i.value);__awaiter(void 0,void 0,void 0,(function*(){var e;const r=new FormData;r.append("id_producto",document.querySelector("#idproducto").value),r.append("id_subproducto",$("#subproducto").val()),r.append("cantidadsubproducto",a.toString()),r.append("costo",Number(t.data("costo"))*a+"");try{const a="/admin/api/ensamblar",d=yield fetch(a,{method:"POST",body:r}),c=yield d.json();void 0!==c.exito?(msjalertToast("success","¡Éxito!",c.exito[0]),function(e,t,o){const a=document.querySelector(`.listaSubproductos div[id="${e}"]`);a?a.querySelector("strong").textContent=i.value+" "+t:null==n||n.insertAdjacentHTML("beforeend",`\n                <div id="${e}" class="mb-4 flex items-center justify-between p-4 text-blue-600 bg-blue-100 rounded-lg shadow-md shadow-blue-500/30" role="alert">\n                    <p class="m-0"><strong>${i.value} ${t}</strong>.  ${o}</p>\n                    <button type="button"><span id="${e}" class="material-symbols-outlined">cancel</span></button>\n                </div>`)}($("#subproducto").val(),o,t.data("subproducto")),$("#subproducto").val([]).trigger("change"),null===(e=document.querySelector("#formAddSubproducto"))||void 0===e||e.reset()):msjalertToast("error","¡Error!",c.error[0])}catch(e){console.log(e)}}))}),null==n||n.addEventListener("click",e=>{const t=e.target;"SPAN"==t.tagName&&function(e,t){const o=document.querySelector(`.listaSubproductos div[id="${t}"]`);(()=>{__awaiter(this,void 0,void 0,(function*(){try{const n="/admin/api/desasociarsubproducto?idproducto="+e+"&idsubproducto="+t,a=yield fetch(n),i=yield a.json();void 0!==i.exito?(null==o||o.remove(),msjalertToast("success","¡Éxito!",i.exito[0])):msjalertToast("error","¡Error!",i.error[0])}catch(e){console.log(e)}}))})()}(document.querySelector("#idproducto").value,t.id)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gestionproveedores")){const n=document.querySelector("#crearProveedor"),a=document.querySelector("#miDialogoProveedor");let i,r,d=0,c=0,l=[];function o(e){e.target!==a&&"Salir"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allproveedores",t=yield fetch(e);l=yield t.json(),console.log(l)}catch(e){console.log(e)}})),i=$("#tablaProveedores").DataTable(configdatatables),n.addEventListener("click",()=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateProveedor"))||void 0===e||e.reset()}(),document.querySelector("#modalProveedor").textContent="Crear proveedor",document.querySelector("#btnEditarCrearProveedor").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaProveedores"))||void 0===e||e.addEventListener("click",e=>{var t,n,s;const u=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarProveedor"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarProveedor")))&&function(e){var t,n,s,u;let m=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(m=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);c=1,document.querySelector("#modalProveedor").textContent="Actualizar proveedor",document.querySelector("#btnEditarCrearProveedor").value="Actualizar",r=l.find(e=>e.id==m),document.querySelector("#nit").value=null==r?void 0:r.nit,document.querySelector("#nombreProveedor").value=null==r?void 0:r.nombre,d=i.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==u?void 0:u.classList.contains("eliminarProveedor"))||(null===(s=u.parentElement)||void 0===s?void 0:s.classList.contains("eliminarProveedor")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);d=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el proveedor?",text:"el proveedor sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarProveedor",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(i.row(d).remove().draw(),i.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateProveedor"))||void 0===t||t.addEventListener("submit",e=>{let t="crearProveedor";c&&(t="actualizarProveedor"),e.preventDefault();var n=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==r?void 0:r.id)?null==r?void 0:r.id:""),e.append("nit",$("#nit").val()),e.append("nombre",$("#nombreProveedor").val());try{const s="/admin/api/"+t,u=yield fetch(s,{method:"POST",body:e}),m=yield u.json();if(void 0!==m.exito)if(a.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),c){l.forEach(e=>{e.id==(null==r?void 0:r.id)&&(e=Object.assign(e,m.proveedor[0]))});const e=i.row(d+=n.start).data();e[1]=m.proveedor[0].nit,e[2]=m.proveedor[0].nombre,i.row(d).data(e).draw(),i.page(n.page).draw("page")}else l=[...l,m.proveedor],i.row.add([i.rows().count()+1,m.proveedor.nit,m.proveedor.nombre,m.proveedor.created_at,`<div class="acciones-btns" id="${m.proveedor.id}" data-proveedor="${m.proveedor.nombre}">\n                          <button class="btn-md btn-turquoise editarProveedor"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarProveedor"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".productos")){const n=document.querySelector("#crearProducto"),a=document.querySelector("#miDialogoProducto"),i=document.querySelector("#btnXCerrarModalproducto"),r=document.querySelector("#upImage"),d=document.querySelector("#customUpImage"),c=document.querySelector("#imginputfile"),l=document.querySelector("#tipoproducto"),s=document.querySelector("#contentnuevosprecios");let u,m,p=0,v=0,f=[];__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allproducts",t=yield fetch(e);f=yield t.json(),console.log(f)}catch(e){console.log(e)}}));const g=document.querySelector(".divmsjalerta0");g&&borrarMsjAlert(g),null==l||l.addEventListener("change",e=>{var t,o,n,a;const i=e.target,r=document.querySelector(".preciocompra"),d=document.querySelector(".stock"),c=document.querySelector(".habtipoproduccion");"0"==i.value?(d.style.display="flex",r.style.display="flex",c.style.display="none",null===(t=document.querySelector("#preciocompra"))||void 0===t||t.setAttribute("required",""),null===(o=document.querySelector("#tipoproduccion"))||void 0===o||o.removeAttribute("required")):(d.style.display="none",r.style.display="none",c.style.display="flex",null===(n=document.querySelector("#preciocompra"))||void 0===n||n.removeAttribute("required"),null===(a=document.querySelector("#tipoproduccion"))||void 0===a||a.setAttribute("required",""))}),i.addEventListener("click",e=>{a.close(),document.removeEventListener("click",o)});const y=document.querySelector("#btnAddNewPrice");if(y){y.addEventListener("click",e=>{var t;let o=null===(t=e.target.previousElementSibling)||void 0===t?void 0:t.cloneNode(!0);o.removeAttribute("id"),o.value="",o.name="nuevosprecios[]",o.classList.add("nuevosprecios"),s.appendChild(o),console.log(o)})}function o(e){"salir"===e.target.value&&(a.close(),document.removeEventListener("click",o))}u=$("#tablaProductos").DataTable(configdatatables),null==n||n.addEventListener("click",e=>{for(v=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateProducto"))||void 0===e||e.reset(),c.src=""}();s.firstChild;)s.removeChild(s.firstChild);document.querySelector("#modalProducto").textContent="Crear producto",document.querySelector("#btnEditarCrearProducto").value="Crear",document.querySelector(".stock").style.display="block",document.querySelector(".preciocompra").style.display="block",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaProductos"))||void 0===e||e.addEventListener("click",e=>{var t,n,i,r;const d=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarProductos"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarProductos")))&&function(e){var t,n,i,r,d,l,g,y,h,b,S,w,x;let E=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(E=null===(r=null===(i=e.target.parentElement)||void 0===i?void 0:i.parentElement)||void 0===r?void 0:r.id);v=1,document.querySelector("#modalProducto").textContent="Actualizar producto",document.querySelector("#btnEditarCrearProducto").value="Actualizar",m=f.find(e=>e.id===E),$("#categoria").val(null!==(d=null==m?void 0:m.idcategoria)&&void 0!==d?d:""),document.querySelector("#nombre").value=null==m?void 0:m.nombre,$("#tipoproducto").val(null!==(l=null==m?void 0:m.tipoproducto)&&void 0!==l?l:"0"),$("#idunidadmedida").val(null!==(g=null==m?void 0:m.idunidadmedida)&&void 0!==g?g:"1"),document.querySelector(".stock").style.display="block",document.querySelector(".preciocompra").style.display="block",document.querySelector(".habtipoproduccion").style.display="none","1"==(null==m?void 0:m.tipoproducto)&&(document.querySelector(".stock").style.display="none",document.querySelector(".preciocompra").style.display="none",document.querySelector(".habtipoproduccion").style.display="block",$("#tipoproduccion").val(m.tipoproduccion));document.querySelector("#stock").value=null!==(y=null==m?void 0:m.stock)&&void 0!==y?y:"",document.querySelector("#preciocompra").value=null!==(h=null==m?void 0:m.precio_compra)&&void 0!==h?h:"",document.querySelector("#precioventa").value=null!==(b=null==m?void 0:m.precio_venta)&&void 0!==b?b:"",document.querySelector("#precioventa").dataset.idproductoid=m.id,function(e){for(;s.firstChild;)s.removeChild(s.firstChild);e.forEach(e=>{s.insertAdjacentHTML("afterbegin",`<input \n          data-id="${e.id}"\n          class="nuevosprecios bg-gray-50 border border-gray-300 text-gray-900 rounded-lg focus:border-indigo-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white h-14 text-xl focus:outline-none focus:ring-1"\n          type="number" \n          min="0" \n          step="0.01"\n          placeholder="Precio de venta incluido el impuesto" \n          name="nuevosprecios[]" \n          value="${e.precio}" \n          required>`)})}(m.preciosadicionales),document.querySelector("#sku").value=null!==(S=null==m?void 0:m.sku)&&void 0!==S?S:"",document.querySelector("#impuesto").value=null!==(w=null==m?void 0:m.impuesto)&&void 0!==w?w:"",document.querySelector("#stockminimo").value=null!==(x=null==m?void 0:m.stockminimo)&&void 0!==x?x:"",c.src="/build/img/"+(null==m?void 0:m.foto),p=u.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==d?void 0:d.classList.contains("bloquearProductos"))||(null===(i=d.parentElement)||void 0===i?void 0:i.classList.contains("bloquearProductos")))&&function(e){let t=e.target.parentElement,o=u.page.info();"SPAN"===e.target.tagName&&(t=e.target.parentElement.parentElement);p=u.row(e.target.closest("tr")).index(),(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t.id);try{const n="/admin/api/cambiarestadoproducto",a=yield fetch(n,{method:"POST",body:e}),i=yield a.json();if(void 0!==i.exito){const e=`<div class="acciones-btns my-[0.7rem]" id="${t.id}">\n                              ${1==i.tipoproducto[0]?`<a class="btn-xs btn-blue" title="Agregar Materia Prima" href="/admin/almacen/componer?id=${t.id}"><i class="fa-solid fa-subscript text-[17px] leading-none"></i></a>`:""}\n                              <button class="btn-xs btn-lima" title="Más opciones"><i class="fa-solid fa-circle-plus text-[17px] leading-none"></i></button>\n                              <button class="btn-xs btn-turquoise editarProductos" title="Actualizar Producto"><i class="fa-solid fa-pen-to-square text-[17px] leading-none"></i></button>\n                              <button class="btn-xs ${1==i.estado[0]?"btn-light":"btn-orange"} bloquearProductos" title="Bloquear Producto"><span class="material-symbols-outlined text-[18px] leading-none">hide_source</span></button>\n                              <button class="btn-xs btn-red eliminarProductos" title="Eliminar Producto"><i class="fa-solid fa-trash-can text-[17px] leading-none"></i></button>\n                            </div>`;u.cell(u.row(p),7).data(e).draw(),u.page(o.page).draw("page"),msjalertToast("success","¡Éxito!",i.exito[0])}else Swal.fire(i.error[0],"","error")}catch(e){console.log(e)}}))})()}(e),((null==d?void 0:d.classList.contains("eliminarProductos"))||(null===(r=d.parentElement)||void 0===r?void 0:r.classList.contains("eliminarProductos")))&&function(e){let t=e.target.parentElement.id,o=u.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);p=u.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el prducto?",text:"El prducto sera eliminado definitivamente de todas las SEDES.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarProducto",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(u.row(p).remove().draw(),u.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateProducto"))||void 0===t||t.addEventListener("submit",e=>{var t;let n=document.querySelectorAll(".nuevosprecios");if(v){e.preventDefault();var i,r=u.page.info();if(i=m.foto,!c.src.includes(m.foto)&&(i=null===(t=e.target.elements.namedItem("upImage").files)||void 0===t?void 0:t[0])){if("image/png"!==i.type&&"image/jpeg"!==i.type)return void msjAlert("error","No es un formato valido para la foto",document.querySelector("#divmsjalerta1"));if(i.size>31e6)return void msjAlert("error","La imagen no debe superar los 500KB",document.querySelector("#divmsjalerta1"))}__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",m.id),e.append("idcategoria",$("#categoria").val()),e.append("nombre",$("#nombre").val()),e.append("foto",i),e.append("tipoproducto",$("#tipoproducto").val()),e.append("idunidadmedida",$("#idunidadmedida").val()),e.append("unidadmedida",$("#idunidadmedida option:selected").text()),e.append("stock",$("#stock").val()),e.append("precio_compra",$("#preciocompra").val()),e.append("precio_venta",$("#precioventa").val()),e.append("nuevosprecios",JSON.stringify(Array.from(n).map(e=>({id:e.dataset.id,idproductoid:e.dataset.idproductoid,precio:parseFloat(e.value),estado:1})).filter(e=>e.precio>0))),e.append("idprecionsadicionales",JSON.stringify(Array.from(n).filter(e=>e.dataset.id&&parseFloat(e.value)>0).map(e=>e.dataset.id))),e.append("sku",$("#sku").val()),e.append("tipoproduccion",null==$("#tipoproduccion").val()?"0":$("#tipoproduccion").val()),e.append("impuesto",$("#impuesto").val()),e.append("stockminimo",$("#stockminimo").val());try{const t="/admin/api/actualizarproducto",n=yield fetch(t,{method:"POST",body:e}),i=yield n.json();if(console.log(i),void 0!==i.exito){msjalertToast("success","¡Éxito!",i.exito[0]),f.forEach(e=>{e.id==m.id&&(e=Object.assign(e,i.producto[0]))});const e=u.row(p).data();e[1]=`<div class="text-center"><img class="inline" style="width: 50px;" src="/build/img/${i.producto[0].foto}" alt=""></div>`,e[2]='<div class="w-80 whitespace-normal">'+$("#nombre").val()+"</div>",e[3]=$("#categoria option:selected").text(),e[4]="",e[5]=$("#sku").val(),e[6]=$("#precioventa").val(),u.row(p).data(e).draw(),u.page(r.page).draw("page")}else msjalertToast("error","¡Error!",i.error[0]);a.close(),document.removeEventListener("click",o)}catch(e){console.log(e)}}))}}),null==d||d.addEventListener("click",()=>null==r?void 0:r.click()),null==r||r.addEventListener("change",(function(){var e;const t=null===(e=this.files)||void 0===e?void 0:e[0];if(t){const e=new FileReader;e.onload=function(){const t=e.result;"string"==typeof t&&(c.src=t)},e.readAsDataURL(t)}}))}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".subproductos")){const n=document.querySelector("#crearSubProducto"),a=document.querySelector("#miDialogoSubProducto");let i,r,d=0,c=0,l=[];function o(e){e.target!==a&&"salir"!==e.target.value&&"Actualizar"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allsubproducts",t=yield fetch(e);l=yield t.json(),console.log(l)}catch(e){console.log(e)}})),i=$("#tablaSubProductos").DataTable(configdatatables),null==n||n.addEventListener("click",e=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateSubProducto"))||void 0===e||e.reset(),document.querySelector("#formCrearUpdateSubProducto").action="/admin/almacen/crear_subproducto"}(),document.querySelector("#modalSubProducto").textContent="Crear sub producto",document.querySelector("#btnEditarCrearSubProducto").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaSubProductos"))||void 0===e||e.addEventListener("click",e=>{var t,n;const s=e.target;((null==s?void 0:s.classList.contains("editarSubProductos"))||(null===(t=s.parentElement)||void 0===t?void 0:t.classList.contains("editarSubProductos")))&&function(e){var t,n,s,u,m,p,v;let f=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(f=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);c=1,document.querySelector("#modalSubProducto").textContent="Actualizar producto",document.querySelector("#btnEditarCrearSubProducto").value="Actualizar",r=l.find(e=>e.id===f),$("#unidadmedida").val(null!==(m=null==r?void 0:r.id_unidadmedida)&&void 0!==m?m:""),document.querySelector("#nombre").value=null==r?void 0:r.nombre,document.querySelector("#sku").value=null==r?void 0:r.sku,document.querySelector("#preciocompra").value=null!==(p=null==r?void 0:r.precio_compra)&&void 0!==p?p:"",document.querySelector("#stockminimo").value=null!==(v=null==r?void 0:r.stockminimo)&&void 0!==v?v:"",d=i.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==s?void 0:s.classList.contains("eliminarSubProductos"))||(null===(n=s.parentElement)||void 0===n?void 0:n.classList.contains("eliminarSubProductos")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);d=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el sub prducto?",text:"El sub prducto sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarSubProducto",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(i.row(d).remove().draw(),i.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateSubProducto"))||void 0===t||t.addEventListener("submit",e=>{if(c){e.preventDefault();var t=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){var e;const n=new FormData;n.append("id",r.id),n.append("id_unidadmedida",$("#unidadmedida").val()),n.append("unidadmedida",$("#unidadmedida").find("option:selected").text()),n.append("nombre",$("#nombre").val()),n.append("sku",$("#sku").val()),n.append("precio_compra",$("#preciocompra").val()),n.append("stockminimo",$("#stockminimo").val());try{const a="/admin/api/actualizarsubproducto",c=yield fetch(a,{method:"POST",body:n}),s=yield c.json();if(console.log(s),void 0!==s.exito){msjalertToast("success","¡Éxito!",s.exito[0]),l.forEach(e=>{e.id==r.id&&(e=Object.assign(e,s.subproducto[0]))});const o=i.row(d+=t.start).data();o[1]='<div class="w-80 whitespace-normal">'+$("#nombre").val()+"</div>",o[2]="",o[3]=$("#sku").val(),o[4]=$("#unidadmedida option:selected").text(),o[5]="$"+(null===(e=Number($("#preciocompra").val()))||void 0===e?void 0:e.toLocaleString()),i.row(d).data(o).draw(),i.page(t.page).draw("page")}else msjalertToast("error","¡Error!",s.error[0]);document.addEventListener("click",o)}catch(e){console.log(e)}}))}})}})(),(()=>{var e;if(document.querySelector(".unidadesmedida")){const o=document.querySelector("#btnCrearUnidadMedida"),n=document.querySelector("#miDialogoUnidadMedida");let a;function t(e){const o=e.target;o!==n&&"Salir"!==o.value&&"Actualizar"!==o.value||(n.close(),document.removeEventListener("click",t))}a=$("#tablaUnidadesMedida").DataTable(configdatatables),null==o||o.addEventListener("click",e=>{!function(){var e;null===(e=document.querySelector("#formCrearUpdateUnidad"))||void 0===e||e.reset(),document.querySelector("#formCrearUpdateUnidad").action="/admin/almacen/crear_unidadmedida"}(),document.querySelector("#modalUnidadMedida").textContent="Crear unidad de medida",document.querySelector("#btnEditarCrearUnidadMedida").value="Crear",n.showModal(),document.addEventListener("click",t)}),null===(e=document.querySelector("#tablaUnidadesMedida"))||void 0===e||e.addEventListener("click",e=>{var o,a,i=e.target;((null==i?void 0:i.classList.contains("editarUnidadMedida"))||(null===(o=i.parentElement)||void 0===o?void 0:o.classList.contains("editarUnidadMedida")))&&function(e){var o,a,i,r,d;let c=null===(o=e.target.parentElement)||void 0===o?void 0:o.id;"I"===(null===(a=e.target)||void 0===a?void 0:a.tagName)&&(c=null===(r=null===(i=e.target.parentElement)||void 0===i?void 0:i.parentElement)||void 0===r?void 0:r.id);document.querySelector("#formCrearUpdateUnidad").action="/admin/almacen/editarunidademedida",document.querySelector("#modalUnidadMedida").textContent="Actualizar unidad de medida",document.querySelector("#btnEditarCrearUnidadMedida").value="Actualizar",document.querySelector("#idunidadmedida").value=c,document.querySelector("#unidad").value=null===(d=e.target.closest(".acciones-btns"))||void 0===d?void 0:d.dataset.unidadmedida,n.showModal(),document.addEventListener("click",t)}(e),((null==i?void 0:i.classList.contains("eliminarUnidadMedida"))||(null===(a=i.parentElement)||void 0===a?void 0:a.classList.contains("eliminarUnidadMedida")))&&function(e){let t=e.target.parentElement;"I"===e.target.tagName&&(t=t.parentElement);Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la unidad de medida?",text:"La unidad de medida sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&t.submit()})}(e)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};!function(){var e,t,o;if(document.querySelector(".empleados")){const a=document.querySelector("#crearempleado"),i=document.getElementById("miDialogoEmpleado"),r=document.getElementById("miDialogoContraseña"),d=document.querySelector("#upImage"),c=document.querySelector("#customUpImage"),l=document.querySelector("#imginputfile"),s=document.querySelector("#nombreempleado"),u=document.querySelector("#apellidoempleado"),m=document.querySelector("#nicknameempleado"),p=document.querySelector("#passwordempleado"),v=document.querySelector("#passwordempleado2 "),f=document.querySelector("#movilempleado "),g=document.querySelector("#perfilempleado");let y,h,b=0,S=0,w=[];function n(e){e.target!==i&&e.target!==r&&"Cancelar"!==e.target.value||(i.close(),null==r||r.close(),document.removeEventListener("click",n))}(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/getAllemployee",t=yield fetch(e);w=yield t.json()}catch(e){console.log(e)}}))})(),g.addEventListener("change",e=>{"2"==e.target.value&&(document.querySelector("#contentpermisos").style.display="none",document.querySelector("#contentpermisosadmin").style.display="none"),"3"==e.target.value&&(document.querySelector("#contentpermisos").style.display="none",document.querySelector("#contentpermisosadmin").style.display="block"),"4"==e.target.value&&(document.querySelector("#contentpermisos").style.display="block",document.querySelector("#contentpermisosadmin").style.display="none")}),y=$("#tablaempleados").DataTable(configdatatables),a.addEventListener("click",e=>{S=0,function(){var e;l.src=" ",null===(e=document.querySelector("#formCrearUpdateEmpleado"))||void 0===e||e.reset()}(),document.querySelector("#campopass1").style.display="",document.querySelector("#campopass2").style.display="",document.querySelector("#passwordempleado").setAttribute("required","true"),document.querySelector("#passwordempleado2").setAttribute("required","true"),document.querySelector("#modalEmpleado").textContent="Crear empleado",document.querySelector("#btnEditarCrearEmpleado").value="Crear",i.showModal(),document.addEventListener("click",n)}),c.addEventListener("click",()=>d.click()),d.addEventListener("change",(function(){var e;const t=null===(e=this.files)||void 0===e?void 0:e[0];if(t){const e=new FileReader;e.onload=function(){const t=e.result;"string"==typeof t&&(l.src=t)},e.readAsDataURL(t)}})),null===(e=document.querySelector("#tablaempleados"))||void 0===e||e.addEventListener("click",e=>{var t,o,a,d,c;const p=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarEmpleado"))||(null===(o=e.target.parentElement)||void 0===o?void 0:o.classList.contains("editarEmpleado")))&&function(e){var t,o,a,r,d,c,p,v,g,x;let E=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(o=e.target)||void 0===o?void 0:o.tagName)&&(E=null===(r=null===(a=e.target.parentElement)||void 0===a?void 0:a.parentElement)||void 0===r?void 0:r.id);S=1,document.querySelector("#campopass1").style.display="none",document.querySelector("#campopass2").style.display="none",document.querySelector("#passwordempleado").removeAttribute("required"),document.querySelector("#passwordempleado2").removeAttribute("required"),document.querySelector("#modalEmpleado").textContent="Actualizar Empleado",document.querySelector("#btnEditarCrearEmpleado").value="Actualizar",h=w.find(e=>e.id==E),l.src="/build/img/"+(null==h?void 0:h.img),s.value=null!==(d=null==h?void 0:h.nombre)&&void 0!==d?d:"",u.value=null!==(c=null==h?void 0:h.apellido)&&void 0!==c?c:"",m.value=null!==(p=null==h?void 0:h.nickname)&&void 0!==p?p:"",f.value=null!==(v=null==h?void 0:h.movil)&&void 0!==v?v:"",$("#perfilempleado").val(null!==(g=null==h?void 0:h.perfil)&&void 0!==g?g:""),"2"==(null==h?void 0:h.perfil)&&(document.querySelector("#contentpermisos").style.display="none",document.querySelector("#contentpermisosadmin").style.display="none");"3"==(null==h?void 0:h.perfil)&&(document.querySelector("#contentpermisos").style.display="none",document.querySelector("#contentpermisosadmin").style.display="block");"4"==(null==h?void 0:h.perfil)&&(document.querySelector("#contentpermisos").style.display="block",document.querySelector("#contentpermisosadmin").style.display="none");q=null!==(x=null==h?void 0:h.permisos)&&void 0!==x?x:[],document.querySelectorAll('#contentpermisos input[type="checkbox"]').forEach(e=>{e.checked=!1}),q.forEach(e=>{document.querySelector(`input[value="${e.id}"]`).checked=!0}),b=y.row(e.target.closest("tr")).index(),i.showModal(),document.addEventListener("click",n);var q}(e),((null===(a=e.target)||void 0===a?void 0:a.classList.contains("updatePassword"))||(null===(d=e.target.parentElement)||void 0===d?void 0:d.classList.contains("updatePassword")))&&function(e){var t,o,a,i;let d=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===e.target.tagName&&(d=null===(a=null===(o=e.target.parentElement)||void 0===o?void 0:o.parentElement)||void 0===a?void 0:a.id);h=w.find(e=>e.id==d),document.querySelector("#nombreEmpleadoPass").textContent=(null==h?void 0:h.nombre)+" "+(null!==(i=null==h?void 0:h.apellido)&&void 0!==i?i:""),null==r||r.showModal(),document.addEventListener("click",n)}(e),((null==p?void 0:p.classList.contains("eliminarEmpleado"))||(null===(c=p.parentElement)||void 0===c?void 0:c.classList.contains("eliminarEmpleado")))&&function(e){let t=e.target.parentElement.id,o=y.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);b=y.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el empleado?",text:"El empleado sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const n="/admin/api/eliminarEmpleado",a=yield fetch(n,{method:"POST",body:e}),i=yield a.json();void 0!==i.exito?(y.row(b).remove().draw(),y.page(o.page).draw("page"),w=w.filter(e=>e.id!=t),Swal.fire(i.exito[0],"","success")):Swal.fire(i.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateEmpleado"))||void 0===t||t.addEventListener("submit",e=>{var t;if(S){e.preventDefault();var o,a=y.page.info();if(o=h.img,!l.src.includes(h.img)&&(o=null===(t=e.target.elements.namedItem("upImage").files)||void 0===t?void 0:t[0])){if("image/png"!==o.type&&"image/jpeg"!==o.type)return void msjAlert("error","No es un formato valido para la foto",document.querySelector("#divmsjalertaempleado1"));if(o.size>55e4)return void msjAlert("error","La imagen no debe superar los 500KB",document.querySelector("#divmsjalertaempleado1"))}var r=[];document.querySelectorAll('#contentpermisos input[type="checkbox"]').forEach(e=>{var t,o;e.checked&&(r=[...r,{id:e.value,nombre:null!==(o=null===(t=e.nextElementSibling)||void 0===t?void 0:t.textContent)&&void 0!==o?o:"permiso"}])}),(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",h.id),e.append("img",o),e.append("nombre",s.value),e.append("apellido",u.value),e.append("nickname",m.value),e.append("password",p.value),e.append("password2",v.value),e.append("movil",f.value),e.append("perfil",g.value),e.append("idpermisos",JSON.stringify(r.map(e=>e.id)));try{const t="/admin/api/actualizarEmpleado",o=yield fetch(t,{method:"POST",body:e}),d=yield o.json();if(void 0!==d.exito){msjalertToast("success","¡Éxito!",d.exito[0]);const e=y.row(b+=a.start).data();e[1]=s.value+" "+u.value,e[2]=`<div class="text-center"><img style="width: 40px;" src="/build/img/${d.rutaimg}" alt=""></div>`,e[3]=m.value,e[6]="1"===g.value?"root":"2"==g.value?"Superior":"3"==g.value?"Admin":"Asesor",w.forEach(e=>{e.id==(null==h?void 0:h.id)&&(e.permisos=r,e.img=d.rutaimg)}),y.row(b).data(e).draw(),y.page(a.page).draw("page")}else msjalertToast("error","¡Error!",d.error[0]);i.close(),document.removeEventListener("click",n)}catch(e){console.log(e)}}))})()}}),null===(o=document.querySelector("#formContraseña"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault(),(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",h.id),e.append("password",document.querySelector("#changePassword").value);try{const t="/admin/api/updatepassword",o=yield fetch(t,{method:"POST",body:e}),a=yield o.json();void 0!==a.exito?msjalertToast("success","¡Éxito!",a.exito[0]):msjalertToast("error","¡Error!",a.exito[0]),null==r||r.close(),document.removeEventListener("click",n)}catch(e){console.log(e)}}))})()})}}();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gestionbancos")){const n=document.querySelector("#crearBanco"),a=document.querySelector("#miDialogoBanco");let i,r,d=0,c=0,l=[];function o(e){e.target!==a&&"Salir"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allbancos",t=yield fetch(e);l=yield t.json()}catch(e){console.log(e)}})),i=$("#tablaBancos").DataTable(configdatatables),n.addEventListener("click",()=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateBanco"))||void 0===e||e.reset()}(),document.querySelector("#modalBanco").textContent="Crear banco",document.querySelector("#btnEditarCrearBanco").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaBancos"))||void 0===e||e.addEventListener("click",e=>{var t,n,s;const u=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarBanco"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarBanco")))&&function(e){var t,n,s,u;let m=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(m=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);c=1,document.querySelector("#modalBanco").textContent="Actualizar banco",document.querySelector("#btnEditarCrearBanco").value="Actualizar",r=l.find(e=>e.id==m),document.querySelector("#nombreBanco").value=null==r?void 0:r.nombre,document.querySelector("#numeroCuenta").value=null==r?void 0:r.numerocuenta,d=i.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==u?void 0:u.classList.contains("eliminarBanco"))||(null===(s=u.parentElement)||void 0===s?void 0:s.classList.contains("eliminarBanco")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);d=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el banco?",text:"El banco sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarBanco",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(i.row(d+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateBanco"))||void 0===t||t.addEventListener("submit",e=>{let t="crearBanco";c&&(t="actualizarBanco"),e.preventDefault();var n=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==r?void 0:r.id)?null==r?void 0:r.id:""),e.append("nombre",$("#nombreBanco").val()),e.append("numerocuenta",$("#numeroCuenta").val());try{const s="/admin/api/"+t,u=yield fetch(s,{method:"POST",body:e}),m=yield u.json();if(void 0!==m.exito)if(a.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),c){l.forEach(e=>{e.id==(null==r?void 0:r.id)&&(e=Object.assign(e,m.banco[0]))});const e=i.row(d+=n.start).data();e[1]=m.banco[0].nombre,e[2]=m.banco[0].numerocuenta,i.row(d).data(e).draw(),i.page(n.page).draw("page")}else l=[...l,m.banco],i.row.add([i.rows().count()+1,m.banco.nombre,m.banco.numerocuenta,m.banco.created_at,`<div class="acciones-btns" id="${m.banco.id}" data-banco="${m.banco.nombre}">\n                          <button class="btn-md btn-turquoise editarBanco"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarBanco"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gestioncajas")){const n=document.querySelector("#crearCaja"),a=document.querySelector("#miDialogoCaja");let i,r,d=0,c=0,l=[];function o(e){e.target!==a&&"Salir"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allcajas",t=yield fetch(e);l=yield t.json()}catch(e){console.log(e)}})),i=$("#tablaCajas").DataTable(configdatatables),n.addEventListener("click",()=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateCaja"))||void 0===e||e.reset()}(),document.querySelector("#modalCaja").textContent="Crear caja",document.querySelector("#btnEditarCrearCaja").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaCajas"))||void 0===e||e.addEventListener("click",e=>{var t,n,s;const u=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarCaja"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarCaja")))&&function(e){var t,n,s,u,m;let p=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(p=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);c=1,document.querySelector("#modalCaja").textContent="Actualizar caja",document.querySelector("#btnEditarCrearCaja").value="Actualizar",r=l.find(e=>e.id==p),document.querySelector("#nombrecaja").value=null==r?void 0:r.nombre,$("#idtipoconsecutivo").val(null!==(m=null==r?void 0:r.idtipoconsecutivo)&&void 0!==m?m:""),$("#negociogestioncaja").val(1),d=i.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==u?void 0:u.classList.contains("eliminarCaja"))||(null===(s=u.parentElement)||void 0===s?void 0:s.classList.contains("eliminarCaja")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);d=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la caja?",text:"La caja sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarCaja",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(i.row(d+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateCaja"))||void 0===t||t.addEventListener("submit",e=>{let t="crearCaja";c&&(t="actualizarCaja"),e.preventDefault();var n=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==r?void 0:r.id)?null==r?void 0:r.id:""),e.append("idtipoconsecutivo",$("#idtipoconsecutivo").val()),e.append("nombre",$("#nombrecaja").val()),e.append("negocio",$("#negociogestioncaja").val());try{const s="/admin/api/"+t,u=yield fetch(s,{method:"POST",body:e}),m=yield u.json();if(void 0!==m.exito)if(a.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),c){l.forEach(e=>{e.id==(null==r?void 0:r.id)&&(e=Object.assign(e,m.caja[0]))});const e=i.row(d+=n.start).data();e[1]=m.caja[0].nombre,e[2]=$("#idtipoconsecutivo option:selected").text(),e[3]=$("#negociogestioncaja option:selected").text(),i.row(d).data(e).draw(),i.page(n.page).draw("page")}else l=[...l,m.caja],i.row.add([i.rows().count()+1,m.caja.nombre,m.caja.nombreconsecutivo.nombre,m.caja.negocio,`<div class="acciones-btns" id="${m.caja.id}" data-caja="${m.caja.nombre}">\n                          <button class="btn-md btn-turquoise editarCaja"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarCaja"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gestionfacturadores")){const n=window.POS,a=document.querySelector("#crearFacturador"),i=document.querySelector("#miDialogoFacturador");let r,d,c=0,l=0,s=[];function o(e){e.target!==i&&"Salir"!==e.target.value||(i.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allfacturadores",t=yield fetch(e);s=yield t.json(),n.facturadores=s}catch(e){console.log(e)}})),r=$("#tablaFacturadores").DataTable(configdatatables),a.addEventListener("click",()=>{l=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateFacturador"))||void 0===e||e.reset()}(),document.querySelector("#modalFacturador").textContent="Crear facturador",document.querySelector("#btnEditarCrearFacturador").value="Crear",i.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaFacturadores"))||void 0===e||e.addEventListener("click",e=>{var t,n,a;const u=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarFacturador"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarFacturador")))&&function(e){var t,n,a,u,m,p,v,f,g,y,h,b;let S=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(S=null===(u=null===(a=e.target.parentElement)||void 0===a?void 0:a.parentElement)||void 0===u?void 0:u.id);l=1,document.querySelector("#modalFacturador").textContent="Actualizar facturador",document.querySelector("#btnEditarCrearFacturador").value="Actualizar",d=s.find(e=>e.id==S),document.querySelector("#nombrefacturador").value=null==d?void 0:d.nombre,$("#idtipofacturador").val(null!==(m=null==d?void 0:d.idtipofacturador)&&void 0!==m?m:""),$("#rangoinicial").val(null!==(p=null==d?void 0:d.rangoinicial)&&void 0!==p?p:""),$("#rangofinal").val(null!==(v=null==d?void 0:d.rangofinal)&&void 0!==v?v:""),$("#siguientevalor").val(null!==(f=null==d?void 0:d.siguientevalor)&&void 0!==f?f:""),$("#fechainicio").val(null!==(g=null==d?void 0:d.fechainicio)&&void 0!==g?g:""),$("#fechafin").val(null!==(y=null==d?void 0:d.fechafin)&&void 0!==y?y:""),$("#resolucion").val(null!==(h=null==d?void 0:d.resolucion)&&void 0!==h?h:""),$("#prefijo").val(null!==(b=null==d?void 0:d.prefijo)&&void 0!==b?b:""),$("#negociofacturador").val(1),c=r.row(e.target.closest("tr")).index(),i.showModal(),document.addEventListener("click",o)}(e),((null==u?void 0:u.classList.contains("eliminarFacturador"))||(null===(a=u.parentElement)||void 0===a?void 0:a.classList.contains("eliminarFacturador")))&&function(e){let t=e.target.parentElement.id,o=r.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);c=r.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el facturador?",text:"El facturador sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const n="/admin/api/eliminarFacturador",a=yield fetch(n,{method:"POST",body:e}),i=yield a.json();void 0!==i.exito?(r.row(c+o.start).remove().draw(),r.page(o.page).draw("page"),function(e){const t=document.querySelector("#idtipoconsecutivo").querySelector(`option[value="${e}"]`);null==t||t.remove()}(t),Swal.fire(i.exito[0],"","success")):Swal.fire(i.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateFacturador"))||void 0===t||t.addEventListener("submit",e=>{let t="crearFacturador";l&&(t="actualizarFacturador"),e.preventDefault();var n=r.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==d?void 0:d.id)?null==d?void 0:d.id:""),e.append("idtipofacturador",$("#idtipofacturador").val()),e.append("idnegocio",$("#negociofacturador").val()),e.append("nombre",$("#nombrefacturador").val()),e.append("rangoinicial",$("#rangoinicial").val()),e.append("rangofinal",$("#rangofinal").val()),e.append("siguientevalor",$("#siguientevalor").val()),e.append("fechainicio",$("#fechainicio").val()),e.append("fechafin",$("#fechafin").val()),e.append("resolucion",$("#resolucion").val()),e.append("prefijo",$("#prefijo").val());try{const a="/admin/api/"+t,u=yield fetch(a,{method:"POST",body:e}),m=yield u.json();if(void 0!==m.exito)if(i.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),l){s.forEach(e=>{e.id==(null==d?void 0:d.id)&&(e=Object.assign(e,m.facturador[0]))});const e=r.row(c+=n.start).data();e[1]=m.facturador[0].nombre,e[2]=m.facturador[0].nombretipofacturador,e[3]=m.facturador[0].rangoinicial,e[4]=m.facturador[0].siguientevalor,e[5]=m.facturador[0].fechafin,e[6]=1==m.facturador.estado?"Activo":"Inactivo",r.row(c).data(e).draw(),r.page(n.page).draw("page"),function(e,t){const o=document.querySelector("#idtipoconsecutivo");o.querySelector(`option[value="${e}"]`).textContent=t}(d.id,m.facturador[0].nombre)}else s=[...s,m.facturador],r.row.add([r.rows().count()+1,m.facturador.nombre,m.facturador.nombretipofacturador.nombre,m.facturador.rangoinicial,m.facturador.siguientevalor,m.facturador.fechafin,1==m.facturador.estado?"Activo":"Inactivo",`<div class="acciones-btns" id="${m.facturador.id}" data-facturador="${m.facturador.nombre}">\n                          <button class="btn-md btn-turquoise editarFacturador"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarFacturador"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1),function(e,t){const o=document.querySelector("#idtipoconsecutivo"),n=document.createElement("option");n.value=e,n.textContent=t,o.appendChild(n)}(m.facturador.id,m.facturador.nombre);else i.close(),document.removeEventListener("click",o),msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".mediosPagos")){const n=document.querySelector("#crearMedioPago"),a=document.querySelector("#miDialogoMedioPago");let i,r,d=0,c=0,l=[];function o(e){e.target!==a&&"Salir"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allmediospago",t=yield fetch(e);l=yield t.json()}catch(e){console.log(e)}})),i=$("#tablamediosPagos").DataTable(configdatatables),n.addEventListener("click",()=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateCaja"))||void 0===e||e.reset()}(),document.querySelector("#modalMedioPago").textContent="Crear medio de pago",document.querySelector("#btnEditarCrearMedioPago").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablamediosPagos"))||void 0===e||e.addEventListener("click",e=>{var t,n,s,u;const m=e.target;(null===(t=e.target)||void 0===t?void 0:t.classList.contains("statemediopago"))&&function(e){const t=e.target,o=i.page.info();d=i.row(t.closest("tr")).index(),(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t.id),e.append("estado","0"==t.dataset.state?"1":"0");try{const n="/admin/api/updateStateMedioPago",a=yield fetch(n,{method:"POST",body:e}),r=yield a.json();if(void 0!==r.exito){const e=`<button id="${t.id}" data-state="${"0"==t.dataset.state?"1":"0"}" class="statemediopago btn-xs ${"0"==t.dataset.state?"btn-lima":"btn-red"}">${"0"==t.dataset.state?"Activo":"Inactivo"}</button>`;i.cell(i.row(d+=o.start),2).data(e).draw(),i.page(o.page).draw("page")}else msjalertToast("error","¡Error!",r.error[0])}catch(e){console.log(e)}}))})()}(e),((null===(n=e.target)||void 0===n?void 0:n.classList.contains("editarMedioPago"))||(null===(s=e.target.parentElement)||void 0===s?void 0:s.classList.contains("editarMedioPago")))&&function(e){var t,n,s,u;let m=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(m=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);c=1,document.querySelector("#modalMedioPago").textContent="Actualizar medio de pago",document.querySelector("#btnEditarCrearMedioPago").value="Actualizar",r=l.find(e=>e.id==m),document.querySelector("#nombreMedioPago").value=null==r?void 0:r.mediopago,d=i.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==m?void 0:m.classList.contains("eliminarMedioPago"))||(null===(u=m.parentElement)||void 0===u?void 0:u.classList.contains("eliminarMedioPago")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);d=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el medio de pago?",text:"El medio de pago sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarMedioPago",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(i.row(d+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateMedioPago"))||void 0===t||t.addEventListener("submit",e=>{let t="crearMedioPago";c&&(t="actualizarMedioPago"),e.preventDefault();var n=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==r?void 0:r.id)?null==r?void 0:r.id:""),e.append("mediopago",$("#nombreMedioPago").val());try{const s="/admin/api/"+t,u=yield fetch(s,{method:"POST",body:e}),m=yield u.json();if(void 0!==m.exito)if(a.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),c){l.forEach(e=>{e.id==(null==r?void 0:r.id)&&(e=Object.assign(e,m.mediopago[0]))});const e=i.row(d+=n.start).data();e[1]=m.mediopago.mediopago,e[2]="1"==m.mediopago.estado?"Activo":"Inactivo",i.row(d).data(e).draw(),i.page(n.page).draw("page")}else l=[...l,m.mediopago],i.row.add([i.rows().count()+1,m.mediopago.mediopago,"1"==m.mediopago.estado?"Activo":"Inactivo",`<div class="acciones-btns" id="${m.mediopago.id}" data-mediopago="${m.mediopago.nombre}">\n                          <button class="btn-md btn-turquoise editarMedioPago"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarMedioPago"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".tarifas")){const n=document.querySelector("#crearTarifa"),a=document.querySelector("#miDialogoTarifa");let i,r,d=0,c=0,l=[];function o(e){e.target!==a&&"Salir"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/alltarifas",t=yield fetch(e);l=yield t.json()}catch(e){console.log(e)}})),i=$("#tablaTarifas").DataTable(configdatatables),n.addEventListener("click",()=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateTarifa"))||void 0===e||e.reset()}(),document.querySelector("#modalTarifa").textContent="Crear tarifa",document.querySelector("#btnEditarCrearTarifa").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaTarifas"))||void 0===e||e.addEventListener("click",e=>{var t,n,s;const u=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarTarifa"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarTarifa")))&&function(e){var t,n,s,u;let m=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(m=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);c=1,document.querySelector("#modalTarifa").textContent="Actualizar tarifa",document.querySelector("#btnEditarCrearTarifa").value="Actualizar",r=l.find(e=>e.id==m),document.querySelector("#nombreTarifa").value=null==r?void 0:r.nombre,document.querySelector("#valorTarifa").value=null==r?void 0:r.valor,d=i.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==u?void 0:u.classList.contains("eliminarTarifa"))||(null===(s=u.parentElement)||void 0===s?void 0:s.classList.contains("eliminarTarifa")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);d=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la tarifa?",text:"La tarifa sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarTarifa",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(i.row(d+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateTarifa"))||void 0===t||t.addEventListener("submit",e=>{let t="crearTarifa";c&&(t="actualizarTarifa"),e.preventDefault();var n=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==r?void 0:r.id)?null==r?void 0:r.id:""),e.append("nombre",$("#nombreTarifa").val()),e.append("valor",$("#valorTarifa").val());try{const s="/admin/api/"+t,u=yield fetch(s,{method:"POST",body:e}),m=yield u.json();if(void 0!==m.exito)if(a.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),c){l.forEach(e=>{e.id==(null==r?void 0:r.id)&&(e=Object.assign(e,m.tarifa[0]))});const e=i.row(d+=n.start).data();e[1]=m.tarifa[0].nombre,e[2]="$"+Number(m.tarifa[0].valor).toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}),i.row(d).data(e).draw(),i.page(n.page).draw("page")}else l=[...l,m.tarifa],i.row.add([i.rows().count()+1,m.tarifa.nombre,m.tarifa.valor,`<div class="acciones-btns" id="${m.tarifa.id}" data-tarifa="${m.tarifa.nombre}">\n                          <button class="btn-md btn-turquoise editarTarifa"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarTarifa"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};!function(){var e,t;if(document.querySelector(".reportes")){const n=document.querySelectorAll(".graficaventa"),a=null===(e=document.getElementById("chartventas"))||void 0===e?void 0:e.getContext("2d"),i=null===(t=document.getElementById("chartutilidad"))||void 0===t?void 0:t.getContext("2d");let r=null;function o(e){return __awaiter(this,void 0,void 0,(function*(){try{const t=yield fetch(e);!function(e){r&&r.destroy();r=new Chart(a,{type:"bar",data:{labels:e.label,datasets:[{label:"Total Ventas",data:e.datos,borderWidth:1}]},options:{scales:{y:{beginAtZero:!0,grid:{display:!1}},x:{grid:{display:!1}}},responsive:!0}})}(yield t.json())}catch(e){console.log(e)}}))}o("/admin/api/ventasGraficaMensual"),n.forEach((e,t)=>{e.addEventListener("click",e=>{let n="/admin/api/ventasGraficaMensual";1==t&&(n="/admin/api/ventasGraficaDiario"),o(n)})}),(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/graficaValorInventario",t=yield fetch(e),o=yield t.json();new Chart(i,{type:"doughnut",data:{labels:["Ventas total:","Costo:","Utilidad:"],datasets:[{label:"Total Ventas",data:[Number(o.valorventa),Number(o.costoinv),Number(o.valorventa)-Number(o.costoinv)],backgroundColor:["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 205, 86)"],hoverOffset:4}]},options:{responsive:!0,plugins:{legend:{labels:{generateLabels:e=>{const t=e.data.datasets[0].data;return e.data.labels.map((o,n)=>({text:`${o}: ${t[n]}`,fillStyle:e.data.datasets[0].backgroundColor[n],index:n}))}}}}}})}catch(e){console.log(e)}}))})()}}(),(()=>{if(document.querySelector(".paginadorventas")){const o=document.querySelectorAll(".filtrocategorias");if(document.querySelectorAll("#producto").length)var e=new List("hacker-list",{valueNames:["card-producto",{data:["categoria","code"]}],page:18,pagination:!0});o.forEach(t=>{t.addEventListener("click",t=>{const o=t.target.dataset.categoria;e&&e.filter(e=>"Todos"===o||e.values().categoria===o)})});const n=document.querySelector("#btnCarritoMovil"),a=document.getElementById("contenidocarrito"),i=document.getElementById("contenedorDesktop"),r=document.getElementById("miDialogoCarritoMovil"),d=document.querySelector("#btnCerrarCarritoMovil");function t(e){e.target===r&&(r.close(),document.removeEventListener("click",t))}window.innerWidth<992&&r.appendChild(a),window.addEventListener("resize",()=>{window.innerWidth>=992?(i.appendChild(a),r.close(),document.removeEventListener("click",t)):r.appendChild(a)}),null==n||n.addEventListener("click",e=>{r.showModal(),document.addEventListener("click",t)}),d.addEventListener("click",()=>{r.close(),document.removeEventListener("click",t)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(!document.querySelector(".ventas"))return;const e=window.POS;let t=[];const o=document.querySelector("#facturarA"),n=document.querySelector("#miDialogoFacturarA"),a=document.querySelector("#formFacturarA"),i=document.querySelector("#identification_number"),r=document.querySelector("#department_id"),d=document.querySelector("#municipality_id");let c=[],l=[];function s(e){(()=>{__awaiter(this,void 0,void 0,(function*(){try{const o="/admin/api/citiesXdepartments?id="+e,n=yield fetch(o),a=yield n.json();a.error?Swal.fire(a.error[0],"","error"):(t=a,function(e){for(;null==d?void 0:d.firstChild;)d.removeChild(null==d?void 0:d.firstChild);e.forEach(e=>{const t=document.createElement("option");t.textContent=e.name,t.value=e.id,t.dataset.code=e.code,t.dataset.department_id=e.department_id,d.appendChild(t)}),l.length>0&&l[0].municipality_id&&$("#municipality_id").val(l[0].municipality_id)}(t))}catch(e){console.log(e)}}))})()}__awaiter(void 0,void 0,void 0,(function*(){const e=yield fetch("/admin/api/filterAdquirientes"),t=yield e.json();c=t})),i.addEventListener("input",(function(e){const t=e.target.value;l=t.length>3&&/^\d+$/.test(t)?c.filter(e=>{if(e.identification_number.trim()===t.trim())return e}):[];l.length>0?($("#type_document_identification_id").val(l[0].type_document_identification_id),document.querySelector("#business_name").value=l[0].business_name,document.querySelector("#email").value=l[0].email,document.querySelector("#address").value=l[0].address,l[0].department_id&&($("#department_id").val(l[0].department_id),s(l[0].department_id)),$("#type_organization_id").val(l[0].type_organization_id),$("#type_regime_id").val(l[0].type_regime_id),document.querySelector("#phone").value=l[0].phone):($("#type_document_identification_id").val(""),document.querySelector("#business_name").value="",document.querySelector("#email").value="",document.querySelector("#address").value="",$("#department_id").val(""),$("#municipality_id").val(""),$("#type_organization_id").val(""),$("#type_regime_id").val(""),document.querySelector("#phone").value="")})),null==r||r.addEventListener("change",e=>{s(e.target.value)}),o.addEventListener("click",t=>{n.showModal(),document.addEventListener("click",e.cerrarDialogoExterno)}),a.addEventListener("submit",t=>{t.preventDefault();const o=new FormData(a),i=Object.fromEntries(o.entries());e.gestionarAdquiriente.datosAdquiriente=i,n.close(),document.removeEventListener("click",e.cerrarDialogoExterno),function(e){__awaiter(this,void 0,void 0,(function*(){try{const t="/admin/api/guardarAdquiriente",o=yield fetch(t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),n=yield o.json();"crear"==n.response?c=[...c,n.obj]:c.forEach(e=>{e.identification_number==n.obj.identification_number&&(e=Object.assign(e,n.obj))}),e.id=n.obj.id}catch(e){console.log(e)}}))}(i)});const u={miDialogoFacturarA:n,datosAdquiriente:{}};e.gestionarAdquiriente=u})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(!document.querySelector(".ventas"))return;const e={getProductosAPI(){return __awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/allproducts",t=yield fetch(e),o=yield t.json();return console.log(o),o}catch(e){console.log(e)}}))}};window.POS.productosAPI=e})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(!document.querySelector(".ventas"))return;const e=window.POS,t=document.querySelector("#addcliente"),o=document.querySelector("#adddir"),n=document.querySelector("#miDialogoAddCliente"),a=document.querySelector("#miDialogoAddDir"),i=document.querySelector("#selectCliente"),r=document.querySelector("#direccionEntrega"),d={selectCliente:i,dirEntrega:r,miDialogoAddCliente:n,miDialogoAddDir:a,clientes(){var d,c;function l(t){for(var o,n;null==r?void 0:r.firstChild;)r.removeChild(null==r?void 0:r.firstChild);const a=new Set;e.tarifas.length=0,console.log(t),t.forEach(t=>{const o=document.createElement("option");o.textContent=t.direccion,o.value=t.id,o.dataset.idcliente=t.idcliente,o.dataset.idtarifa=t.idtarifa,o.dataset.ciudad=t.ciudad,r.appendChild(o),t.tarifa.idcliente=t.idcliente,a.has(t.tarifa.id)||(e.tarifas=[...e.tarifas,t.tarifa],a.add(t.tarifa.id))}),a.clear(),e.printTarifaEnvio(),e.valorCarritoTotal(),document.querySelector("#ciudadEntrega").value=null!==(n=null===(o=t[0])||void 0===o?void 0:o.ciudad)&&void 0!==n?n:"No especificado"}null==t||t.addEventListener("click",t=>{n.showModal(),document.addEventListener("click",e.cerrarDialogoExterno)}),null==o||o.addEventListener("click",t=>{a.showModal(),document.addEventListener("click",e.cerrarDialogoExterno)}),null===(d=document.querySelector("#formAddCliente"))||void 0===d||d.addEventListener("submit",t=>{t.preventDefault(),(()=>{__awaiter(this,void 0,void 0,(function*(){const t=new FormData;t.append("nombre",document.querySelector("#nombreclientenuevo").value),t.append("apellido",document.querySelector("#clientenuevoapellido").value),t.append("tipodocumento",document.querySelector("#tipodocumento").value),t.append("identificacion",document.querySelector("#identificacion").value),t.append("telefono",document.querySelector("#telefono").value),t.append("email",document.querySelector("#clientenuevoemail").value),t.append("idtarifa",document.querySelector("#clientenuevotarifa").value),t.append("direccion",document.querySelector("#clientenuevodireccion").value),t.append("departamento",document.querySelector("#departamento").value),t.append("ciudad",document.querySelector("#ciudad").value);try{const o="/admin/api/apiCrearCliente",n=yield fetch(o,{method:"POST",body:t}),a=yield n.json();void 0!==a.exito?(msjalertToast("success","¡Éxito!",a.exito[0]),function(e){const t=document.createElement("option");t.textContent=document.querySelector("#nombreclientenuevo").value+" "+document.querySelector("#clientenuevoapellido").value,t.value=e,t.dataset.tipodocumento=document.querySelector("#tipodocumento").value,t.dataset.identidad=document.querySelector("#identificacion").value,null==i||i.appendChild(t),$("#selectCliente").val(e).trigger("change")}(a.nextID),e.limpiarformdialog()):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))})(),n.close(),document.removeEventListener("click",e.cerrarDialogoExterno)}),$("#selectCliente").on("change",e=>{const t=e.target.value;(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/direccionesXcliente?id="+t,o=yield fetch(e);l(yield o.json())}catch(e){console.log(e)}}))})();const o=e.target,n=o.options[o.selectedIndex].dataset.identidad||"";document.querySelector("#documento").value=n}),null==r||r.addEventListener("change",t=>{const o=t.target,n=o.options[o.selectedIndex].dataset.ciudad||"";document.querySelector("#ciudadEntrega").value=n,e.printTarifaEnvio(),e.valorCarritoTotal()}),null===(c=document.querySelector("#formAddDir"))||void 0===c||c.addEventListener("submit",t=>{t.preventDefault(),(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("idcliente",i.value),e.append("departamento",document.querySelector("#adddepartamento").value),e.append("ciudad",document.querySelector("#addciudad").value),e.append("direccion",document.querySelector("#adddireccion").value),e.append("idtarifa",document.querySelector("#tarifa").value);try{const t="/admin/api/addDireccionCliente",o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),l(n.direcciones)):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))})(),a.close(),document.removeEventListener("click",e.cerrarDialogoExterno)})}};window.POS.gestionClientes=d})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(!document.querySelector(".ventas"))return;const t=window.POS,o=document.querySelector("#btndescuento"),n=document.querySelector("#miDialogoDescuento"),a=document.querySelectorAll('input[name="tipodescuento"]'),i=document.querySelector("#inputDescuento"),r=document.querySelector("#inputDescuentoClave");let d,c=0;__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/getPasswords",t=yield fetch(e),o=yield t.json();d=o}catch(e){console.log(e)}})),null==o||o.addEventListener("click",()=>{t.carrito.length&&(c=t.valorTotal.subtotal,n.showModal(),document.addEventListener("click",t.cerrarDialogoExterno))}),a.forEach(e=>{e.addEventListener("change",e=>{"porcentaje"===e.target.value&&(c=100,i.value=""),"valor"===e.target.value&&(i.value="",c=t.valorTotal.subtotal)})}),null==i||i.addEventListener("input",e=>{var t=Number(e.target.value);t>c&&(i.value=c+"",t=c)}),null===(e=document.querySelector("#formDescuento"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault();const o=Number(i.value);a[0].checked&&(t.valorTotal.dctox100=Math.round(100*o/t.valorTotal.subtotal),t.valorTotal.descuento=o),a[1].checked&&(t.valorTotal.descuento=t.valorTotal.subtotal*o/100,t.valorTotal.dctox100=o);(function(){const e=d.find(e=>"clave_para_agregar_descuento"==e.clave);if(null!==(null==e?void 0:e.valor_final)&&r.value!==(null==e?void 0:e.valor_final))return msjAlert("error","El password es invalido",document.querySelector("#divmsjalertaClaveDcto")),0;return 1})()&&(t.valorTotal.total=t.valorTotal.subtotal-t.valorTotal.descuento+t.valorTotal.valortarifa,document.querySelector("#total").textContent="$ "+t.valorTotal.total.toLocaleString(),document.querySelector("#descuento").textContent="$"+t.valorTotal.descuento.toLocaleString(),n.close(),document.removeEventListener("click",t.cerrarDialogoExterno))});const l={miDialogoDescuento:n};t.gestionarDescuentos=l})(),(()=>{var e;if(!document.querySelector(".ventas"))return;const t=window.POS,o=document.querySelectorAll(".mediopago");o.forEach(e=>{e.addEventListener("input",e=>{!function(e){var n;let i=0;o.forEach((e,t)=>{t>0&&(i+=parseInt(e.value.replace(/[,.]/g,"")))}),i<=t.valorTotal.total?("Contado"==t.tipoventa&&(t.mapMediospago.set("1",t.valorTotal.total-i),t.valorTotal.total-i==0&&t.mapMediospago.has("1")&&t.mapMediospago.delete("1")),t.mapMediospago.set(e.target.id,parseInt(e.target.value.replace(/[,.]/g,""))),"0"==e.target.value&&t.mapMediospago.has(e.target.id)&&t.mapMediospago.delete(e.target.id)):t.mapMediospago.has(e.target.id)?e.target.value=t.mapMediospago.get(e.target.id).toLocaleString():e.target.value="0";"Contado"==t.tipoventa&&(o[0].value=(null!==(n=t.mapMediospago.get("1"))&&void 0!==n?n:0).toLocaleString());a(document.querySelector("#recibio").value)}(e)})}),null===(e=document.querySelector("#recibio"))||void 0===e||e.addEventListener("input",e=>{a(e.target.value)});const n={subirModalPagar(){document.querySelector("#totalPagar").textContent=""+t.valorTotal.total.toLocaleString();let e=0;o.forEach((t,o)=>{o>0&&(e+=parseInt(t.value.replace(/[,.]/g,"")))}),t.valorTotal.total<e&&(e=0,t.mapMediospago.clear(),$(".mediopago").val(0)),"Contado"==t.tipoventa&&(document.querySelector(".Efectivo").value=""+(t.valorTotal.total-e).toLocaleString(),t.mapMediospago.set("1",t.valorTotal.total-e)),t.valorTotal.total-e==0&&t.mapMediospago.has("1")&&t.mapMediospago.delete("1"),a(document.querySelector("#recibio").value)}};function a(e){e=e.replace(/[,.]/g,""),Number(e)>t.mapMediospago.get("1")?document.querySelector("#cambio").textContent=(Number(e)-t.mapMediospago.get("1")).toLocaleString()+"":document.querySelector("#cambio").textContent="0"}t.gestionSubirModalPagar=n})(),(()=>{if(!document.querySelector(".ventas"))return;const e=window.POS,t=document.querySelector("#btnotros"),o=document.querySelector("#miDialogoOtrosProductos");let n={id:0,nombre:"",cantidad:0,valorunidad:0,total:0};t.addEventListener("click",t=>{o.showModal(),document.addEventListener("click",e.cerrarDialogoExterno)});const a={miDialogoOtrosProductos:o,otrosproductos(){var t;null===(t=document.querySelector("#formOtrosProductos"))||void 0===t||t.addEventListener("submit",t=>{t.preventDefault();const a=t.target.elements,i=a.namedItem("porcentaje_de_impuesto").value,r=Number(a.namedItem("cantidadotros").value),d=Number(a.namedItem("preciootros").value);n.id+=-1,n.nombre=a.namedItem("nombreotros").value,n.cantidad=r,n.valorunidad=d/r,n.total=d,e.products.push({ID:n.id+"",id:n.id+"",idcategoria:"-1",idunidadmedida:"1",nombre:n.nombre,foto:"na",impuesto:""==i?null:i,marca:"na",tipoproducto:"-1",tipoproduccion:"-1",codigo:"-1",unidadmedida:"Unidad",descripcion:"na",peso:"na",medidas:"na",color:"na",funcion:"na",uso:"na",fabricante:"na",garantia:"na",stock:"0",stockminimo:"1",categoria:"na",rendimientoestandar:"1",precio_compra:"0",precio_venta:n.valorunidad+"",fecha_ingreso:"",estado:"1",visible:"1"}),e.actualizarCarrito(n.id+"",r,!1,!1,n.valorunidad+""),o.close(),document.removeEventListener("click",e.cerrarDialogoExterno)})}};window.POS.gestionOtrosProductos=a})(),(()=>{if(!document.querySelector(".ventas"))return;const e=window.POS,t=document.querySelector("#miDialogoPreciosAdicionales");document.querySelector("#aplicarprecioadicional").addEventListener("click",()=>{if(document.querySelector(".inputprecioadicional")){const t=document.querySelector(".inputprecioadicional:checked");e.actualizarCarrito(t.dataset.precio,1,!0,!0,t.value)}});const o={miDialogoPreciosAdicionales:t,abrirDialogo(o){t.showModal(),function(t){const o=document.querySelector("#listaPrecios"),n=e.products.find(e=>e.id==t);for(;o.firstChild;)o.removeChild(o.firstChild);null==n||n.preciosadicionales.forEach(e=>{const n=`<label class="flex justify-between items-center p-4 rounded-xl bg-indigo-50 dark:bg-indigo-950/30 border border-indigo-200 dark:border-indigo-800 cursor-pointer hover:bg-indigo-100 dark:hover:bg-indigo-900/40 transition">\n                          <div class="flex items-center gap-3">\n                              <input type="radio" class="w-5 h-5 text-indigo-600 focus:ring-indigo-500 inputprecioadicional" data-precio="${t}"  name="precioSeleccionado" value="${e.precio}">\n                              <span class="text-gray-900 dark:text-gray-100 text-lg font-medium">Precio adicional</span>\n                          </div>\n                          <span class="text-gray-800 dark:text-gray-200 text-lg font-semibold">${e.precio}</span>\n                      </label>`;o.insertAdjacentHTML("beforeend",n)})}(o.dataset.id),document.addEventListener("click",e.cerrarDialogoExterno)}};e.gestionarPreciosAdicionales=o})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(!document.querySelector(".ventas"))return;const e={sendInvoice(e){return __awaiter(this,void 0,void 0,(function*(){console.log(e);try{const t="/admin/api/sendInvoice",o=yield fetch(t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e})}),n=yield o.json();return console.log(n),n}catch(e){console.log(e)}}))}};window.POS.sendInvoiceAPI=e})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".ventas")){const c=window.POS,l=c.gestionClientes.selectCliente,s=c.gestionClientes.dirEntrega,u=(document.querySelectorAll("#producto"),document.querySelector("#productos")),m=document.querySelector("#btnEntrega"),p=document.querySelector("#modalidadEntrega"),v=document.querySelector("#totalunidades"),f=document.querySelector("#tablaventa tbody"),g=document.querySelector("#btnguardar"),y=document.querySelector("#btnfacturar"),h=document.querySelector("#btnaplicarcredito"),b=c.gestionClientes.miDialogoAddCliente,S=c.gestionClientes.miDialogoAddDir,w=c.gestionOtrosProductos.miDialogoOtrosProductos,x=c.gestionarPreciosAdicionales.miDialogoPreciosAdicionales,E=c.gestionarAdquiriente.miDialogoFacturarA,q=c.gestionarDescuentos.miDialogoDescuento,C=document.querySelector("#miDialogoCredito"),_=document.querySelector("#miDialogoGuardar"),L=document.querySelector("#miDialogoFacturar"),D=document.querySelector("#caja"),k=document.querySelector("#facturador");let j=[];const T={subtotal:0,base:0,valorimpuestototal:0,dctox100:0,descuento:0,idtarifa:0,valortarifa:0,total:0};let P=[],M="",N="Contado";const A={excluido:0,0:0,5:.0476190476190476,8:.0740740740740741,16:.1379310344827586,19:.1596638655462185};let I=[],F=[];const O=new Map;function t(e){var t;$("#facturador").val(null!==(t=e.options[e.selectedIndex].dataset.idfacturador)&&void 0!==t?t:"1")}function o(){P=c.tarifas;const e=s.options[s.selectedIndex];if(": Presencial"==p.textContent||-1==s.selectedIndex)return T.valortarifa=0,void(M="");if((null==e?void 0:e.dataset.idtarifa)&&": Domicilio"==p.textContent){const t=P.find(t=>{if(t.idcliente==e.dataset.idcliente&&t.id==e.dataset.idtarifa)return!0});T.valortarifa=Number(null==t?void 0:t.valor),T.idtarifa=Number(null==t?void 0:t.id),M=null==t?void 0:t.nombre}}function n(e,t){const o=j.find(o=>o.idproducto==e&&o.valorunidad==t),n=document.createElement("TR");n.classList.add("productselect"),n.dataset.id=""+e,n.dataset.precio=t,n.insertAdjacentHTML("afterbegin",`<td class="!px-0 !py-2 text-xl text-gray-500 leading-5">${null==o?void 0:o.nombreproducto}</td> \n\n      <td class="!px-0 !py-2">\n        <div class="flex items-center gap-2 px-4">\n          <button type="button" class="w-8 h-8 bg-indigo-700 text-white rounded-full flex items-center justify-center">\n            <span class="menos material-symbols-outlined text-base">remove</span>\n          </button>\n\n          <input type="text" class="inputcantidad w-20 px-2 text-center" value="${o.cantidad}">\n\n          <button type="button" class="w-8 h-8 bg-indigo-700 text-white rounded-full flex items-center justify-center">\n            <span class="mas material-symbols-outlined text-base">add</span>\n          </button>\n        </div>\n      </td>\n\n      <td class="!p-2 text-xl text-gray-500 leading-5">$${Number(null==o?void 0:o.valorunidad).toLocaleString()}</td>\n      <td class="!p-2 text-xl text-gray-500 leading-5">$${Number(null==o?void 0:o.total).toLocaleString()}</td>\n      <td class="accionestd"><div class="acciones-btns"><button class="btn-md btn-red eliminarProducto"><i class="fa-solid fa-trash-can"></i></button></div></td>`),null==f||f.appendChild(n)}function a(e,t,o,a,r="0"){var d,l,s,u;const m=j.findIndex(t=>t.idproducto==e&&t.valorunidad==r);if(m>-1)t<=0&&(t=0,j[m].total=0),o?j[m].cantidad+=t:j[m].cantidad=t,j[m].subtotal=parseInt(j[m].valorunidad)*j[m].cantidad,j[m].total=j[m].subtotal,j[m].valorimp=parseFloat((j[m].total*A[null!==(d=j[m].impuesto)&&void 0!==d?d:0]).toFixed(3)),j[m].base=parseFloat((j[m].total-j[m].valorimp).toFixed(3)),i(),a&&((null==f?void 0:f.querySelector(`TR[data-id="${e}"][data-precio="${r}"] .inputcantidad`)).value=j[m].cantidad+""),(null===(s=null===(l=null==f?void 0:f.querySelector(`TR[data-id="${e}"][data-precio="${r}"]`))||void 0===l?void 0:l.children)||void 0===s?void 0:s[3]).textContent="$"+j[m].total.toLocaleString();else{const o=F.find(t=>t.id==e),a=Number(r)*t*A[null!==(u=o.impuesto)&&void 0!==u?u:"0"],d=Number(r)*t;var p={id:"",idproducto:null==o?void 0:o.id,tipoproducto:o.tipoproducto,tipoproduccion:o.tipoproduccion,idcategoria:o.idcategoria,nombreproducto:o.nombre,rendimientoestandar:o.rendimientoestandar,foto:o.foto,costo:o.precio_compra,valorunidad:r,cantidad:t,subtotal:d,base:d-a,impuesto:o.impuesto,valorimp:a,descuento:0,total:d};j=[...j,p],i(),n(e,r),c.carrito=j}}function i(){const e={0:1,5:2,16:3,19:4,excluido:5,8:6},t={0:0,5:0,16:0,19:0,excluido:0,8:0},o=new Map;j.forEach(n=>{var a;if(n.impuesto)if(o.has(n.impuesto)){const e=o.get(n.impuesto)+n.total*A[n.impuesto];o.set(n.impuesto,e)}else o.set(n.impuesto,n.total*A[n.impuesto]);null==n.impuesto&&(n.impuesto="excluido"),t[n.impuesto]+=n.base;const i=null!==(a=o.get(n.impuesto))&&void 0!==a?a:0,r=I.findIndex(t=>t.id_impuesto==e[n.impuesto]);-1!=r?I[r]={id_impuesto:e[n.impuesto],facturaid:0,basegravable:t[n.impuesto],valorimpuesto:i}:I=[...I,{id_impuesto:e[n.impuesto],facturaid:0,basegravable:t[n.impuesto],valorimpuesto:i}]});let n=0;for(let e of o.values())n+=e;T.valorimpuestototal=parseFloat(n.toFixed(3)),T.subtotal=j.reduce((e,t)=>t.total+e,0),T.base=T.subtotal-T.valorimpuestototal,T.total=T.subtotal+T.valortarifa-T.descuento,document.querySelector("#subTotal").textContent="$"+T.subtotal.toLocaleString(),document.querySelector("#impuesto").textContent="$"+n.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}),document.querySelector("#valorTarifa").textContent="$"+T.valortarifa.toLocaleString(),document.querySelector("#total").textContent="$ "+T.total.toLocaleString(),v.textContent=j.reduce((e,t)=>t.cantidad+e,0)+""}function r(e){const t=e.target;(t===q||t===C||t===_||t===L||t===b||t===w||t===E||t===S||t===x||t.closest(".salir")||t.closest(".novaciar")||t.closest(".sivaciar")||t.closest(".noguardar")||t.closest(".siguardar")||"Cancelar"==t.value||t.classList.contains("btnCerrarPreciosAdicionales"))&&(q.close(),_.close(),L.close(),b.close(),S.close(),E.close(),w.close(),x.close(),document.removeEventListener("click",r),t.closest(".siguardar")&&(N="",d("Guardado","1")))}function d(e,t){return __awaiter(this,void 0,void 0,(function*(){var o,n,a;const i=document.querySelector('input[name="imprimir"]:checked'),d=new FormData;d.append("id",null!==(o=null==Y?void 0:Y.id)&&void 0!==o?o:""),d.append("idcliente",document.querySelector("#selectCliente").value),d.append("idvendedor",document.querySelector("#vendedor").dataset.idvendedor),d.append("idcaja",D.value),d.append("idconsecutivo",k.value),d.append("iddireccion",s.value),d.append("idtarifazona",T.idtarifa+""),d.append("cliente","1"==l.value?"N/A":l.options[l.selectedIndex].textContent),d.append("vendedor",document.querySelector("#vendedor").value),d.append("caja",document.querySelector("#caja option:checked").textContent),d.append("tipofacturador",k.options[k.selectedIndex].textContent),d.append("direccion",null!==(a=null===(n=s.options[s.selectedIndex])||void 0===n?void 0:n.text)&&void 0!==a?a:""),d.append("tarifazona",M||""),d.append("carrito",JSON.stringify(j.filter(e=>e.cantidad>0))),d.append("totalunidades",v.textContent),d.append("mediosPago",JSON.stringify(Array.from(O,([e,t])=>({idmediopago:e,id_factura:0,valor:t})))),d.append("factimpuestos",JSON.stringify(I)),d.append("recibido",document.querySelector("#recibio").value),d.append("transaccion",""),d.append("tipoventa",N),d.append("cotizacion",t),d.append("estado",e),d.append("subtotal",T.subtotal+""),d.append("base",T.base.toFixed(3)),d.append("valorimpuestototal",T.valorimpuestototal+""),d.append("dctox100",T.dctox100+""),d.append("descuento",T.descuento+""),d.append("total",T.total.toString()),d.append("observacion",document.querySelector("#observacion").value),d.append("departamento",""),d.append("ciudad",document.querySelector("#ciudadEntrega").value),d.append("entrega",p.textContent.replace(": ","")),d.append("valortarifa",T.valortarifa+""),d.append("datosAdquiriente",JSON.stringify(c.gestionarAdquiriente.datosAdquiriente)),d.append("opc1",""),d.append("opc2","");try{const e="/admin/api/facturar",t=yield fetch(e,{method:"POST",body:d}),o=yield t.json();if(void 0!==o.exito){if(msjalertToast("success","¡Éxito!",o.exito[0]),function(){for((null==Y?void 0:Y.id)&&(Y.id=""),O.clear(),$(".mediopago").val(0),j.length=0,I.length=0,history.replaceState({},"","/admin/ventas");null==f?void 0:f.firstChild;)f.removeChild(null==f?void 0:f.firstChild);document.querySelector("#npedido").value="",document.querySelector("#subTotal").textContent="$0",document.querySelector("#descuento").textContent="$0",document.querySelector("#total").textContent="$0",$("#selectCliente").val(1).trigger("change");for(const e in T)T[e]=0}(),o.idfactura&&"1"===i.value&&(u=o.idfactura,setTimeout(()=>{window.open("/admin/printPDFPOS?id="+u,"_blank")},1200)),"1"==k.options[k.selectedIndex].dataset.idtipofacturador){const e=yield c.sendInvoiceAPI.sendInvoice(o.idfactura);console.log(e)}}else msjalertToast("error","¡Error!",o.error[0])}catch(e){console.log(e)}var u;L.close(),document.getElementById("miDialogoCarritoMovil").close(),document.removeEventListener("click",r)}))}__awaiter(void 0,void 0,void 0,(function*(){F=yield c.productosAPI.getProductosAPI(),c.products=F,c.gestionOtrosProductos.otrosproductos()})),$("#selectCliente").select2(),t(D),D.addEventListener("change",e=>t(e.target)),c.gestionClientes.clientes(),null==m||m.addEventListener("click",e=>{": Presencial"==p.textContent?p.textContent=": Domicilio":p.textContent=": Presencial",o(),i()}),null==u||u.addEventListener("click",e=>{var t,o,n,i;const r=null===(t=e.target)||void 0===t?void 0:t.closest(".producto"),d=j.find(e=>e.idproducto==r.dataset.id);if("precioadicional"===(null===(o=e.target.parentElement)||void 0===o?void 0:o.id))return void c.gestionarPreciosAdicionales.abrirDialogo(r);if(window.innerWidth<992){const e=document.createElement("div");e.className="popup absolute z-40 right-8 top-1/3 opacity-0 translate-x-0 translate-y-0 transition-all duration-500 w-10 h-10 rounded-full text-center grid place-items-center bg-teal-400 text-white font-semibold text-lg",e.innerHTML=""+((null!==(n=null==d?void 0:d.cantidad)&&void 0!==n?n:0)+1),r.appendChild(e),requestAnimationFrame(()=>{e.classList.remove("opacity-0","translate-y-0","translate-x-0"),e.classList.add("opacity-100","-translate-y-14","translate-x-10")});const t=document.querySelectorAll(".popup");setTimeout(()=>{t.forEach(e=>{e.remove()})},2500)}const l=null===(i=F.find(e=>e.id==r.dataset.id))||void 0===i?void 0:i.precio_venta;r&&a(r.dataset.id,1,!0,!0,l)}),null==f||f.addEventListener("click",e=>{var t,o,n;const r=null===(t=e.target)||void 0===t?void 0:t.closest(".productselect"),d=r.dataset.id,c=r.dataset.precio,l=j.find(e=>e.idproducto==d&&e.valorunidad==c);e.target.classList.contains("menos")&&a(d,l.cantidad-1,!1,!0,null==l?void 0:l.valorunidad),e.target.classList.contains("inputcantidad")&&"eventInput"!=e.target.dataset.event&&(null===(o=e.target)||void 0===o||o.addEventListener("input",e=>{let t=e.target.value;t=t.replace(/[^0-9.]/g,"");const o=t.split(".");o.length>2&&(t=o[0]+"."+o.slice(1).join("")),t.startsWith(".")&&(t="1"),(""===t||isNaN(parseFloat(t)))&&(t="0"),e.target.value=t,a(d,Number(e.target.value),!1,!1,null==l?void 0:l.valorunidad)}),e.target.dataset.event="eventInput"),e.target.classList.contains("mas")&&a(d,l.cantidad+1,!1,!0,null==l?void 0:l.valorunidad),(e.target.classList.contains("eliminarProducto")||"I"==e.target.tagName)&&(j=j.filter(e=>e.idproducto!=d||e.valorunidad!=c),i(),null===(n=null==f?void 0:f.querySelector(`TR[data-id="${d}"][data-precio="${c}"]`))||void 0===n||n.remove())}),null==g||g.addEventListener("click",()=>{j.length&&(_.showModal(),document.addEventListener("click",r))}),null==h||h.addEventListener("click",()=>{var e,t,o;(": Domicilio"!==p.textContent||"1"!=l.value&&s.value)&&"1"!=l.value?j.length&&(null===(e=document.querySelector(".Efectivo"))||void 0===e||e.removeAttribute("readonly"),null===(t=document.querySelector("#inputscreditos"))||void 0===t||t.classList.add("flex"),null===(o=document.querySelector("#inputscreditos"))||void 0===o||o.classList.remove("hidden"),"Contado"==N&&(O.clear(),$(".mediopago").val(0)),N="Credito",c.gestionSubirModalPagar.subirModalPagar(),L.showModal(),document.addEventListener("click",r)):msjAlert("error","Cliente o direccion no seleccionado",document.querySelector("#divmsjalerta1"))}),null==y||y.addEventListener("click",()=>{var e,t,o;": Domicilio"!==p.textContent||"1"!=l.value&&s.value?j.length&&(null===(e=document.querySelector(".Efectivo"))||void 0===e||e.setAttribute("readonly","true"),null===(t=document.querySelector("#inputscreditos"))||void 0===t||t.classList.add("hidden"),null===(o=document.querySelector("#inputscreditos"))||void 0===o||o.classList.remove("flex"),N="Contado",c.gestionSubirModalPagar.subirModalPagar(),L.showModal(),document.addEventListener("click",r)):msjAlert("error","Cliente o direccion no seleccionado",document.querySelector("#divmsjalerta1"))}),null===(e=document.querySelector("#formfacturar"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault(),T.total<=0||T.subtotal<=0?msjAlert("error","No se puede procesar pago con $0",document.querySelector("#divmsjalerta2")):d("Paga","0")});const B=new URLSearchParams(window.location.search).get("id");let Y;B&&__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/getcotizacion_venta?id="+B,t=yield fetch(e),o=yield t.json();Y=o.factura,j=o.productos,j.forEach(e=>n(e.idproducto,e.valorunidad)),i(),document.querySelector("#npedido").value=Y.num_orden,$("#selectCliente").val(Y.idcliente).trigger("change")}catch(e){console.log(e)}})),c.limpiarformdialog=function(){var e;null===(e=document.querySelector("#formAddCliente"))||void 0===e||e.reset()},c.printTarifaEnvio=o,c.valorCarritoTotal=i,c.actualizarCarrito=a,c.cerrarDialogoExterno=r,c.tarifas=P,c.valorTotal=T,c.mapMediospago=O,c.tipoventa=N}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".editartrasladoinv")){const t=document.querySelector("#btnAddItem"),o=document.querySelector("#tablaItems tbody"),n=document.querySelector("#btnUpdateTrasladoInv");let a,i=[];__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/totalitems",t=yield fetch(e),o=yield t.json();a=o.map(e=>{var t;return{id:e.id,text:e.nombre,tipo:null!==(t=e.tipoproducto)&&void 0!==t?t:"1",sku:e.sku,unidadmedida:e.unidadmedida}}),function(e){$("#articulo").select2({width:"100%",data:e,placeholder:"Selecciona un item",maximumSelectionLength:1})}(a)}catch(e){console.log(e)}}));const r=new URLSearchParams(window.location.search).get("id");function e(e,t,n,a,i){const r=document.createElement("TR");r.classList.add("itemselect"),r.dataset.id=""+e,r.dataset.tipo=""+t,r.insertAdjacentHTML("afterbegin",`<td class="p-4">${i}</td>\n                <td class="p-4">${a}</td>\n                <td class="p-4 flex items-center justify-center gap-2">\n                    <button class="flex items-center gap-1 px-3 py-1 text-base text-indigo-600 border border-indigo-200 rounded-lg hover:bg-indigo-50">\n                        👁 Ver\n                    </button>\n                    <button class="w-11 h-11 flex items-center justify-center text-green-600 border border-green-200 rounded-full hover:bg-green-50 text-xl">✅</button>\n                    <button class="eliminarItem w-11 h-11 flex items-center justify-center text-rose-600 border border-rose-200 rounded-full hover:bg-rose-50 text-xl">❌</button>\n                </td>`),null==o||o.appendChild(r)}null!=r&&/^\d+$/.test(r)&&Number(r)>=1&&__awaiter(void 0,void 0,void 0,(function*(){try{const t="/admin/api/idOrdenTrasladoSolicitudInv?id="+r,o=yield fetch(t),n=yield o.json(),a=n.orden[0].detalletrasladoinv;i=a.map(e=>{const t=e.fkproducto&&!e.idsubproducto_id;return{id:e.id,id_trasladoinv:e.id_trasladoinv,fkproducto:e.fkproducto,idsubproducto_id:e.idsubproducto_id,iditem:t?e.fkproducto:e.idsubproducto_id,nombreitem:e.nombre,tipo:t?"0":"1",unidadmedida:"",cantidad:e.cantidad,factor:1}}),i.forEach(t=>e(t.iditem,t.tipo,t.unidadmedida,t.cantidad,t.nombreitem))}catch(e){console.log(e)}})),$("#articulo").on("change",e=>{let t=$("#articulo").select2("data")[0];t&&(document.querySelector("#unidadmedida").value=t.unidadmedida)}),t.addEventListener("click",t=>{let o=parseFloat(document.querySelector("#cantidad").value),n=$("#articulo").select2("data")[0];if(console.log(n),n){const t=i.findIndex(e=>e.iditem==n.id&&e.tipo==n.tipo);if(-1==t){const t=a.find(e=>e.id==n.id&&e.tipo==n.tipo),d={id:"",id_trasladoinv:r,fkproducto:"0"==t.tipo?t.id:"NULL",idsubproducto_id:"1"==t.tipo?t.id:"NULL",iditem:null==t?void 0:t.id,nombreitem:t.text,tipo:t.tipo,unidadmedida:t.unidadmedida,cantidad:o,factor:1};i=[...i,d],e(t.id,t.tipo,t.unidadmedida,o,t.text)}else{i[t].cantidad=o;document.querySelector(`[data-id="${i[t].iditem}"][data-tipo="${i[t].tipo}"]`).children[1].textContent=i[t].cantidad+""}}}),null==o||o.addEventListener("click",e=>{var t,n;const a=null===(t=e.target)||void 0===t?void 0:t.closest(".itemselect"),r=a.dataset.id,d=a.dataset.tipo;e.target.classList.contains("eliminarItem")&&(i=i.filter(e=>e.iditem!=r||e.tipo!=d),null===(n=null==o?void 0:o.querySelector(`TR[data-id="${r}"][data-tipo="${d}"]`))||void 0===n||n.remove())}),n.addEventListener("click",()=>{Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Esta seguro de actualizar la orden de transferencia?",text:"Se procesara la orden con todos los productos para la sede destino",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id_trasladoinv",r),e.append("ids",JSON.stringify(i.map(e=>e.id))),e.append("nuevosproductos",JSON.stringify(i));try{const t="/admin/api/editarOrdenTransferencia",o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();void 0!==n.exito?(setTimeout(()=>{window.location.href="/admin/almacen/trasladarinventario"},1600),Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".nuevotrasladoinv")){const t=document.getElementById("btnAnteriorTrasladoInv"),o=document.getElementById("btnSiguienteTrasladoInv"),n=document.querySelectorAll(".step-circle"),a=document.querySelectorAll(".step-section"),i=document.querySelector("#btnAddItem"),r=document.querySelector("#tablaItems tbody"),d=document.querySelector("#resumenSedeDestino"),c=document.querySelector("#resumenFecha"),l=document.querySelector("#resumenObservaciones");let s,u=[],m=1;const p=3;__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/totalitems",t=yield fetch(e),o=yield t.json();s=o.map(e=>{var t;return{id:e.id,text:e.nombre,tipo:null!==(t=e.tipoproducto)&&void 0!==t?t:"1",sku:e.sku,unidadmedida:e.unidadmedida}}),function(e){$("#articulo").select2({width:"100%",data:e,placeholder:"Selecciona un item",maximumSelectionLength:1})}(s)}catch(e){console.log(e)}}));const v=document.getElementById("fecha"),f=new Date,g=f.getFullYear(),y=String(f.getMonth()+1).padStart(2,"0"),h=String(f.getDate()).padStart(2,"0");function e(){n.forEach((e,t)=>{const o=t+1;e.className=o<m?"step-circle w-10 h-10 rounded-full bg-green-500 text-white font-semibold flex items-center justify-center":o===m?"step-circle w-10 h-10 rounded-full bg-indigo-600 text-white font-semibold flex items-center justify-center":"step-circle w-10 h-10 rounded-full border-2 border-gray-300 text-gray-400 font-semibold flex items-center justify-center"}),a.forEach((e,t)=>{e.style.display=t+1===m?"block":"none"}),t.disabled=1===m}v.value=`${g}-${y}-${h}`,e(),o.addEventListener("click",()=>{if(m<p){if(m++,3===m&&0===u.length)return void m--;3===m&&u.length>0&&function(){const e=document.querySelector("#tablaproductosresumen tbody");for(;null==e?void 0:e.firstChild;)e.removeChild(e.firstChild);d.textContent=document.querySelector("#sucursaldestino").textContent,c.textContent=v.value,l.textContent=document.querySelector("#observaciones").value,u.forEach(t=>{const o=document.createElement("tr"),n=document.createElement("td");n.textContent=t.nombreitem,null==o||o.appendChild(n);const a=document.createElement("td");a.textContent=t.cantidad+"",null==o||o.appendChild(a);const i=document.createElement("td");i.textContent=t.unidad,null==o||o.appendChild(i),null==e||e.appendChild(o)})}(),e()}else!function(){Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Esta seguro de generar orden de transferencia?",text:"Se procesara la orden con todos los productos en la sede destino",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{if(e.isConfirmed){const e=document.querySelector("#sucursalorigen"),t=document.querySelector("#sucursaldestino");(()=>{__awaiter(this,void 0,void 0,(function*(){const o=new FormData;o.append("idsucursalorigen",e.value),o.append("idsucursaldestino",t.value),o.append("productos",JSON.stringify(u));try{const e="/admin/api/apinuevotrasladoinv",t=yield fetch(e,{method:"POST",body:o}),n=yield t.json();void 0!==n.exito?(setTimeout(()=>{window.location.href="/admin/almacen/trasladarinventario"},1100),Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()}})}()}),t.addEventListener("click",()=>{m>1&&(m--,e())}),$("#articulo").on("change",e=>{let t=$("#articulo").select2("data")[0];t&&(document.querySelector("#unidadmedida").value=t.unidadmedida)}),i.addEventListener("click",e=>{let t=parseFloat(document.querySelector("#cantidad").value),o=$("#articulo").select2("data")[0];if(console.log(o),o){const e=u.findIndex(e=>e.iditem==o.id&&e.tipo==o.tipo);if(-1==e){const e=s.find(e=>e.id==o.id&&e.tipo==o.tipo),n={iditem:null==e?void 0:e.id,idpx:"0"==e.tipo?e.id:"NULL",idsx:"1"==e.tipo?e.id:"NULL",tipo:e.tipo,nombreitem:e.text,unidad:e.unidadmedida,cantidad:t,factor:1,impuesto:0,valorunidad:0,subtotal:0,precio_compra:0,valorcompra:0};u=[...u,n],function(e,t,o,n){const a=s.find(o=>o.id==e&&o.tipo==t),i=document.createElement("TR");i.classList.add("itemselect"),i.dataset.id=""+e,i.dataset.tipo=""+t,i.insertAdjacentHTML("afterbegin",`<td class="p-4">${null==a?void 0:a.text}</td>\n                <td class="p-4">${n}</td>\n                <td class="p-4 flex items-center justify-center gap-2">\n                    <button class="flex items-center gap-1 px-3 py-1 text-base text-indigo-600 border border-indigo-200 rounded-lg hover:bg-indigo-50">\n                        👁 Ver\n                    </button>\n                    <button class="w-11 h-11 flex items-center justify-center text-green-600 border border-green-200 rounded-full hover:bg-green-50 text-xl">✅</button>\n                    <button class="eliminarItem w-11 h-11 flex items-center justify-center text-rose-600 border border-rose-200 rounded-full hover:bg-rose-50 text-xl">❌</button>\n                </td>`),null==r||r.appendChild(i)}(o.id,o.tipo,o.unidadmedida,t)}else{u[e].cantidad=t;document.querySelector(`[data-id="${u[e].iditem}"][data-tipo="${u[e].tipo}"]`).children[1].textContent=u[e].cantidad+""}}}),null==r||r.addEventListener("click",e=>{var t,o;const n=null===(t=e.target)||void 0===t?void 0:t.closest(".itemselect"),a=n.dataset.id,i=n.dataset.tipo;u.find(e=>e.iditem==a&&e.tipo==i);e.target.classList.contains("eliminarItem")&&(u=u.filter(e=>e.iditem!=a||e.tipo!=i),null===(o=null==r?void 0:r.querySelector(`TR[data-id="${a}"][data-tipo="${i}"]`))||void 0===o||o.remove())})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".solicitarinvnetario")){const t=document.getElementById("btnAnteriorSolicitudInv"),o=document.getElementById("btnSiguienteSolicitudInv"),n=document.querySelectorAll(".step-circle"),a=document.querySelectorAll(".step-section"),i=document.querySelector("#btnAddItem"),r=document.querySelector("#tablaItems tbody"),d=document.querySelector("#resumenSedeDestino"),c=document.querySelector("#resumenFecha"),l=document.querySelector("#resumenObservaciones");let s,u=[],m=1;const p=3;__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/totalitems",t=yield fetch(e),o=yield t.json();s=o.map(e=>{var t;return{id:e.id,text:e.nombre,tipo:null!==(t=e.tipoproducto)&&void 0!==t?t:"1",sku:e.sku,unidadmedida:e.unidadmedida}}),function(e){$("#articulo").select2({width:"100%",data:e,placeholder:"Selecciona un item",maximumSelectionLength:1})}(s)}catch(e){console.log(e)}}));const v=document.getElementById("fecha"),f=new Date,g=f.getFullYear(),y=String(f.getMonth()+1).padStart(2,"0"),h=String(f.getDate()).padStart(2,"0");function e(){n.forEach((e,t)=>{const o=t+1;e.className=o<m?"step-circle w-10 h-10 rounded-full bg-green-500 text-white font-semibold flex items-center justify-center":o===m?"step-circle w-10 h-10 rounded-full bg-indigo-600 text-white font-semibold flex items-center justify-center":"step-circle w-10 h-10 rounded-full border-2 border-gray-300 text-gray-400 font-semibold flex items-center justify-center"}),a.forEach((e,t)=>{e.style.display=t+1===m?"block":"none"}),t.disabled=1===m}v.value=`${g}-${y}-${h}`,e(),o.addEventListener("click",()=>{if(m<p){if(m++,3===m&&0===u.length)return void m--;3===m&&u.length>0&&function(){const e=document.querySelector("#tablaproductosresumen tbody");for(;null==e?void 0:e.firstChild;)e.removeChild(e.firstChild);d.textContent=document.querySelector("#sucursaldestino").textContent,c.textContent=v.value,l.textContent=document.querySelector("#observaciones").value,u.forEach(t=>{const o=document.createElement("tr"),n=document.createElement("td");n.textContent=t.nombreitem,null==o||o.appendChild(n);const a=document.createElement("td");a.textContent=t.cantidad+"",null==o||o.appendChild(a);const i=document.createElement("td");i.textContent=t.unidad,null==o||o.appendChild(i),null==e||e.appendChild(o)})}(),e()}else!function(){Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Esta seguro de generar orden de solicitud?",text:"Se procesara la orden con todos los productos en la sede destino",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{if(e.isConfirmed){const e=document.querySelector("#sucursalorigen"),t=document.querySelector("#sucursaldestino");(()=>{__awaiter(this,void 0,void 0,(function*(){const o=new FormData;o.append("idsucursalorigen",e.value),o.append("idsucursaldestino",t.value),o.append("productos",JSON.stringify(u));try{const e="/admin/api/apisolicitarinventario",t=yield fetch(e,{method:"POST",body:o}),n=yield t.json();void 0!==n.exito?(setTimeout(()=>{window.location.href="/admin/almacen/solicitudesrecibidas"},600),Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()}})}()}),t.addEventListener("click",()=>{m>1&&(m--,e())}),$("#articulo").on("change",e=>{let t=$("#articulo").select2("data")[0];t&&(document.querySelector("#unidadmedida").value=t.unidadmedida)}),i.addEventListener("click",e=>{let t=parseFloat(document.querySelector("#cantidad").value),o=$("#articulo").select2("data")[0];if(console.log(o),o){const e=u.findIndex(e=>e.iditem==o.id&&e.tipo==o.tipo);if(-1==e){const e=s.find(e=>e.id==o.id&&e.tipo==o.tipo),n={iditem:null==e?void 0:e.id,idpx:"0"==e.tipo?e.id:"NULL",idsx:"1"==e.tipo?e.id:"NULL",tipo:e.tipo,nombreitem:e.text,unidad:e.unidadmedida,cantidad:t,factor:1,impuesto:0,valorunidad:0,subtotal:0,precio_compra:0,valorcompra:0};u=[...u,n],function(e,t,o,n){const a=s.find(o=>o.id==e&&o.tipo==t),i=document.createElement("TR");i.classList.add("itemselect"),i.dataset.id=""+e,i.dataset.tipo=""+t,i.insertAdjacentHTML("afterbegin",`<td class="p-4">${null==a?void 0:a.text}</td>\n                <td class="p-4">${n}</td>\n                <td class="p-4 flex items-center justify-center gap-2">\n                    <button class="flex items-center gap-1 px-3 py-1 text-base text-indigo-600 border border-indigo-200 rounded-lg hover:bg-indigo-50">\n                        👁 Ver\n                    </button>\n                    <button class="w-11 h-11 flex items-center justify-center text-green-600 border border-green-200 rounded-full hover:bg-green-50 text-xl">✅</button>\n                    <button class="eliminarItem w-11 h-11 flex items-center justify-center text-rose-600 border border-rose-200 rounded-full hover:bg-rose-50 text-xl">❌</button>\n                </td>`),null==r||r.appendChild(i)}(o.id,o.tipo,o.unidadmedida,t)}else{u[e].cantidad=t;document.querySelector(`[data-id="${u[e].iditem}"][data-tipo="${u[e].tipo}"]`).children[1].textContent=u[e].cantidad+""}}}),null==r||r.addEventListener("click",e=>{var t,o;const n=null===(t=e.target)||void 0===t?void 0:t.closest(".itemselect"),a=n.dataset.id,i=n.dataset.tipo;u.find(e=>e.iditem==a&&e.tipo==i);e.target.classList.contains("eliminarItem")&&(u=u.filter(e=>e.iditem!=a||e.tipo!=i),null===(o=null==r?void 0:r.querySelector(`TR[data-id="${a}"][data-tipo="${i}"]`))||void 0===o||o.remove())})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".solicitudesrecibidas")){const n=document.querySelector("#miDialogoDetalleTrasladoSolicitud"),a=document.querySelector("#btnXCerrarDetalleTrasladoSolicitud"),i=document.querySelector("#numOrden"),r=document.querySelector("#sedeorigen"),d=document.querySelector("#sededestino"),c=document.querySelector("#tipo"),l=document.querySelector("#observaciones"),s=document.querySelector("#tabladetalleorden tbody"),u=document.getElementById("filtroSucursal"),m=document.getElementById("filtroEstados"),p=document.querySelectorAll("#tablaTraslados tbody tr");const v=document.querySelector(".divmsjalerta0");function t(){const e=u.value.trim().toLowerCase(),t=m.value.trim().toLowerCase();p.forEach(o=>{const n=o.cells[1].textContent.trim().toLowerCase(),a=o.cells[5].textContent.trim().toLowerCase(),i=!e||n===e,r=!t||a===t;o.style.display=i&&r?"":"none"})}function o(e){var t;const i=e.target,r=null===(t=i.parentElement)||void 0===t?void 0:t.id;i!==n&&"salir"!==i.value&&"btnXCerrarDetalleTrasladoSolicitud"!=r&&i!=a||(n.close(),document.removeEventListener("click",o))}v&&borrarMsjAlert(v),null===(e=document.querySelector("#tablaTraslados"))||void 0===e||e.addEventListener("click",e=>{var t,a,u;const m=e.target;((null==m?void 0:m.classList.contains("enviar"))||(null===(t=m.parentElement)||void 0===t?void 0:t.classList.contains("enviar")))&&function(e){var t,o,n,a;let i=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(o=e.target)||void 0===o?void 0:o.tagName)&&(i=null===(a=null===(n=e.target.parentElement)||void 0===n?void 0:n.parentElement)||void 0===a?void 0:a.id);let r="",d="",c="",l="";const s=e.target.closest("tr");"Ingreso"===s.children[4].textContent&&(r="Desea confirmar la recepcion de mercancia?",d="La marcancia ingresara al inventario de la sucursal y no se podra modificar.",c="confirmaringresoinv",l="entregada");"Solicitud"===s.children[4].textContent&&(r="Desea confirmar el envio de mercancia?",d="La orden entrara en estado: 'EN TRANSITO' y sera aceptada o rechazda por la sede de destino.",c="confirmarnuevotrasladoinv",l="entransito");Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:r,text:d,showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",i);try{const t="/admin/api/"+c,o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();void 0!==n.exito?(s.children[5].innerHTML=`<span class="px-3 py-1 text-base font-semibold rounded-full ${"entregada"==l?"bg-sky-50 text-sky-600":"entransito"==l?"bg-yellow-100 text-yellow-700":"bg-rose-50 text-rose-600"}">${l}</span>`,Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e),((null==m?void 0:m.classList.contains("detalle"))||(null===(a=m.parentElement)||void 0===a?void 0:a.classList.contains("detalle")))&&function(e){var t,a,u,m;let p=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(a=e.target)||void 0===a?void 0:a.tagName)&&(p=null===(m=null===(u=e.target.parentElement)||void 0===u?void 0:u.parentElement)||void 0===m?void 0:m.id);(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/idOrdenTrasladoSolicitudInv?id="+p,t=yield fetch(e);!function(e){i.textContent=e.id,r.textContent=e.sucursal_origen,d.textContent=e.sucursal_destino,c.textContent=e.tipo,l.textContent=e.observacion;for(;s.firstChild;)s.removeChild(s.firstChild);e.detalletrasladoinv.forEach(e=>{const t=document.createElement("tr"),o=document.createElement("td");o.classList.add("px-4","py-2","border"),o.textContent=e.nombre;const n=document.createElement("td");n.classList.add("px-4","py-2","border"),n.textContent=e.cantidad;const a=document.createElement("td");a.classList.add("px-4","py-2","border"),a.textContent=e.unidadmedida,t.appendChild(o),t.appendChild(n),t.appendChild(a),s.appendChild(t)})}((yield t.json()).orden[0])}catch(e){console.log(e)}}))})(),n.showModal(),document.addEventListener("click",o)}(e),((null==m?void 0:m.classList.contains("cancelar"))||(null===(u=m.parentElement)||void 0===u?void 0:u.classList.contains("cancelar")))&&function(e){var t,o,n,a;let i=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(o=e.target)||void 0===o?void 0:o.tagName)&&(i=null===(a=null===(n=e.target.parentElement)||void 0===n?void 0:n.parentElement)||void 0===a?void 0:a.id);const r=e.target.closest("tr");Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea anular la orden de envio de mercancia?",text:"La orden y sus productos seran cancelados por completo y no se enviara.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",i);try{const t="/admin/api/anularnuevotrasladoinv",o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();void 0!==n.exito?(r.remove(),Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),u.addEventListener("change",t),m.addEventListener("change",t)}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".trasladoinventario")){const n=document.querySelector("#miDialogoDetalleTrasladoSolicitud"),a=document.querySelector("#btnXCerrarDetalleTrasladoSolicitud"),i=document.querySelector("#numOrden"),r=document.querySelector("#sedeorigen"),d=document.querySelector("#sededestino"),c=document.querySelector("#tipo"),l=document.querySelector("#observaciones"),s=document.querySelector("#tabladetalleorden tbody"),u=document.getElementById("filtroSucursal"),m=document.getElementById("filtroEstados"),p=document.querySelectorAll("#tablaTraslados tbody tr");const v=document.querySelector(".divmsjalerta0");function t(){const e=u.value.trim().toLowerCase(),t=m.value.trim().toLowerCase();p.forEach(o=>{const n=o.cells[1].textContent.trim().toLowerCase(),a=o.cells[5].textContent.trim().toLowerCase(),i=!e||n===e,r=!t||a===t;o.style.display=i&&r?"":"none"})}function o(e){var t;const i=e.target,r=null===(t=i.parentElement)||void 0===t?void 0:t.id;i!==n&&"salir"!==i.value&&"btnXCerrarDetalleTrasladoSolicitud"!=r&&i!=a||(n.close(),document.removeEventListener("click",o))}v&&borrarMsjAlert(v),null===(e=document.querySelector("#tablaTraslados"))||void 0===e||e.addEventListener("click",e=>{var t,a,u;const m=e.target;((null==m?void 0:m.classList.contains("enviar"))||(null===(t=m.parentElement)||void 0===t?void 0:t.classList.contains("enviar")))&&function(e){var t,o,n,a;let i=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(o=e.target)||void 0===o?void 0:o.tagName)&&(i=null===(a=null===(n=e.target.parentElement)||void 0===n?void 0:n.parentElement)||void 0===a?void 0:a.id);let r="",d="",c="",l="";const s=e.target.closest("tr");console.log(s.children[4].textContent),"Solicitud"===s.children[4].textContent&&(r="Desea confirmar la recepcion de la mercancia solicitada?",d="La marcancia ingresara al inventario de la sucursal y no se podra modificar.",c="confirmaringresoinv",l="entregada");"Salida"===s.children[4].textContent&&(r="Desea confirmar el envio de mercancia?",d="La orden entrara en estado: 'EN TRANSITO' y sera aceptada o rechazda por la sede de destino.",c="confirmarnuevotrasladoinv",l="entransito");Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:r,text:d,showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",i);try{const t="/admin/api/"+c,o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();void 0!==n.exito?(s.children[5].innerHTML=`<span class="px-3 py-1 text-base font-semibold rounded-full ${"entregada"==l?"bg-sky-50 text-sky-600":"entransito"==l?"bg-yellow-100 text-yellow-700":"bg-rose-50 text-rose-600"}">${l}</span>`,Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e),((null==m?void 0:m.classList.contains("detalle"))||(null===(a=m.parentElement)||void 0===a?void 0:a.classList.contains("detalle")))&&function(e){var t,a,u,m;let p=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(a=e.target)||void 0===a?void 0:a.tagName)&&(p=null===(m=null===(u=e.target.parentElement)||void 0===u?void 0:u.parentElement)||void 0===m?void 0:m.id);(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/idOrdenTrasladoSolicitudInv?id="+p,t=yield fetch(e);!function(e){i.textContent=e.id,r.textContent=e.sucursal_origen,d.textContent=e.sucursal_destino,c.textContent=e.tipo,l.textContent=e.observacion;for(;s.firstChild;)s.removeChild(s.firstChild);e.detalletrasladoinv.forEach(e=>{const t=document.createElement("tr"),o=document.createElement("td");o.classList.add("px-4","py-2","border"),o.textContent=e.nombre;const n=document.createElement("td");n.classList.add("px-4","py-2","border"),n.textContent=e.cantidad;const a=document.createElement("td");a.classList.add("px-4","py-2","border"),a.textContent=e.unidadmedida,t.appendChild(o),t.appendChild(n),t.appendChild(a),s.appendChild(t)})}((yield t.json()).orden[0])}catch(e){console.log(e)}}))})(),n.showModal(),document.addEventListener("click",o)}(e),((null==m?void 0:m.classList.contains("cancelar"))||(null===(u=m.parentElement)||void 0===u?void 0:u.classList.contains("cancelar")))&&function(e){var t,o,n,a;let i=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(o=e.target)||void 0===o?void 0:o.tagName)&&(i=null===(a=null===(n=e.target.parentElement)||void 0===n?void 0:n.parentElement)||void 0===a?void 0:a.id);const r=e.target.closest("tr");Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea anular la orden de envio de mercancia?",text:"La orden y sus productos seran cancelados por completo y no se enviara.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",i);try{const t="/admin/api/anularnuevotrasladoinv",o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();void 0!==n.exito?(r.remove(),Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),u.addEventListener("change",t),m.addEventListener("change",t)}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};!function(){if(document.querySelector(".contenedorsetup")){const e=document.querySelectorAll('.contenedorsetup input[type="radio"]'),t=document.querySelectorAll(".keyinput"),o=document.querySelector("#porcentaje_de_impuesto");e.forEach(e=>{e.addEventListener("change",()=>{const t=e.name,o=document.querySelector(`input[name="${t}"]:checked`);console.log(`${t}, Opción seleccionada: ${o.value}`),function(e,t){const o=new FormData;o.append(e,t),(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/parametrosSistema",t=yield fetch(e,{method:"POST",body:o}),n=yield t.json();void 0!==n.exito?msjalertToast("success","¡Éxito!",n.exito[0]):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))})()}(t,o.value)})}),t.forEach(e=>{e.addEventListener("input",e=>{const t=e.target,o=e.target.value;(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append(t.name,o);try{const o="/admin/api/parametrosSistemaClaves",n=yield fetch(o,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(t.style.color="#02db02",t.style.fontWeight="500"):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))})()})}),null==o||o.addEventListener("input",e=>{console.log(e.target.value),(()=>{__awaiter(this,void 0,void 0,(function*(){const t=new FormData;t.append("porcentaje_de_impuesto",e.target.value);try{const e="/admin/api/parametrosSistemaPorcentajeImpuesto",o=yield fetch(e,{method:"POST",body:t}),n=yield o.json();void 0!==n.exito?msjalertToast("success","¡Éxito!",n.exito[0]):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))})()})}}();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(!document.querySelector(".gestionDian"))return;window.POS;const e=document.querySelector("#department_id"),t=document.querySelector("#municipality_id");let o=[];null==e||e.addEventListener("change",e=>{!function(e){(()=>{__awaiter(this,void 0,void 0,(function*(){try{const n="/admin/api/citiesXdepartments?id="+e,a=yield fetch(n),i=yield a.json();i.error?Swal.fire(i.error[0],"","error"):(o=i,function(e){for(;null==t?void 0:t.firstChild;)t.removeChild(null==t?void 0:t.firstChild);e.forEach(e=>{const o=document.createElement("option");o.textContent=e.name,o.value=e.id,o.dataset.code=e.code,o.dataset.department_id=e.department_id,t.appendChild(o)})}(o))}catch(e){console.log(e)}}))})()}(e.target.value)})})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(!document.querySelector(".gestionDian"))return;const t=window.POS,o=document.querySelector("#selectResolucioncompañia"),n=document.querySelector("#miDialogoGetResolucion");null===(e=document.querySelector("#formGetResolucion"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault();const a=o.options[o.selectedIndex].value,i=t.companiesAll.find(e=>e.id==a);!function(e,o,a){__awaiter(this,void 0,void 0,(function*(){try{const i="https://apidianj2.com/api/ubl2.1/numbering-range",r=yield fetch(i,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a},body:JSON.stringify({IDSoftware:o})}),d=(yield r.json()).ResponseDian.Envelope.Body.GetNumberingRangeResponse.GetNumberingRangeResult.ResponseList.NumberRangeResponse;d&&d.length>0&&function(e,o,a){const i=document.querySelector("#tablaListResolutions tbody");for(;i.firstChild;)i.removeChild(i.firstChild);o.forEach(t=>{i.insertAdjacentHTML("beforeend",`<tr>\n              <td class="px-4 py-2 border">${t.Prefix}</td>\n              <td class="px-3 py-2 border">${t.ResolutionNumber}</td>\n              <td class="px-3 py-2 border">${t.FromNumber} - ${t.ToNumber}</td>\n              <td class="px-3 py-2 border">${t.ValidDateTo}</td>\n              <td class="px-4 py-2 border text-2xl"><button class="downResolution" type="button" id="${t.ResolutionNumber}" data-company="${e}">⏬</button></td>\n          </tr>`)}),i.addEventListener("click",e=>function(e,o,a){return __awaiter(this,void 0,void 0,(function*(){const i=e.target;if(i.classList.contains("downResolution")){const e=i.dataset.idcompany,r=i.id,d=o.find(e=>e.ResolutionNumber===r);d.idcompany=e,document.querySelector(".content-spinner1").style.display="grid";try{const e="/admin/api/guardarResolutionJ2",o=yield fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(d)}),n=yield o.json(),i={type_document_id:"1",prefix:d.Prefix,resolution:d.ResolutionNumber,resolution_date:d.ResolutionDate,technical_key:"string"==typeof d.TechnicalKey?d.TechnicalKey:"",from:d.FromNumber,to:d.ToNumber,generated_to_date:"0",date_from:d.ValidDateFrom,date_to:d.ValidDateTo},r=yield t.crearResolucion(i,a);if(document.querySelector(".content-spinner1").style.display="none",console.log(r),r&&msjalertToast("success","¡Éxito!","Resoluccion asociada exitosamnete."),null!=n.exito){if(-1===t.facturadores.findIndex(e=>e.id==n.facturador.id&&e.resolucion==(null==d?void 0:d.ResolutionNumber))){t.facturadores.push(n.facturador);const e=$("#tablaFacturadores").DataTable(configdatatables);e.row.add([e.rows().count()+1,n.facturador.nombre,"ELECTRONICA",(null==d?void 0:d.FromNumber)+" - "+(null==d?void 0:d.ToNumber),1,null==d?void 0:d.ValidDateTo,"Activo",`<div class="acciones-btns" id="${n.facturador.id}" data-facturador="${n.facturador.nombre}">\n                            <button class="btn-md btn-turquoise editarFacturador"><i class="fa-solid fa-pen-to-square"></i></button>\n                            <button class="btn-md btn-red eliminarFacturador"><i class="fa-solid fa-trash-can"></i></button>\n                        </div>`]).draw(!1),function(e,t){const o=document.querySelector("#idtipoconsecutivo"),n=document.createElement("option");n.value=e,n.textContent=t,o.appendChild(n)}(n.facturador.id,n.facturador.nombre)}}}catch(e){console.log(e)}n.close(),document.removeEventListener("click",t.cerrarDialogoExterno)}}))}(e,o,a))}(e,d,a)}catch(e){console.log(e)}}))}(i.id,i.idsoftware,i.token)});const a={miDialogoGetResolucion:n,"selectResolucioncompañia":o};t.gestionarGetResolutions=a})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(!document.querySelector(".gestionDian"))return;const t=window.POS,o=document.querySelector("#miDialogosetpruebas"),n=document.querySelector("#selectSetCompañia");null===(e=document.querySelector("#formSetPruebas"))||void 0===e||e.addEventListener("submit",e=>__awaiter(void 0,void 0,void 0,(function*(){var a;e.preventDefault();const i=null===(a=n.options[n.selectedIndex])||void 0===a?void 0:a.value,r=document.querySelector("#idsetpruebas"),d=t.companiesAll.find(e=>e.id==i).token,c=(new Date).toISOString().split("T")[0],l={prefix:"SETP",number:9925e5+(Math.floor(5e5*Math.random())+1),type_document_id:"1",date:c,time:"00:00:01",resolution_number:"18760000001",sendmail:!1,notes:"Factura Electrónica de pruebas Auto",payment_form:{payment_form_id:"1",payment_method_id:"10",payment_due_date:c,duration_measure:"0"},customer:{identification_number:"222222222222",name:"Consumidor Final",phone:null,address:null,type_document_identification_id:3,type_organization_id:1,municipality_id:null},invoice_lines:[{unit_measure_id:"70",invoiced_quantity:"1.00",line_extension_amount:"2000.00",free_of_charge_indicator:!1,tax_totals:[{tax_id:1,tax_amount:"0.00",taxable_amount:"2000.00",percent:"0"}],description:"Producto Prueba",code:"155",type_item_identification_id:"4",price_amount:"2000.00",base_quantity:"1"}],legal_monetary_totals:{line_extension_amount:"2000",tax_exclusive_amount:"2000",tax_inclusive_amount:"2000",allowance_total_amount:"0",charge_total_amount:"0",payable_amount:"2000"},tax_totals:[{tax_id:1,tax_amount:"0.00",percent:"0",taxable_amount:"2000.00"}]};try{const e="https://apidianj2.com/api/ubl2.1/invoice/"+r.value,n=yield fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+d},body:JSON.stringify(l)}),a=yield n.json();return o.close(),document.removeEventListener("click",t.cerrarDialogoExterno),a.success}catch(e){return console.log(e),!1}})));const a={miDialogosetpruebas:o,"selectSetCompañia":n};t.gestionarSetPruebas=a})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gestionDian")){const r=window.POS,d=document.querySelector("#btnAdquirirCompañia"),c=document.querySelector("#btnCrearCompañia"),l=document.querySelector("#btnObtenerresolucion"),s=document.querySelector("#BtnSetpruebas"),u=document.querySelector("#formCrearUpdateCompañia"),m=document.querySelector("#miDialogoAdquirirCompañia"),p=document.querySelector("#miDialogoCompañia"),v=r.gestionarGetResolutions.miDialogoGetResolucion,f=r.gestionarSetPruebas.miDialogosetpruebas,g=r.gestionarGetResolutions.selectResolucioncompañia,y=r.gestionarSetPruebas.selectSetCompañia;let h;function o(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const o="https://apidianj2.com/api/ubl2.1/config/resolution",n=yield fetch(o,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify(e)});return(yield n.json()).success}catch(e){return console.log(e),!1}}))}function n(e,t,o){Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la compañia?",text:"La compañia sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(n=>{n.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){var n;try{const a="https://apidianj2.com/api/ubl2.1/config/deleteCompany",i=yield fetch(a,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o},body:JSON.stringify({identification_number:t})}),r=yield i.json();if(r.message){const o="/admin/api/eliminarCompanyLocal?id="+t,a=yield fetch(o);yield a.json();null===(n=document.querySelector("#company"+t))||void 0===n||n.remove(),msjalertToast("success","¡Éxito!",r.message),function(e){var t,o;null===(t=g.querySelector(`option[value=${e}]`))||void 0===t||t.remove(),null===(o=y.querySelector(`option[value=${e}]`))||void 0===o||o.remove()}(e)}else msjalertToast("error","¡Error!","Error intentalo nuevamente")}catch(e){return console.log(e),!1}}))})()})}function a(e){e.target!==m&&e.target!==p&&e.target!==f&&e.target!==v&&"Salir"!==e.target.value&&"Cancelar"!==e.target.value||(m.close(),p.close(),v.close(),f.close(),document.removeEventListener("click",a))}function i(){var e;null===(e=document.querySelector("#formCrearUpdateCompañia"))||void 0===e||e.reset()}__awaiter(void 0,void 0,void 0,(function*(){h=yield function(){return __awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/getCompaniesAll",t=yield fetch(e);return yield t.json()}catch(e){return console.log(e),[]}}))}(),r.companiesAll=h})),d.addEventListener("click",()=>{m.showModal(),document.addEventListener("click",a)}),c.addEventListener("click",()=>{i(),document.querySelector("#modalCompañia").textContent="Crear compañia",document.querySelector("#btnEditarCrearCompañia").value="Crear",p.showModal(),document.addEventListener("click",a)}),l.addEventListener("click",()=>{i(),v.showModal(),document.addEventListener("click",a)}),s.addEventListener("click",()=>__awaiter(void 0,void 0,void 0,(function*(){i(),f.showModal(),document.addEventListener("click",a)}))),null===(e=document.querySelector("#formAdquirirCompañia"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault()}),u.addEventListener("submit",e=>__awaiter(void 0,void 0,void 0,(function*(){e.preventDefault();const t=new FormData(u),i=t.get("certificate"),r=Object.fromEntries(t.entries());r.merchant_registration="0000000-00";const d=r.identification_number;var c;if(/^\d+$/.test(d)){if(i&&i.size>0){if(!i.name.toLocaleLowerCase().endsWith(".p12"))return void alert("Por favor seleccione un archivo formato .p12 valido");try{const e=yield(c=i,new Promise((e,t)=>{const o=new FileReader;o.onload=()=>{const t=o.result.split(",")[1];e(t)},o.onerror=()=>t(new Error("Error al leer el archivo")),o.readAsDataURL(c)}));r.certificadop12base64=e,function(e){__awaiter(this,void 0,void 0,(function*(){const{identification_number:t,certificadop12base64:i,password:r,idsoftware:d,pinsoftware:c}=e,l=function(e){const t=[3,7,13,17,19,23,29,37,41,43,47,53,59,67,71],o=e.toString().trim().split("").map(Number);let n=0;o.forEach((e,a)=>{const i=o.length-a;n+=e*t[i-1]});const a=n%11;return a>1?11-a:a}(Number(t));try{const s=`https://apidianj2.com/api/ubl2.1/config/${t}/${l}`,u=yield fetch(s,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),m=yield u.json();if(m.success){p.close(),document.removeEventListener("click",a);const l=yield function(e,t,o){return __awaiter(this,void 0,void 0,(function*(){try{const n="https://apidianj2.com/api/ubl2.1/config/certificate",a=yield fetch(n,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify({certificate:t,password:o})});return(yield a.json()).success}catch(e){return console.log(e),!1}}))}(m.token,i+"",r+""),s=yield function(e,t,o){return __awaiter(this,void 0,void 0,(function*(){try{const n="https://apidianj2.com/api/ubl2.1/config/software",a=yield fetch(n,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify({id:t,pin:o})});return(yield a.json()).success}catch(e){return console.log(e),!1}}))}(m.token,d+"",c+""),u={type_document_id:"1",prefix:"SETP",resolution:"18760000001",resolution_date:"2019-01-19",technical_key:"fc8eac422eba16e22ffd8c6f94b3f40a6e38162c",from:"990000000",to:"995000000",generated_to_date:"0",date_from:"2019-01-19",date_to:"2030-01-19"},v=yield o(u,m.token),f=e.business_name.match(/[a-zA-Z]/g),b=f[0],S={type_document_id:"4",prefix:"NC"+b+f[f.length-1],from:"1",to:"99999999"},w=yield o(S,m.token);l&&s&&v&&w?function(e,t){__awaiter(this,void 0,void 0,(function*(){e.token=t;try{const o="/admin/api/crearCompanyJ2",n=yield fetch(o,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),a=yield n.json();if(void 0!==a.exito){const o=document.querySelector("#tablaCompañias tbody");null==o||o.insertAdjacentHTML("beforeend",`\n                <tr class="" id="company${e.identification_number}">\n                  <td class="">${a.id}</td>\n                  <td class="">${e.business_name}</td> \n                  <td class="">${e.identification_number}</td>\n                  <td class="">${e.idsoftware}</td>\n                  <td class=""><div class="acciones-btns">  <button id="${a.id}"><span class="material-symbols-outlined eliminarcompañia">delete</span></button> </div></td>\n                </tr>`),msjalertToast("success","¡Éxito!",a.exito[0]),function(e,t,o){g.insertAdjacentHTML("afterbegin",`<option data-token="" value="${e}" >${o}</option>`),y.insertAdjacentHTML("afterbegin",`<option data-token="${t}" value="${e}" >${o}</option>`)}(a.id,t,e.business_name+""),h.push({id:a.id,identification_number:e.identification_number+"",business_name:e.business_name+"",idsoftware:e.idsoftware+"",token:t})}else msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))}(e,m.token):n("",t+"",m.token)}}catch(e){console.log(e)}}))}(r)}catch(e){return void alert("Error durante el procesamiento del certificado .p12")}}}else alert("Numero del Nit no es valido")}))),null===(t=document.querySelector("#tablaCompañias tbody"))||void 0===t||t.addEventListener("click",e=>{var t;const o=e.target;if(null==o?void 0:o.classList.contains("eliminarcompañia")){const e=null===(t=o.parentElement)||void 0===t?void 0:t.id,a=h.find(t=>t.id==e);n(e,null==a?void 0:a.identification_number,a.token)}}),r.cerrarDialogoExterno=a,r.crearResolucion=o}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".facturaselectronicas")){const n=document.querySelector("#consultarFechaPersonalizada"),a=document.querySelector("#btnmesactual"),i=document.querySelector("#btnmesanterior"),r=document.querySelector("#btnhoy"),d=document.querySelector("#btnayer");let c,l="",s="",u=[];function e(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function t(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const n=new FormData;n.append("fechainicio",e),n.append("fechafin",t);try{const e="/admin/api/facturaselectronicas",t=yield fetch(e,{method:"POST",body:n}),a=yield t.json();u=a,o(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function o(){c=$("#tablaFacturasElectronicas").DataTable({responsive:!0,destroy:!0,data:u,columns:[{title:"Orden",data:"orden"},{title:"Prefijo",data:"prefijo"},{title:"Numero",data:"numero"},{title:"Abrir",data:null,orderable:!1,searchable:!1,render:(e,t,o)=>`<a class="btn-ver btn-xs btn-light" target="_blank" href="/admin/reportes/detalleInvoice?id=${o.id}" data-id="${o.id}">Abrir</a>`},{title:"Abrir Dian",data:null,orderable:!1,searchable:!1,render:(e,t,o)=>`<button class="btn-ver btn-xs btn-lima" data-id="${o.id}">Abrir Dian</button>`},{title:"Identificacion",data:"identificacion"},{title:"Nombre",data:"nombre"},{title:"Tipo venta",data:"tipoventa"},{title:"Base",data:"base",render:e=>"$"+Number(e).toLocaleString()},{title:"Valor imp",data:"valorimpuestototal",render:e=>"$"+Number(e).toLocaleString()},{title:"Total",data:"total",render:e=>"$"+Number(e).toLocaleString()},{title:"Fecha",data:"created_at"}],pageLength:25,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"facturas procesadas"},{extend:"csvHtml5",title:"facturas procesadas"},{extend:"pdfHtml5",title:"facturas procesadas"},{extend:"print",title:"facturas procesadas",text:"Imprimir"},"colvis"],pageLength:"pageLength"}}})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");l=o,s=n})),a.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth(),1),a=new Date(o.getFullYear(),o.getMonth()+1,0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),i.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth()-1,1),a=new Date(o.getFullYear(),o.getMonth(),0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);t(e(a),e(i))}),d.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);t(e(i),e(r))}),n.addEventListener("click",()=>{""!=l&&""!=s?t(l,s):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),o()}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".electronicaspendientes")){const n=document.querySelector("#consultarFechaPersonalizada"),a=document.querySelector("#btnmesactual"),i=document.querySelector("#btnmesanterior"),r=document.querySelector("#btnhoy"),d=document.querySelector("#btnayer");let c,l="",s="",u=[];function e(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function t(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const n=new FormData;n.append("fechainicio",e),n.append("fechafin",t);try{const e="/admin/api/electronicaspendientes",t=yield fetch(e,{method:"POST",body:n}),a=yield t.json();u=a,o(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function o(){c=$("#tablaelectronicasPendientes").DataTable({responsive:!0,destroy:!0,data:u,columns:[{title:"Orden",data:"orden"},{title:"Prefijo",data:"prefijo"},{title:"Numero",data:"numero"},{title:"Abrir",data:null,orderable:!1,searchable:!1,render:(e,t,o)=>`<a class="btn-ver btn-xs btn-light" target="_blank" href="/admin/reportes/detalleInvoice?id=${o.id}" data-id="${o.id}">Abrir</a>`},{title:"Identificacion",data:"identificacion"},{title:"Nombre",data:"nombre"},{title:"Tipo venta",data:"tipoventa"},{title:"Base",data:"base",render:e=>"$"+Number(e).toLocaleString()},{title:"Valor imp",data:"valorimpuestototal",render:e=>"$"+Number(e).toLocaleString()},{title:"Total",data:"total",render:e=>"$"+Number(e).toLocaleString()},{title:"Fecha",data:"created_at"}],pageLength:25,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"facturas procesadas"},{extend:"csvHtml5",title:"facturas procesadas"},{extend:"pdfHtml5",title:"facturas procesadas"},{extend:"print",title:"facturas procesadas",text:"Imprimir"},"colvis"],pageLength:"pageLength"}}})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");l=o,s=n})),a.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth(),1),a=new Date(o.getFullYear(),o.getMonth()+1,0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),i.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth()-1,1),a=new Date(o.getFullYear(),o.getMonth(),0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);t(e(a),e(i))}),d.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);t(e(i),e(r))}),n.addEventListener("click",()=>{""!=l&&""!=s?t(l,s):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),o()}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".facturasprocesadas")){const n=document.querySelector("#consultarFechaPersonalizada"),a=document.querySelector("#btnmesactual"),i=document.querySelector("#btnmesanterior"),r=document.querySelector("#btnhoy"),d=document.querySelector("#btnayer");let c,l="",s="",u=[];function e(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function t(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const n=new FormData;n.append("fechainicio",e),n.append("fechafin",t);try{const e="/admin/api/facturaspagas",t=yield fetch(e,{method:"POST",body:n}),a=yield t.json();u=a,o(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function o(){c=$("#tablaFacturasProcesadas").DataTable({responsive:!0,destroy:!0,data:u,columns:[{title:"Orden",data:"num_orden"},{title:"N° Factura",data:"num_consecutivo"},{title:"Tipo",data:"tipofacturador"},{title:"Cant vendida",data:"totalunidades"},{title:"B. gravable",data:"base",render:e=>"$"+Number(e).toLocaleString()},{title:"Imp",data:"valorimpuestototal"},{title:"Descuento",data:"descuento"},{title:"Total",data:"total",render:e=>"$"+Number(e).toLocaleString()},{title:"Vendedor",data:"vendedor"},{title:"Caja",data:"caja"}],pageLength:25,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"facturas procesadas"},{extend:"csvHtml5",title:"facturas procesadas"},{extend:"pdfHtml5",title:"facturas procesadas"},{extend:"print",title:"facturas procesadas",text:"Imprimir"},"colvis"],pageLength:"pageLength"}}})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");l=o,s=n})),a.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth(),1),a=new Date(o.getFullYear(),o.getMonth()+1,0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),i.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth()-1,1),a=new Date(o.getFullYear(),o.getMonth(),0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);t(e(a),e(i))}),d.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);t(e(i),e(r))}),n.addEventListener("click",()=>{""!=l&&""!=s?t(l,s):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),o()}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".facturasanuladas")){const n=document.querySelector("#consultarFechaPersonalizada"),a=document.querySelector("#btnmesactual"),i=document.querySelector("#btnmesanterior"),r=document.querySelector("#btnhoy"),d=document.querySelector("#btnayer");let c,l="",s="",u=[];function e(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function t(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const n=new FormData;n.append("fechainicio",e),n.append("fechafin",t);try{const e="/admin/api/facturasanuladas",t=yield fetch(e,{method:"POST",body:n}),a=yield t.json();u=a,o(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function o(){c=$("#tablaFacturasAnuladas").DataTable({responsive:!0,destroy:!0,data:u,columns:[{title:"Orden",data:"num_orden"},{title:"N° Factura",data:"num_consecutivo"},{title:"Tipo",data:"tipofacturador"},{title:"Cant vendida",data:"totalunidades"},{title:"B. gravable",data:"base",render:e=>"$"+Number(e).toLocaleString()},{title:"Imp",data:"valorimpuestototal"},{title:"Descuento",data:"descuento"},{title:"Total",data:"total",render:e=>"$"+Number(e).toLocaleString()},{title:"Vendedor",data:"vendedor"},{title:"Caja",data:"caja"}],pageLength:25,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"facturas procesadas"},{extend:"csvHtml5",title:"facturas procesadas"},{extend:"pdfHtml5",title:"facturas procesadas"},{extend:"print",title:"facturas procesadas",text:"Imprimir"},"colvis"],pageLength:"pageLength"}}})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");l=o,s=n})),a.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth(),1),a=new Date(o.getFullYear(),o.getMonth()+1,0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),i.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth()-1,1),a=new Date(o.getFullYear(),o.getMonth(),0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);t(e(a),e(i))}),d.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);t(e(i),e(r))}),n.addEventListener("click",()=>{""!=l&&""!=s?t(l,s):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),o()}})(),(()=>{var e;if(document.querySelector(".detallecompra")){const t=document.querySelector("#btnPrintCompra"),o=null!==(e=new URLSearchParams(window.location.search).get("id"))&&void 0!==e?e:"";t.addEventListener("click",()=>{if(""!=o||!isNaN(Number(o))){const e=window.open("/printDetalleCompra?id="+o,"_blank");e&&(e.onload=()=>{null==e||e.focus(),null==e||e.print(),setTimeout(()=>{null==e||e.close()},200)})}})}})(),(()=>{if(document.querySelector(".inventarioxproducto")){let e;e=$("#tablaStockRapido").DataTable(configdatatablesstockrapido)}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".movimientosinventarios")){const t=document.querySelector("#consultarFechaPersonalizada");let o,n="",a="",i=[];const r=mesyañoactual();let d;function e(){o=$("#tablaMovimientosInventarios").DataTable({responsive:!0,pageLength:25,destroy:!0,data:i,order:[[8,"desc"]],columns:[{title:"id",data:"id"},{title:"Usuario",data:"usuario"},{title:"Producto",data:"nombre"},{title:"Unidad",data:"unidadmedida"},{title:"tipo",data:null,orderable:!1,searchable:!1,render:(e,t,o)=>`<button class="btn-xs ${"venta"==o.tipo?"btn-lima":"compra"==o.tipo?"btn-blue":"ajuste"==o.tipo?"btn-turquoise":"descuento de unidades"==o.tipo||"descuento por produccion"==o.tipo?"btn-bluelight":"salida por traslado"==o.tipo?"btn-yellow":"devolucion"==o.tipo?"btn-red":"btn-blueintense"}">${o.tipo}</button>`},{title:"Cantidad",data:"cantidad"},{title:"Stock anterior",data:"stockanterior"},{title:"Stock",data:"stocknuevo"},{title:"Fecha",data:"created_at"},{title:"Referencia",data:"referencia"}],language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},layout:{topStart:{buttons:[{extend:"excelHtml5",title:"facturas procesadas"},{extend:"pdfHtml5",title:"facturas procesadas"},{extend:"print",title:"facturas procesadas",text:"Imprimir"},"colvis"],pageLength:"pageLength"}}})}document.querySelector("#mesañoactual").textContent=r[0]+" "+r[1],$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),i=t.endDate.format("YYYY-MM-DD HH:mm:ss");n=o,a=i})),__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/totalitems",t=yield fetch(e),o=yield t.json();d=o.map(e=>{var t;return{id:e.id,text:e.nombre,tipo:null!==(t=e.tipoproducto)&&void 0!==t?t:"1",sku:e.sku,unidadmedida:e.unidadmedida}}),function(e){$("#item").select2({data:e,placeholder:"Selecciona un item",maximumSelectionLength:1})}(d),console.log(d)}catch(e){console.log(e)}})),t.addEventListener("click",()=>{let t=$("#item").select2("data")[0];""!=n&&""!=a?void 0!==t?(console.log(t),function(t,o,n,a){__awaiter(this,void 0,void 0,(function*(){console.log(t,o),document.querySelector(".content-spinner1").style.display="grid";const r=new FormData;r.append("fechainicio",t),r.append("fechafin",o),r.append("tipo",n),r.append("iditem",a);try{const t="/admin/api/movimientoInventario",o=yield fetch(t,{method:"POST",body:r}),n=yield o.json();i=n,console.log(i),e(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}(n,a,t.tipo,t.id)):msjalertToast("error","¡Error!","Seleccionar un item de la lista"):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),e()}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".reportescompras")){const a=document.querySelector("#consultarFechaPersonalizada"),i=document.querySelector("#btnmesactual"),r=document.querySelector("#btnmesanterior"),d=document.querySelector("#btnhoy"),c=document.querySelector("#btnayer");let l,s="",u="",m=[];function t(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function o(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const o=new FormData;o.append("fechainicio",e),o.append("fechafin",t);try{const e="/admin/api/reportecompras",t=yield fetch(e,{method:"POST",body:o}),a=yield t.json();m=a,console.log(m),n(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function n(){l=$("#tablaReportesCompras").DataTable({responsive:!0,destroy:!0,data:m,columns:[{title:"id",data:"id"},{title:"usuario",data:"nombreusuario"},{title:"proveedor",data:"nombreproveedor"},{title:"caja",data:null,render:e=>{const t="0"==e.estadocierrecaja?"Abierta":"Cerrada";return`${e.nombrecaja} - ${t}`}},{title:"formapago",data:"formapago"},{title:"nfactura",data:"nfactura"},{title:"cantidaditems",data:"cantidaditems"},{title:"valortotal",data:"valortotal",render:e=>"$"+Number(e).toLocaleString()},{title:"fechacompra",data:"fechacompra"},{title:"Acciones",data:null,orderable:!1,searchable:!1,render:(e,t,o)=>`<button class="btn-ver mr-4" data-id="${o.id}">✳️​</button> <button class="btn-eliminar" data-id="${o.id}">⛔​</button>`}]})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");s=o,u=n})),i.addEventListener("click",e=>{const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);o(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",e=>{const t=new Date,n=new Date(t.getFullYear(),t.getMonth()-1,1),a=new Date(t.getFullYear(),t.getMonth(),0);o(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),d.addEventListener("click",e=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);o(t(a),t(i))}),c.addEventListener("click",e=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);o(t(i),t(r))}),a.addEventListener("click",()=>{""!=s&&""!=u?o(s,u):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),n(),null===(e=document.querySelector("#tablaReportesCompras"))||void 0===e||e.addEventListener("click",e=>{var t;const o=e.target;let n=null==o?void 0:o.dataset.id;(null===(t=e.target)||void 0===t?void 0:t.classList.contains("btn-ver"))&&function(e){const t=m.find(t=>t.id==e);null!=(null==t?void 0:t.id)&&(window.location.href="/admin/reportes/detallecompra?id="+t.id)}(n),(null==o?void 0:o.classList.contains("btn-eliminar"))&&function(e,t){const o=m.find(t=>t.id==e),n=l.row(t.closest("tr"));"0"===(null==o?void 0:o.estadocierrecaja)?Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la compra del sistema?",text:"La compra sera eliminado por completo de la aplicacion.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",o.id);try{const t="/admin/api/eliminarcompra",o=yield fetch(t,{method:"POST",body:e}),a=yield o.json();void 0!==a.exito?(msjalertToast("success","¡Éxito!",a.exito[0]),n.remove().draw(!1)):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))})()}):msjalertToast("error","¡Error!","No se puede eliminar la compra, porque la caja esta cerrada")}(n,o)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gastoseingresos")){const r=document.querySelector("#consultarFechaPersonalizada"),d=document.querySelector("#btnmesactual"),c=document.querySelector("#btnmesanterior"),l=document.querySelector("#btnhoy"),s=document.querySelector("#btnayer");let u,m,p="",v="",f=[],g=[];function o(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function n(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const o=new FormData;o.append("fechainicio",e),o.append("fechafin",t);try{const e="/admin/api/gastoseingresos",t=yield fetch(e,{method:"POST",body:o}),n=yield t.json();f=n.gastos,g=n.ingresos,console.log(n),a(),i(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function a(){u=$("#tablaGastos").DataTable({destroy:!0,data:f,columns:[{title:"id",data:"Id"},{title:"Caja",data:null,render:e=>{const t="0"==e.estado?"Abierta":"Cerrada";return`${e.nombrecaja} - ${t}`}},{title:"Banco",data:"nombrebanco"},{title:"Usuario",data:"nombre"},{title:"Operacion",data:"operacion"},{title:"Tipo Gasto",data:"categoriagasto"},{title:"Valor",data:"valor",render:e=>"$"+Number(e).toLocaleString()},{title:"Fecha",data:"fecha"},{title:"Acciones",data:null,orderable:!1,searchable:!1,render:(e,t,o)=>`<button class="btn-ver" data-id="${o.Id}">✳️​</button>\n                                            <button class="btn-imgcomprobante" data-id="${o.Id}">🧾​</button>\n                                            <button class="btn-eliminar" data-id="${o.Id}">⛔​</button>`}]})}function i(){m=$("#tablaIngresos").DataTable({destroy:!0,data:g,columns:[{title:"id",data:"id"},{title:"Caja",data:null,render:e=>{const t="0"==e.estado?"Abierta":"Cerrada";return`${e.nombrecaja} - ${t}`}},{title:"Usuario",data:"nombreusuario"},{title:"Operacion",data:"operacion"},{title:"Valor",data:"valor",render:e=>"$"+Number(e).toLocaleString()},{title:"Fecha",data:"fecha"},{title:"Acciones",data:null,orderable:!1,searchable:!1,render:(e,t,o)=>`<button class="btn-eliminar" data-id="${o.id}">⛔​</button>`}]})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");p=o,v=n})),d.addEventListener("click",e=>{const t=new Date,o=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);n(o.toISOString().split("T")[0],a.toISOString().split("T")[0])}),c.addEventListener("click",e=>{const t=new Date,o=new Date(t.getFullYear(),t.getMonth()-1,1),a=new Date(t.getFullYear(),t.getMonth(),0);n(o.toISOString().split("T")[0],a.toISOString().split("T")[0])}),l.addEventListener("click",e=>{const t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),i=new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59);n(o(a),o(i))}),s.addEventListener("click",e=>{const t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()-1),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);n(o(i),o(r))}),r.addEventListener("click",()=>{""!=p&&""!=v?n(p,v):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),a(),i(),null===(e=document.querySelector("#tablaGastos"))||void 0===e||e.addEventListener("click",e=>{var t;const o=e.target;let n=null==o?void 0:o.dataset.id;(null===(t=e.target)||void 0===t?void 0:t.classList.contains("btn-ver"))&&function(e){const t=f.find(t=>t.Id==e);null!=(null==t?void 0:t.id_compra)&&(window.location.href="/admin/reportes/compra?id="+t.id_compra)}(n),(null==o?void 0:o.classList.contains("btn-imgcomprobante"))&&function(e){const t=f.find(t=>t.Id==e);(null==t?void 0:t.imgcomprobante)&&window.open("/build/img/"+(null==t?void 0:t.imgcomprobante),"_blank")}(n),(null==o?void 0:o.classList.contains("btn-eliminar"))&&function(e,t){const o=f.find(t=>t.Id==e),n=u.row(t.closest("tr"));"0"===(null==o?void 0:o.estado)?Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el gasto de la caja?",text:"El gasto sera eliminado por completo de la caja.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",o.Id);try{const t="/admin/api/eliminargasto",o=yield fetch(t,{method:"POST",body:e}),a=yield o.json();void 0!==a.exito?(msjalertToast("success","¡Éxito!",a.exito[0]),n.remove().draw(!1)):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))})()}):msjalertToast("error","¡Error!","No se puede eliminar el gasto, porque la caja esta cerrada")}(n,o)}),null===(t=document.querySelector("#tablaIngresos"))||void 0===t||t.addEventListener("click",e=>{const t=e.target;let o=null==t?void 0:t.dataset.id;(null==t?void 0:t.classList.contains("btn-eliminar"))&&function(e,t){const o=g.find(t=>t.id==e),n=m.row(t.closest("tr"));"0"===(null==o?void 0:o.estado)?Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el ingreso de la caja?",text:"El ingreso sera eliminado por completo de la caja.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",o.id);try{const t="/admin/api/eliminaringreso",o=yield fetch(t,{method:"POST",body:e}),a=yield o.json();void 0!==a.exito?(msjalertToast("success","¡Éxito!",a.exito[0]),n.remove().draw(!1)):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))})()}):msjalertToast("error","¡Error!","No se puede eliminar el ingreso, porque la caja esta cerrada")}(o,t)})}})(),(()=>{if(document.querySelector(".utilidadxproducto")){let e;e=$("#tablaUtilidadXProducto").DataTable(configdatatablesgenerico)}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".ventasxtransaccion")){const a=document.querySelector("#btnmensual"),i=document.querySelector("#btndiario"),r=document.querySelector("#miDialogoMes"),d=document.querySelector("#miDialogoDiario");let c,l=[];function o(){c=$("#tablaTransaccioneXVenta").DataTable({destroy:!0,data:l,columns:[{title:"Fecha",data:"fecha"},{title:"Toal venta",data:"total_venta",render:e=>"$"+Number(e).toLocaleString()},{title:"Numero de transacciones",data:"num_transacciones"},{title:"Promedio por transacción",data:"promedio_transaccion"},{title:"Transacción mas alta",data:"transaccion_mas_alta"},{title:"Transacción mas baja",data:"transaccion_mas_baja"}]})}function n(e){const t=e.target;(t===r||t===d||t.closest(".salir"))&&(r.close(),d.close(),document.removeEventListener("click",n))}null==a||a.addEventListener("click",()=>{r.showModal(),document.addEventListener("click",n)}),null==i||i.addEventListener("click",()=>{d.showModal(),document.addEventListener("click",n)}),null===(e=document.querySelector("#formMes"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault();const t=document.querySelector("#inputselectaño");__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/ventasxtransaccionanual?x="+t.value,n=yield fetch(e),a=yield n.json();l=a,console.log(a),o()}catch(e){console.log(e)}})),r.close(),document.removeEventListener("click",n)}),null===(t=document.querySelector("#formDiario"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault();const t=document.querySelector("#inputselectmesyaño");__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/ventasxtransaccionmes?x="+t.value,n=yield fetch(e),a=yield n.json();l=a,o()}catch(e){console.log(e)}})),d.close(),document.removeEventListener("click",n)}),o()}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function d(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,d)}c((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".ventasxcliente")){const n=document.querySelector("#consultarFechaPersonalizada"),a=document.querySelector("#btnmesactual"),i=document.querySelector("#btnmesanterior"),r=document.querySelector("#btnhoy"),d=document.querySelector("#btnayer");let c,l="",s="",u=[];function e(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function t(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const n=new FormData;n.append("fechainicio",e),n.append("fechafin",t);try{const e="/admin/api/ventasxcliente",t=yield fetch(e,{method:"POST",body:n}),a=yield t.json();u=a,o(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function o(){c=$("#tablaVentasXCliente").DataTable({destroy:!0,data:u,columns:[{title:"Nombre",data:"nombre"},{title:"Cantidad_facturas",data:"cantidad_facturas"},{title:"Total ventas",data:"total_ventas",render:e=>"$"+Number(e).toLocaleString()}]})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");l=o,s=n})),a.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth(),1),a=new Date(o.getFullYear(),o.getMonth()+1,0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),i.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth()-1,1),a=new Date(o.getFullYear(),o.getMonth(),0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);t(e(a),e(i))}),d.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);t(e(i),e(r))}),n.addEventListener("click",()=>{""!=l&&""!=s?t(l,s):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),o()}})();
//# sourceMappingURL=bundle.ts.js.map
