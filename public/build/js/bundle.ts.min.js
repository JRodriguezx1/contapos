"use strict";const mobilemenu=document.querySelector("#mobile-menu"),sidebar=document.querySelector(".sidebar"),btnmenux=document.querySelector("#mobile-menux"),barra=document.querySelector(".barra-mobile"),nametop=document.querySelector(".nametop");window.POS=window.POS||{},mobilemenu&&mobilemenu.addEventListener("click",(function(){sidebar&&barra&&(sidebar.classList.toggle("mostrar"),barra.classList.toggle("ocultarmenu"))})),btnmenux&&btnmenux.addEventListener("click",(function(){sidebar&&barra&&(sidebar.classList.toggle("mostrar"),barra.classList.toggle("ocultarmenu"))})),document.querySelector(".sidebartoggle").addEventListener("click",e=>{sidebar&&(null==sidebar||sidebar.classList.toggle("minsidebar")),nametop&&nametop.classList.toggle("noneElement"),$(".btnav").toggleClass("noneElement")});const configdatatables={paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}},configdatatablesgenerico={layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"informe"},{extend:"csvHtml5",title:"informe"},{extend:"pdfHtml5",title:"informe"},{extend:"print",title:"informe",text:"Imprimir"},"colvis"],pageLength:"pageLength"}},pageLength:25,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}},configdatatablesstockrapido={layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",exportOptions:{columns:[1,2,3,4,5]},title:"Stock-inventario"},{extend:"csvHtml5",exportOptions:{columns:[1,2,3,4,5]},title:"Stock-inventario"},{extend:"pdfHtml5",exportOptions:{columns:[1,2,3,4,5]},title:"Stock-inventario"},{extend:"print",exportOptions:{columns:[1,3,4]},title:"Stock-inventario",text:"Imprimir"},"colvis"],pageLength:"pageLength"}},pageLength:25,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}},configdatatablesajustarcostos={layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",exportOptions:{columns:[1,3,4,5,6]},title:"costo por producto"},{extend:"csvHtml5",exportOptions:{columns:[1,3,4,5,6]},title:"costo por producto"},{extend:"pdfHtml5",exportOptions:{columns:[1,3,4,5,6]},title:"costo por producto"},{extend:"print",exportOptions:{columns:[1,3,4,5,6]},title:"costo por producto",text:"Imprimir"},"colvis"],pageLength:"pageLength"}},pageLength:25,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}},configdatatablescaja={paging:!1,order:[[3,"desc"]],searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando 1 de _MAX_ registros",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}};function msjAlert(e,t,o){o.insertAdjacentHTML("beforeend",`<div class="alerta alerta__${e}">\n      <p><i class="fa-solid fa-circle-exclamation"></i> ${t}</p></div>`),borrarMsjAlert(o)}function borrarMsjAlert(e){document.querySelector(".alerta")&&setTimeout(()=>{for(;e.firstChild;)e.removeChild(e.firstChild)},5e3)}function msjalertToast(e,t,o){Swal.fire({icon:e,title:t,text:o,toast:!0,position:"top-end",showConfirmButton:!1,timer:2700})}if(document.querySelectorAll(".count-charts").forEach(e=>{var t;e.textContent=(parseInt(e.dataset.num)-e.previousElementSibling.value.length).toString(),null===(t=e.previousElementSibling)||void 0===t||t.addEventListener("input",t=>{if(e.textContent=parseInt(e.dataset.num)-t.target.value.length+"",parseInt(e.dataset.num)-t.target.value.length<=0){let o=t.target.value.slice(0,parseInt(e.dataset.num));t.target.value=o,e.textContent="0"}})}),document.querySelector("#tabulacion")){const e=document.querySelector('#tabulacion input[type="radio"]:checked').nextElementSibling;document.querySelector("."+e.id).style.display="block";const t=document.querySelectorAll(".tabs span"),o=document.querySelectorAll(".paginas");t.forEach(e=>{e.addEventListener("click",e=>{const t=e.target;o.forEach(e=>e.style.display="none"),document.querySelector("."+t.id).style.display="block"})})}var __awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t,o;if(document.querySelector(".clientes")){const a=document.querySelector("#crearCliente"),r=document.querySelector("#crearDireccion"),i=document.querySelector("#miDialogoCliente"),c=document.querySelector("#miDialogoCrearDireccion"),d=document.querySelector("#miDialogoUpDireccion"),l=document.querySelector("#selectdirecciones"),s=document.querySelector("#btnCerrarUpDireccion");let u,m,p=0,v=0,g=[],f=[];function n(e){e.target!==i&&e.target!==c&&e.target!==d&&"salir"!==e.target.value||(i.close(),c.close(),d.close(),document.removeEventListener("click",n))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allclientes",t=yield fetch(e);f=yield t.json(),console.log(f)}catch(e){console.log(e)}})),u=$("#tablaClientes").DataTable(configdatatables),null==a||a.addEventListener("click",e=>{v=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateCliente"))||void 0===e||e.reset()}(),document.querySelector("#modalCliente").textContent="Crear cliente",document.querySelector("#btnEditarCrearCliente").value="Crear",i.showModal(),document.addEventListener("click",n)}),null==r||r.addEventListener("click",e=>{v=0,document.querySelector("#modalDireccion").textContent="Crear direccion",document.querySelector("#btnEditarCrearDireccion").value="Crear",c.showModal(),document.addEventListener("click",n),$("#selectcliente").select2({dropdownParent:$("#miDialogoCrearDireccion"),placeholder:"Seleccionar el cliente",maximumSelectionLength:1})}),null===(e=document.querySelector("#tablaClientes"))||void 0===e||e.addEventListener("click",e=>{var t,o,a,r;const c=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarClientes"))||(null===(o=e.target.parentElement)||void 0===o?void 0:o.classList.contains("editarClientes")))&&function(e){var t,o,a,r,c,d,l,s,u;let p=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(o=e.target)||void 0===o?void 0:o.tagName)&&(p=null===(r=null===(a=e.target.parentElement)||void 0===a?void 0:a.parentElement)||void 0===r?void 0:r.id);v=1,document.querySelector("#modalCliente").textContent="Actualizar cliente",document.querySelector("#btnEditarCrearCliente").value="Actualizar",m=f.find(e=>e.id===p),document.querySelector("#nombre").value=null==m?void 0:m.nombre,document.querySelector("#apellido").value=null==m?void 0:m.apellido,$("#tipodocumento").val(null!==(c=null==m?void 0:m.tipodocumento)&&void 0!==c?c:""),document.querySelector("#identificacion").value=null!==(d=null==m?void 0:m.identificacion)&&void 0!==d?d:"",document.querySelector("#telefono").value=null!==(l=null==m?void 0:m.telefono)&&void 0!==l?l:"",document.querySelector("#email").value=null!==(s=null==m?void 0:m.email)&&void 0!==s?s:"",document.querySelector("#fecha_nacimiento").value=null!==(u=null==m?void 0:m.fecha_nacimiento)&&void 0!==u?u:"",i.showModal(),document.addEventListener("click",n)}(e),((null==c?void 0:c.classList.contains("eliminarClientes"))||(null===(a=c.parentElement)||void 0===a?void 0:a.classList.contains("eliminarClientes")))&&function(e){let t=e.target.parentElement.id,o=u.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);p=u.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el cliente?",text:"El cliente sera eliminado por completo.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarCliente",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(u.row(p+o.start).remove().draw(),u.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e),((null==c?void 0:c.classList.contains("editarEliminarDireccion"))||(null===(r=c.parentElement)||void 0===r?void 0:r.classList.contains("editarEliminarDireccion")))&&function(e){let t=e.target.parentElement.id;u.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/direccionesXcliente?id="+t,o=yield fetch(e),n=yield o.json();g=n,function(e){for(;null==l?void 0:l.firstChild;)l.removeChild(null==l?void 0:l.firstChild);e.forEach(e=>{const t=document.createElement("option");t.textContent=e.direccion,t.value=e.id,t.dataset.idcliente=e.idcliente,t.dataset.idtarifa=e.idtarifa,l.appendChild(t)}),$("#uptarifa").val(e[0].idtarifa),document.querySelector("#updepartamento").value=e[0].departamento,document.querySelector("#upciudad").value=e[0].ciudad,document.querySelector("#updireccion").value=e[0].direccion}(n)}catch(e){console.log(e)}}))})(),d.showModal(),document.addEventListener("click",n)}(e)}),null===(t=document.querySelector("#formCrearUpdateCliente"))||void 0===t||t.addEventListener("submit",e=>{if(v){e.preventDefault();var t=u.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",m.id),e.append("nombre",$("#nombre").val()),e.append("apellido",$("#apellido").val()),e.append("tipodocumento",$("#tipodocumento").val()),e.append("identificacion",$("#identificacion").val()),e.append("telefono",$("#telefono").val()),e.append("email",$("#email").val()),e.append("fecha_nacimiento",$("#fecha_nacimiento").val());try{const o="/admin/api/actualizarCliente",a=yield fetch(o,{method:"POST",body:e}),r=yield a.json();if(console.log(r),void 0!==r.exito){msjalertToast("success","¡Éxito!",r.exito[0]),f.forEach(e=>{e.id==m.id&&(e=Object.assign(e,r.cliente[0]))});const e=u.row(p).data();e[1]=$("#nombre").val(),e[2]=$("#apellido").val(),e[3]=$("#telefono").val(),e[4]=$("#email").val(),u.row(p).data(e).draw(),u.page(t.page).draw("page")}else msjalertToast("error","¡Error!",r.error[0]);i.close(),document.removeEventListener("click",n)}catch(e){console.log(e)}}))}}),null==l||l.addEventListener("change",e=>{var t;const o=e.target,n=o.options[o.selectedIndex].value,a=g.find(e=>e.id==n);$("#uptarifa").val(null!==(t=null==a?void 0:a.idtarifa)&&void 0!==t?t:1),document.querySelector("#updepartamento").value=a.departamento,document.querySelector("#upciudad").value=a.ciudad,document.querySelector("#updireccion").value=a.direccion}),null===(o=document.querySelector("#formUpDireccion"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault()}),s.addEventListener("click",()=>d.close())}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};!function(){if(document.querySelector(".inicio")){function e(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const o=yield fetch(e),n=yield o.json();"ventasVsGastos"==t&&function(e){const t=document.getElementById("chartVentasGastos").getContext("2d");new Chart(t,{data:{labels:e.periodo,datasets:[{type:"bar",label:"Ventas",data:e.ventastotales,backgroundColor:"rgba(239,68,68,0.8)"},{type:"line",label:"Gastos",data:e.gastostotales,borderColor:"#4F46E5",backgroundColor:"rgba(79,70,229,0.15)",tension:.3,fill:!0,yAxisID:"y1"}]},options:{responsive:!0,plugins:{legend:{position:"bottom"}},scales:{y:{beginAtZero:!0,position:"left",title:{display:!0,text:"Ventas (COP)"}},y1:{beginAtZero:!0,position:"right",grid:{drawOnChartArea:!1},title:{display:!0,text:"Gastos (COP)"}}}}})}(n),"ultimos7dias"==t&&function(e){const t=document.getElementById("chartIngresosDias").getContext("2d");new Chart(t,{type:"bar",data:{labels:e.map(e=>e.dia),datasets:[{label:"Ingresos",data:e.map(e=>e.ventas_totales),backgroundColor:"#10B981"}]},options:{responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})}(n)}catch(e){console.log(e)}}))}e("/admin/api/ventasVsGastos","ventasVsGastos"),e("/admin/api/ultimos7dias","ultimos7dias")}}();const mobilemenu1=document.querySelector("#mobile-menu1"),miDialogomenumovil=document.querySelector("#miDialogomenumovil");function cerrarDialogoExterno(e){e.target===miDialogomenumovil&&(miDialogomenumovil.close(),miDialogomenumovil.setAttribute("hidden","true"),document.removeEventListener("click",cerrarDialogoExterno))}miDialogomenumovil.close(),miDialogomenumovil.setAttribute("hidden","true"),mobilemenu1.addEventListener("click",()=>{miDialogomenumovil.showModal(),miDialogomenumovil.removeAttribute("hidden"),document.addEventListener("click",cerrarDialogoExterno)}),(()=>{if(document.querySelector(".perfil")){const t=document.querySelector("#btnCambiarEmail"),o=document.querySelector("#miDialogoUpEmail");function e(t){t.target!==o&&"salir"!==t.target.value||(o.close(),document.removeEventListener("click",e))}null==t||t.addEventListener("click",t=>{o.showModal(),document.addEventListener("click",e)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".ajustarcostos")){let t,o=[];__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",n=yield fetch(e);o=yield n.json(),console.log(o),o.forEach(e=>{var t,o;let n=null===(t=document.querySelector(`tr[data-idsubproducto="${e.idsubproducto}"]`))||void 0===t?void 0:t.children[5].children[0];null==n&&(n=null===(o=document.querySelector(`tr[data-idproducto="${e.idproducto}"]`))||void 0===o?void 0:o.children[5].children[0]);const a=document.createElement("option");a.textContent=e.nombreunidaddestino,a.dataset.factor=e.factorconversion,null==n||n.appendChild(a)}),t=$("#tablaAjustarCostos").DataTable(configdatatablesajustarcostos)}catch(e){console.log(e)}})),null===(e=document.querySelector("#tablaAjustarCostos"))||void 0===e||e.addEventListener("input",e=>{var t,o=e.target;let n="",a="";if(o.classList.contains("inputAjustarCosto")){var r=o.closest("tr");const e=null==r?void 0:r.querySelector(".formulario__select"),c=Number(e.options[e.selectedIndex].dataset.factor);var i=o.closest(".fila");i||(i=null===(t=o.closest("tr"))||void 0===t?void 0:t.previousSibling),i.classList.contains("producto")?(a=i.dataset.idproducto,n="0"):(a=i.dataset.idsubproducto,n="1"),function(e,t,o,n){""==n.value&&(n.value="0");const a=Number(n.value)/o;console.log(a),(()=>{__awaiter(this,void 0,void 0,(function*(){const o=new FormData;o.append("tipoelemento",e),o.append("idelemento",t),o.append("precio_compra",a+"");try{const e="/admin/api/actualizarcostos",t=yield fetch(e,{method:"POST",body:o}),a=yield t.json();void 0!==a.exito?(n.style.color="#02db02",n.style.fontWeight="500"):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))})()}(n,a,c,o)}})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t,o;if(document.querySelector(".almacen")){const i=document.querySelector("#btntrasladoinvnetario"),c=document.querySelector("#btnXCerrarTrasladoInvnetario"),d=document.querySelector("#miDialogoTrasladoInvnetario"),l=document.querySelector("#reinciarinv"),s=document.querySelector("#miDialogoStock"),u=document.querySelector("#modalStock"),m=document.querySelector("#selectStockRapidoUndmedida");let p=document.querySelector("#cantidadStockRapido");const v=document.querySelector("#miDialogoIngresarProduccion"),g=document.querySelector("#itemAproducir"),f=document.querySelectorAll(".btnproduccion"),y=document.querySelector("#selectIngresarProduccionUnidadmedida"),h=document.querySelector("#stockIngresarProduccion");let S,b,x=0,w=0,E="",q=0,L="",C="";const _=document.querySelector("#sedes");let D=[],k=[];function n(e){document.querySelector("#stock").textContent=Number(e.stock).toLocaleString(),document.querySelector("#costoProduccion").textContent="$"+Number(e.precio_compra).toLocaleString(),document.querySelector("#precioVenta").textContent="$"+Number(e.precio_venta).toLocaleString()}function a(e,t){e.forEach(e=>{S.rows().every((function(){var o,n,a,r;const i=this.node();let c=e.subproductoid,d=i.getAttribute("data-idsubproducto");if("0"==t&&(d=i.getAttribute("data-idproducto"),c=e.productoid),d&&d===c){this.cell(this.index(),3).data(`<div class="text-center px-3 py-4 rounded-lg">${e.stock}</div>`);const t=S.cell(this.index(),3).node();Number(e.stock)<=Number(e.stockminimo)?(null===(o=t.firstElementChild)||void 0===o||o.classList.remove("bg-cyan-50","text-cyan-600"),null===(n=t.firstElementChild)||void 0===n||n.classList.add("bg-red-50","text-red-800")):(null===(a=t.firstElementChild)||void 0===a||a.classList.remove("bg-red-50","text-red-800"),null===(r=t.firstElementChild)||void 0===r||r.classList.add("bg-cyan-50","text-cyan-600"))}}))})}function r(e){var t;const o=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;e.target!==d&&"btnXCerrarTrasladoInvnetario"!=o&&e.target!==c&&e.target!==s&&e.target!==v&&"salir"!==e.target.value||(s.close(),v.close(),d.close(),document.removeEventListener("click",r))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",t=yield fetch(e);k=yield t.json()}catch(e){console.log(e)}})),i.addEventListener("click",()=>{d.showModal(),document.addEventListener("click",r)}),l.addEventListener("click",e=>{Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea reiniciar el inventario a cero?",text:"Todos los productos e insumos del inventario se reiniciaran a cero.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/reiniciarinv",t=yield fetch(e);msjalertToast("success","¡Éxito!",yield t.json()),setTimeout(()=>{window.location.reload()},1200)}catch(e){console.log(e)}}))})}),null==_||_.addEventListener("change",e=>{e.target.checked&&(document.querySelector(".content-spinner1").style.display="grid",__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/getStockproductosXsucursal",t=yield fetch(e);D=yield t.json(),function(){const e=[...new Set(D.map(e=>e.sucursal))],t={};D.forEach(e=>{e.productoid&&(t["p"+e.productoid]||(t["p"+e.productoid]={nombreproducto:e.nombreproducto,stocks:{}}),t["p"+e.productoid].stocks[e.sucursal]=e.stock),e.subproductoid&&(t["s"+e.subproductoid]||(t["s"+e.subproductoid]={nombreproducto:"S-"+e.nombreproducto,stocks:{}}),t["s"+e.subproductoid].stocks[e.sucursal]=e.stock)});const o=[{title:"Producto",data:"nombreproducto"}];e.forEach(e=>{o.push({title:e,data:e})});const n=Object.values(t).map(t=>{const o={nombreproducto:t.nombreproducto};return e.forEach(e=>{var n;o[e]=null!==(n=t.stocks[e])&&void 0!==n?n:0}),o});b=$("#tablaInventarioSedes").DataTable({data:n,columns:o,layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"InventarioXsede"},{extend:"pdfHtml5",title:"InventarioXsede"},{extend:"print",title:"InventarioXsede",text:"Imprimir"},"colvis"],pageLength:"pageLength"}},pageLength:25,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando 1 de _MAX_ registros",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},destroy:!0})}(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}})))}),S=$("#tablaStockRapido").DataTable(configdatatablesstockrapido),null===(e=document.querySelector("#tablaStockRapido"))||void 0===e||e.addEventListener("click",e=>{var t,o,n,a,i,c;let d="";const l=e.target;for(l.closest(".btnsproducto")&&(C=l.closest(".btnsproducto").id,L="0",x=Number(l.closest(".btnsproducto").dataset.stock),document.querySelector("#nombreItemstockrapido").textContent=l.closest(".btnsproducto").dataset.nombre),l.closest(".btnssubproducto")&&(C=l.closest(".btnssubproducto").id,L="1",x=Number(l.closest(".btnssubproducto").dataset.stock),document.querySelector("#nombreItemstockrapido").textContent=l.closest(".btnssubproducto").dataset.nombre);m.firstChild;)m.removeChild(m.firstChild);if("0"==L){k.filter(e=>e.idproducto==C).forEach(e=>d+=`<option data-factor="${e.factorconversion}" value="${e.idproducto}" >${e.nombreunidaddestino}</option>`),m.insertAdjacentHTML("afterbegin",d)}if("1"==L){k.filter(e=>e.idsubproducto==C).forEach(e=>d+=`<option data-factor="${e.factorconversion}" value="${e.idsubproducto}" >${e.nombreunidaddestino}</option>`),m.insertAdjacentHTML("afterbegin",d)}((null===(t=e.target)||void 0===t?void 0:t.classList.contains("descontarStock"))||(null===(o=e.target.parentElement)||void 0===o?void 0:o.classList.contains("descontarStock")))&&function(e){u.textContent="Descontar cantidad a inventario",E="descontarstock",w=S.row(e.target.closest("tr")).index(),s.showModal(),document.addEventListener("click",r)}(e),((null===(n=e.target)||void 0===n?void 0:n.classList.contains("aumentarStock"))||(null===(a=e.target.parentElement)||void 0===a?void 0:a.classList.contains("aumentarStock")))&&function(e){u.textContent="Ingreasar cantidad a inventario",E="aumentarstock",w=S.row(e.target.closest("tr")).index(),s.showModal(),document.addEventListener("click",r)}(e),((null===(i=e.target)||void 0===i?void 0:i.classList.contains("ajustarStock"))||(null===(c=e.target.parentElement)||void 0===c?void 0:c.classList.contains("ajustarStock")))&&function(e){u.textContent="Ajustar cantidad a inventario",E="ajustarstock",w=S.row(e.target.closest("tr")).index(),s.showModal(),document.addEventListener("click",r)}(e)}),null===(t=document.querySelector("#formStock"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault(),q=Number(m.options[m.selectedIndex].dataset.factor);S.page.info();let t=q*Number(p.value);"descontarstock"==E&&(x-=t),"aumentarstock"==E&&(x+=t),"ajustarstock"==E&&(x=t),__awaiter(void 0,void 0,void 0,(function*(){var e;const o=new FormData;o.append("tipoitem",L),o.append("iditem",C),o.append("cantidad",t.toString());try{const t="/admin/api/"+E,n=yield fetch(t,{method:"POST",body:o}),i=yield n.json();void 0!==i.exito?(msjalertToast("success","¡Éxito!",i.exito[0]),null===(e=document.querySelector("#formStock"))||void 0===e||e.reset(),a([i.item[0]],L)):msjalertToast("error","¡Error!",i.error[0]),s.close(),document.removeEventListener("click",r)}catch(e){console.log(e)}}))}),$("#itemAproducir").select2({maximumSelectionLength:1}),$("#itemAproducir").on("change",e=>{const t=e.target.value,o=$("#itemAproducir option:selected");if(t){let e;!function(e){for(;null==y?void 0:y.firstChild;)y.removeChild(null==y?void 0:y.firstChild);e.forEach(e=>{const t=document.createElement("option");t.textContent=e.nombreunidaddestino,t.value=e.id,t.dataset.factor=e.factorconversion,y.appendChild(t)})}(k.filter(e=>e.idproducto==t)),e={stock:o.data("stock"),precio_compra:o.data("precio_compra"),precio_venta:o.data("precio_venta")},n(e)}}),f.forEach((e,t)=>{e.addEventListener("click",e=>{g.value&&(document.querySelector("#nombreItemAProducir").textContent=g.options[g.selectedIndex].textContent,0===t&&(E="aumentarstock",document.querySelector("#modalIngresarProduccion").textContent="Ingreasar produccion a inventario"),1===t&&(E="descontarstock",document.querySelector("#modalIngresarProduccion").textContent="Descontar catnidad de inventario"),2===t&&(E="ajustarstock",document.querySelector("#modalIngresarProduccion").textContent="Ajustar cantidad de inventario"),v.showModal(),document.addEventListener("click",r))})}),null===(o=document.querySelector("#formIngresarProduccion"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault(),q=Number(y.options[y.selectedIndex].dataset.factor);let t=q*Number(h.value);__awaiter(void 0,void 0,void 0,(function*(){var e;const o=new FormData;o.append("tipoitem","0"),o.append("iditem",g.value),o.append("cantidad",t.toString()),o.append("construccion","1");try{const t="/admin/api/"+E,i=yield fetch(t,{method:"POST",body:o}),c=yield i.json();void 0!==c.exito?(msjalertToast("success","¡Éxito!",c.exito[0]),null===(e=document.querySelector("#formIngresarProduccion"))||void 0===e||e.reset(),n(c.item[0]),void 0!==c.insumos&&a(c.insumos[0],"1"),$("#itemAproducir option:selected").data("stock",c.item[0].stock)):msjalertToast("error","¡Error!",c.error[0]),v.close(),document.removeEventListener("click",r)}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".categorias")){const n=document.querySelector("#crearCategoria"),a=document.querySelector("#miDialogoCategoria");let r,i=0,c=0;function o(e){e.target!==a&&"Salir"!==e.target.value&&"Actualizar"!==e.target.value||(a.close(),document.removeEventListener("click",o))}r=$("#tablaCategorias").DataTable(configdatatables),null==n||n.addEventListener("click",e=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateCategoria"))||void 0===e||e.reset(),document.querySelector("#formCrearUpdateCategoria").action="/admin/almacen/crear_categoria",document.querySelector("#idcategoria").value="0"}(),document.querySelector("#modalCategoria").textContent="Crear categoria",document.querySelector("#btnEditarCrearCategoria").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaCategorias"))||void 0===e||e.addEventListener("click",e=>{var t,n,d;const l=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarCategoria"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarCategoria")))&&function(e){var t,n,d,l,s;c=1;let u=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(u=null===(l=null===(d=e.target.parentElement)||void 0===d?void 0:d.parentElement)||void 0===l?void 0:l.id);document.querySelector("#modalCategoria").textContent="Actualizar categoria",document.querySelector("#btnEditarCrearCategoria").value="Actualizar",document.querySelector("#idcategoria").value=u,document.querySelector("#categoria").value=null===(s=e.target.closest(".acciones-btns"))||void 0===s?void 0:s.dataset.categoria,i=r.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==l?void 0:l.classList.contains("eliminarCategoria"))||(null===(d=l.parentElement)||void 0===d?void 0:d.classList.contains("eliminarCategoria")))&&function(e){let t=e.target.parentElement.id,o=r.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);i=r.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la categoria?",text:"La categoria sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarCategoria",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();a.length||void 0!==a.exito?(r.row(i+o.start).remove().draw(),r.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateCategoria"))||void 0===t||t.addEventListener("submit",e=>{if(c){e.preventDefault();var t=r.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",$("#idcategoria").val()),e.append("nombre",$("#categoria").val());try{const n="/admin/api/actualizar_categoria",a=yield fetch(n,{method:"POST",body:e}),c=yield a.json();if(console.log(c),void 0!==c.exito){msjalertToast("success","¡Éxito!",c.exito[0]);const e=r.row(i+=t.start).data();e[1]=$("#categoria").val(),e[3]=`<div class="acciones-btns" id="${$("#idcategoria").val()}" data-categoria="${$("#categoria").val()}"><button class="btn-md btn-turquoise editarCategoria"><i class="fa-solid fa-pen-to-square"></i></button><button class="btn-md btn-red eliminarCategoria"><i class="fa-solid fa-trash-can"></i></button></div>`,r.row(i).data(e).draw(),r.page(t.page).draw("page")}else msjalertToast("error","¡Error!",c.error[0]);document.addEventListener("click",o)}catch(e){console.log(e)}}))}})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".compras")){const a=document.querySelector("#proveedor"),r=document.querySelector("#inputimpuesto"),i=document.querySelector("#nfactura"),c=document.querySelector("#fecha"),d=document.querySelector("#origenPago"),l=document.querySelector("#origenCaja"),s=document.querySelector("#origenBanco"),u=document.querySelector("#formapago"),m=document.querySelector("#observacion"),p=document.querySelector("#btnvaciar"),v=document.querySelector("#miDialogoVaciar"),g=document.querySelector("#miDialogoRegistrarcompra"),f=document.querySelector("#tablaCompras tbody");let y,h=[],S=[];function t(){document.querySelector("#impuesto").textContent="% "+r.value,document.querySelector("#total").textContent="$ "+h.reduce((e,t)=>t.valorcompra+e,0).toLocaleString()}function o(){for(h.length=0;null==f?void 0:f.firstChild;)f.removeChild(null==f?void 0:f.firstChild);document.querySelector("#impuesto").textContent="% 0",document.querySelector("#total").textContent="$ 0"}function n(e){const t=e.target;(t===v||t===g||t.closest(".novaciar")||t.closest(".sivaciar")||t.closest(".nocomprar")||t.closest(".sicomprar"))&&(v.close(),g.close(),document.removeEventListener("click",n),t.closest(".sicomprar")&&(h.some(e=>Number.isNaN(e.valorcompra)||0==e.valorcompra)?msjalertToast("error","¡Error!","Verifica el valor de compra de la lista de productos"):function(e){__awaiter(this,void 0,void 0,(function*(){var t;const n=new FormData;n.append("idproveedor",a.options[a.selectedIndex].value),n.append("idformapago",u.options[u.selectedIndex].value),n.append("idorigencaja",l.options[l.selectedIndex].value),n.append("idorigenbanco",s.options[s.selectedIndex].value),n.append("nombreproveedor",a.options[a.selectedIndex].textContent),n.append("formapago",u.options[u.selectedIndex].text),n.append("nfactura",i.value),n.append("impuesto",r.value),n.append("origenpago",d.options[d.selectedIndex].value),n.append("nombreorigenpago",d.options[d.selectedIndex].textContent+""),n.append("nombreorigencaja",l.options[l.selectedIndex].textContent+""),n.append("nombreorigenbanco",s.options[s.selectedIndex].value?s.options[s.selectedIndex].textContent+"":""),n.append("cantidaditems",h.reduce((e,t)=>t.cantidad+e,0)+""),n.append("observacion",m.value),n.append("estado",e),n.append("subtotal",h.reduce((e,t)=>t.valorcompra+e,0)+""),n.append("valortotal",h.reduce((e,t)=>t.valorcompra+e,0)+""),n.append("fechacompra",c.value),n.append("carrito",JSON.stringify(h)),n.append("subID",JSON.stringify(h.map(e=>{if(e.idsx)return e.idsx})));try{const e="/admin/api/registrarCompra",a=yield fetch(e,{method:"POST",body:n}),r=yield a.json();void 0!==r.exito?(msjalertToast("success","¡Éxito!",r.exito[0]),o(),null===(t=document.querySelector("#formComprar"))||void 0===t||t.reset()):msjalertToast("error","¡Error!",r.error[0])}catch(e){console.log(e)}}))}("paga")),t.closest(".sivaciar")&&o())}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",t=yield fetch(e);S=yield t.json(),console.log(S)}catch(e){console.log(e)}})),__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/totalitems",t=yield fetch(e),o=yield t.json();y=o.map(e=>{var t;return{id:e.id,text:e.nombre,tipo:null!==(t=e.tipoproducto)&&void 0!==t?t:"1",sku:e.sku,unidadmedida:e.unidadmedida}}),function(e){$("#articulo").select2({data:e,placeholder:"Selecciona un item",maximumSelectionLength:1})}(y)}catch(e){console.log(e)}})),null==r||r.addEventListener("input",()=>t()),d.addEventListener("change",e=>{var t,o,n,a;"0"==e.target.value?(null===(t=document.querySelector("#divBanco"))||void 0===t||t.classList.add("hidden"),null===(o=document.querySelector("#divBanco"))||void 0===o||o.removeAttribute("required")):(null===(n=document.querySelector("#divBanco"))||void 0===n||n.classList.remove("hidden"),null===(a=document.querySelector("#divBanco"))||void 0===a||a.setAttribute("required",""))}),$("#articulo").on("change",e=>{let t=$("#articulo").select2("data")[0];if(t){if(-1==h.findIndex(e=>e.iditem==t.id&&e.tipo==t.tipo)){const e=y.find(e=>e.id==t.id&&e.tipo==t.tipo),o={iditem:null==e?void 0:e.id,idpx:"0"==e.tipo?e.id:"NULL",idsx:"1"==e.tipo?e.id:"NULL",tipo:e.tipo,nombreitem:e.text,unidad:e.unidadmedida,cantidad:1,cantidadcomprado:1,factor:1,impuesto:0,valorunidad:0,subtotal:0,precio_compra:0,valorcompra:0};h=[...h,o],function(e,t,o){let n=`<option data-factor="1" value="" >${o}</option>`;const a=y.find(o=>o.id==e&&o.tipo==t);if("1"==t){n="";S.filter(t=>t.idsubproducto==e).forEach(e=>n+=`<option data-factor="${e.factorconversion}" value="${e.idsubproducto}" >${e.nombreunidaddestino}</option>`)}if("0"==t){n="";S.filter(t=>t.idproducto==e).forEach(e=>n+=`<option data-factor="${e.factorconversion}" value="${e.idproducto}" >${e.nombreunidaddestino}</option>`)}const r=document.createElement("TR");r.classList.add("itemselect"),r.dataset.id=""+e,r.dataset.tipo=""+t,r.insertAdjacentHTML("afterbegin",`<td class="!px-0 !py-2 text-xl text-gray-500 leading-5">${null==a?void 0:a.text}</td> \n            <td class="!p-2 text-xl text-gray-500 leading-5">\n                <select class="formulario__select selectunidad">\n                    ${n}  \n                </select>\n            </td>\n            <td class="!px-0 !py-2"><div class="flex"><button type="button"><span class="menos material-symbols-outlined">remove</span></button><input type="text" class="inputcantidad w-20 px-2 text-center" value="1" oninput="this.value = parseInt(this.value.replace(/[,.]/g, '')||1)"><button type="button"><span class="mas material-symbols-outlined">add</span></button></div></td>\n            <td class="!p-2 text-xl text-gray-500 leading-5"><input type="text" placeholder="Ingresa Valor Total Producto" class="inputcompra text-base sm:text-lg md:text-xl lg:text-2xl placeholder:text-sm sm:placeholder:text-base md:placeholder:text-lg lg:placeholder:text-xl bg-gray-50 border border-gray-300 text-gray-900 rounded-lg focus:border-indigo-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white h-14 focus:outline-none focus:ring-1" value="" oninput="this.value = parseInt(this.value.replace(/[,.]/g, '')||0)"></td>\n            <td class="accionestd"><div class="acciones-btns"><button class="btn-md btn-red eliminarItem"><i class="fa-solid fa-trash-can"></i></button></div></td>`),null==f||f.appendChild(r)}(t.id,t.tipo,t.unidadmedida)}}}),null==f||f.addEventListener("click",e=>{var o,n,a,r,i;const c=null===(o=e.target)||void 0===o?void 0:o.closest(".itemselect"),d=c.dataset.id,l=c.dataset.tipo,s=h.find(e=>e.iditem==d&&e.tipo==l);e.target.classList.contains("selectunidad")&&"eventSelect"!=e.target.dataset.event&&(null===(n=e.target)||void 0===n||n.addEventListener("change",e=>{const t=e.target;s.factor=Number(t.options[t.selectedIndex].dataset.factor)}),e.target.dataset.event="eventSelect"),e.target.classList.contains("menos")&&(s.cantidadcomprado--,s.cantidadcomprado<0&&(s.cantidadcomprado=0)),e.target.classList.contains("inputcantidad")&&"eventInput"!=e.target.dataset.event&&(null===(a=e.target)||void 0===a||a.addEventListener("input",e=>{s.cantidadcomprado=Number(e.target.value),s.cantidad=s.cantidadcomprado*s.factor}),e.target.dataset.event="eventInput"),e.target.classList.contains("mas")&&s.cantidadcomprado++,(null==f?void 0:f.querySelector(`TR[data-id="${d}"][data-tipo="${l}"] .inputcantidad`)).value=(null==s?void 0:s.cantidadcomprado)+"",e.target.classList.contains("inputcompra")&&"eventInput"!=e.target.dataset.event&&(null===(r=e.target)||void 0===r||r.addEventListener("input",e=>{s.valorcompra=Number(e.target.value),s.precio_compra=s.valorcompra/s.cantidad,t()}),e.target.dataset.event="eventInput"),(e.target.classList.contains("eliminarItem")||"I"==e.target.tagName)&&(h=h.filter(e=>e.iditem!=d||e.tipo!=l),null===(i=null==f?void 0:f.querySelector(`TR[data-id="${d}"][data-tipo="${l}"]`))||void 0===i||i.remove(),t()),s.cantidad=s.cantidadcomprado*s.factor}),null==p||p.addEventListener("click",()=>{h.length&&(v.showModal(),document.addEventListener("click",n))}),null===(e=document.querySelector("#formComprar"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault(),g.showModal(),document.addEventListener("click",n)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".ensamblaje")){const n=document.querySelector(".listaSubproductos"),a=document.querySelector("#unidadmedida");let r=document.querySelector("#cantidad"),i=[],c=0;function o(){var e;const t=null===(e=a.options[a.selectedIndex])||void 0===e?void 0:e.value,o=i.find(e=>e.id==t);c=Number(null==o?void 0:o.factorconversion)}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",t=yield fetch(e);i=yield t.json()}catch(e){console.log(e)}})),$("#subproducto").select2({maximumSelectionLength:1}),$("#subproducto").on("change",e=>{const t=e.target.value;!function(e){for(;null==a?void 0:a.firstChild;)a.removeChild(null==a?void 0:a.firstChild);e.forEach(e=>{const t=document.createElement("option");t.textContent=e.nombreunidaddestino,t.value=e.id,a.appendChild(t)}),o()}(i.filter(e=>e.idsubproducto==t))}),a.addEventListener("change",o),document.querySelector("#cantidad").addEventListener("input",e=>{o()}),null===(e=document.querySelector("#rendimientoestandar"))||void 0===e||e.addEventListener("input",e=>{const t=e.target;__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",document.querySelector("#idproducto").value),e.append("rendimientoestandar",t.value);try{const o="/admin/api/setrendimientoestandar",n=yield fetch(o,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(t.style.color="#02db02",t.style.fontWeight="500"):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))}),null===(t=document.querySelector("#formAddSubproducto"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault();const t=$("#subproducto").find("option:selected"),o=$("#unidadmedida").find("option:selected").text();let a=c*Number(r.value);__awaiter(void 0,void 0,void 0,(function*(){var e;const i=new FormData;i.append("id_producto",document.querySelector("#idproducto").value),i.append("id_subproducto",$("#subproducto").val()),i.append("cantidadsubproducto",a.toString()),i.append("costo",Number(t.data("costo"))*a+"");try{const a="/admin/api/ensamblar",c=yield fetch(a,{method:"POST",body:i}),d=yield c.json();void 0!==d.exito?(msjalertToast("success","¡Éxito!",d.exito[0]),function(e,t,o){const a=document.querySelector(`.listaSubproductos div[id="${e}"]`);a?a.querySelector("strong").textContent=r.value+" "+t:null==n||n.insertAdjacentHTML("beforeend",`\n                <div id="${e}" class="mb-4 flex items-center justify-between p-4 text-blue-600 bg-blue-100 rounded-lg shadow-md shadow-blue-500/30" role="alert">\n                    <p class="m-0"><strong>${r.value} ${t}</strong>.  ${o}</p>\n                    <button type="button"><span id="${e}" class="material-symbols-outlined">cancel</span></button>\n                </div>`)}($("#subproducto").val(),o,t.data("subproducto")),$("#subproducto").val([]).trigger("change"),null===(e=document.querySelector("#formAddSubproducto"))||void 0===e||e.reset()):msjalertToast("error","¡Error!",d.error[0])}catch(e){console.log(e)}}))}),null==n||n.addEventListener("click",e=>{const t=e.target;"SPAN"==t.tagName&&function(e,t){const o=document.querySelector(`.listaSubproductos div[id="${t}"]`);(()=>{__awaiter(this,void 0,void 0,(function*(){try{const n="/admin/api/desasociarsubproducto?idproducto="+e+"&idsubproducto="+t,a=yield fetch(n),r=yield a.json();void 0!==r.exito?(null==o||o.remove(),msjalertToast("success","¡Éxito!",r.exito[0])):msjalertToast("error","¡Error!",r.error[0])}catch(e){console.log(e)}}))})()}(document.querySelector("#idproducto").value,t.id)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gestionproveedores")){const n=document.querySelector("#crearProveedor"),a=document.querySelector("#miDialogoProveedor");let r,i,c=0,d=0,l=[];function o(e){e.target!==a&&"Salir"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allproveedores",t=yield fetch(e);l=yield t.json(),console.log(l)}catch(e){console.log(e)}})),r=$("#tablaProveedores").DataTable(configdatatables),n.addEventListener("click",()=>{d=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateProveedor"))||void 0===e||e.reset()}(),document.querySelector("#modalProveedor").textContent="Crear proveedor",document.querySelector("#btnEditarCrearProveedor").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaProveedores"))||void 0===e||e.addEventListener("click",e=>{var t,n,s;const u=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarProveedor"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarProveedor")))&&function(e){var t,n,s,u;let m=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(m=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);d=1,document.querySelector("#modalProveedor").textContent="Actualizar proveedor",document.querySelector("#btnEditarCrearProveedor").value="Actualizar",i=l.find(e=>e.id==m),document.querySelector("#nit").value=null==i?void 0:i.nit,document.querySelector("#nombreProveedor").value=null==i?void 0:i.nombre,c=r.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==u?void 0:u.classList.contains("eliminarProveedor"))||(null===(s=u.parentElement)||void 0===s?void 0:s.classList.contains("eliminarProveedor")))&&function(e){let t=e.target.parentElement.id,o=r.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);c=r.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el proveedor?",text:"el proveedor sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarProveedor",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(r.row(c).remove().draw(),r.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateProveedor"))||void 0===t||t.addEventListener("submit",e=>{let t="crearProveedor";d&&(t="actualizarProveedor"),e.preventDefault();var n=r.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==i?void 0:i.id)?null==i?void 0:i.id:""),e.append("nit",$("#nit").val()),e.append("nombre",$("#nombreProveedor").val());try{const s="/admin/api/"+t,u=yield fetch(s,{method:"POST",body:e}),m=yield u.json();if(void 0!==m.exito)if(a.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),d){l.forEach(e=>{e.id==(null==i?void 0:i.id)&&(e=Object.assign(e,m.proveedor[0]))});const e=r.row(c+=n.start).data();e[1]=m.proveedor[0].nit,e[2]=m.proveedor[0].nombre,r.row(c).data(e).draw(),r.page(n.page).draw("page")}else l=[...l,m.proveedor],r.row.add([r.rows().count()+1,m.proveedor.nit,m.proveedor.nombre,m.proveedor.created_at,`<div class="acciones-btns" id="${m.proveedor.id}" data-proveedor="${m.proveedor.nombre}">\n                          <button class="btn-md btn-turquoise editarProveedor"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarProveedor"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".productos")){const n=document.querySelector("#crearProducto"),a=document.querySelector("#miDialogoProducto"),r=document.querySelector("#btnXCerrarModalproducto"),i=document.querySelector("#upImage"),c=document.querySelector("#customUpImage"),d=document.querySelector("#imginputfile"),l=document.querySelector("#tipoproducto"),s=document.querySelector("#contentnuevosprecios");let u,m,p=0,v=0,g=[];__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allproducts",t=yield fetch(e);g=yield t.json(),console.log(g)}catch(e){console.log(e)}}));const f=document.querySelector(".divmsjalerta0");f&&borrarMsjAlert(f),null==l||l.addEventListener("change",e=>{var t,o,n,a;const r=e.target,i=document.querySelector(".preciocompra"),c=document.querySelector(".stock"),d=document.querySelector(".habtipoproduccion");"0"==r.value?(c.style.display="flex",i.style.display="flex",d.style.display="none",null===(t=document.querySelector("#preciocompra"))||void 0===t||t.setAttribute("required",""),null===(o=document.querySelector("#tipoproduccion"))||void 0===o||o.removeAttribute("required")):(c.style.display="none",i.style.display="none",d.style.display="flex",null===(n=document.querySelector("#preciocompra"))||void 0===n||n.removeAttribute("required"),null===(a=document.querySelector("#tipoproduccion"))||void 0===a||a.setAttribute("required",""))}),r.addEventListener("click",e=>{a.close(),document.removeEventListener("click",o)});const y=document.querySelector("#btnAddNewPrice");if(y){y.addEventListener("click",e=>{var t;let o=null===(t=e.target.previousElementSibling)||void 0===t?void 0:t.cloneNode(!0);o.removeAttribute("id"),o.value="",o.name="nuevosprecios[]",o.classList.add("nuevosprecios"),s.appendChild(o),console.log(o)})}function o(e){"salir"===e.target.value&&(a.close(),document.removeEventListener("click",o))}u=$("#tablaProductos").DataTable(configdatatables),null==n||n.addEventListener("click",e=>{for(v=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateProducto"))||void 0===e||e.reset(),d.src=""}();s.firstChild;)s.removeChild(s.firstChild);document.querySelector("#modalProducto").textContent="Crear producto",document.querySelector("#btnEditarCrearProducto").value="Crear",document.querySelector(".stock").style.display="block",document.querySelector(".preciocompra").style.display="block",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaProductos"))||void 0===e||e.addEventListener("click",e=>{var t,n,r,i;const c=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarProductos"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarProductos")))&&function(e){var t,n,r,i,c,l,f,y,h,S,b,x,w;let E=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(E=null===(i=null===(r=e.target.parentElement)||void 0===r?void 0:r.parentElement)||void 0===i?void 0:i.id);v=1,document.querySelector("#modalProducto").textContent="Actualizar producto",document.querySelector("#btnEditarCrearProducto").value="Actualizar",m=g.find(e=>e.id===E),$("#categoria").val(null!==(c=null==m?void 0:m.idcategoria)&&void 0!==c?c:""),document.querySelector("#nombre").value=null==m?void 0:m.nombre,$("#tipoproducto").val(null!==(l=null==m?void 0:m.tipoproducto)&&void 0!==l?l:"0"),$("#idunidadmedida").val(null!==(f=null==m?void 0:m.idunidadmedida)&&void 0!==f?f:"1"),document.querySelector(".stock").style.display="block",document.querySelector(".preciocompra").style.display="block",document.querySelector(".habtipoproduccion").style.display="none","1"==(null==m?void 0:m.tipoproducto)&&(document.querySelector(".stock").style.display="none",document.querySelector(".preciocompra").style.display="none",document.querySelector(".habtipoproduccion").style.display="block",$("#tipoproduccion").val(m.tipoproduccion));document.querySelector("#stock").value=null!==(y=null==m?void 0:m.stock)&&void 0!==y?y:"",document.querySelector("#preciocompra").value=null!==(h=null==m?void 0:m.precio_compra)&&void 0!==h?h:"",document.querySelector("#precioventa").value=null!==(S=null==m?void 0:m.precio_venta)&&void 0!==S?S:"",function(e){for(;s.firstChild;)s.removeChild(s.firstChild);e.forEach(e=>{s.insertAdjacentHTML("afterbegin",`<input \n          data-id="${e.id}"\n          class="nuevosprecios bg-gray-50 border border-gray-300 text-gray-900 rounded-lg focus:border-indigo-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white h-14 text-xl focus:outline-none focus:ring-1"\n          type="number" \n          min="0" \n          step="0.01" \n          placeholder="Precio de venta incluido el impuesto" \n          name="nuevosprecios[]" \n          value="${e.precio}" \n          required>`)})}(m.preciosadicionales),document.querySelector("#sku").value=null!==(b=null==m?void 0:m.sku)&&void 0!==b?b:"",document.querySelector("#impuesto").value=null!==(x=null==m?void 0:m.impuesto)&&void 0!==x?x:"",document.querySelector("#stockminimo").value=null!==(w=null==m?void 0:m.stockminimo)&&void 0!==w?w:"",d.src="/build/img/"+(null==m?void 0:m.foto),p=u.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==c?void 0:c.classList.contains("bloquearProductos"))||(null===(r=c.parentElement)||void 0===r?void 0:r.classList.contains("bloquearProductos")))&&function(e){let t=e.target.parentElement,o=u.page.info();"SPAN"===e.target.tagName&&(t=e.target.parentElement.parentElement);p=u.row(e.target.closest("tr")).index(),(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t.id);try{const n="/admin/api/cambiarestadoproducto",a=yield fetch(n,{method:"POST",body:e}),r=yield a.json();if(void 0!==r.exito){const e=`<div class="acciones-btns my-[0.7rem]" id="${t.id}">\n                              ${1==r.tipoproducto[0]?`<a class="btn-xs btn-blue" title="Agregar Materia Prima" href="/admin/almacen/componer?id=${t.id}"><i class="fa-solid fa-subscript text-[17px] leading-none"></i></a>`:""}\n                              <button class="btn-xs btn-lima" title="Más opciones"><i class="fa-solid fa-circle-plus text-[17px] leading-none"></i></button>\n                              <button class="btn-xs btn-turquoise editarProductos" title="Actualizar Producto"><i class="fa-solid fa-pen-to-square text-[17px] leading-none"></i></button>\n                              <button class="btn-xs ${1==r.estado[0]?"btn-light":"btn-orange"} bloquearProductos" title="Bloquear Producto"><span class="material-symbols-outlined text-[18px] leading-none">hide_source</span></button>\n                              <button class="btn-xs btn-red eliminarProductos" title="Eliminar Producto"><i class="fa-solid fa-trash-can text-[17px] leading-none"></i></button>\n                            </div>`;u.cell(u.row(p+=o.start),7).data(e).draw(),u.page(o.page).draw("page"),msjalertToast("success","¡Éxito!",r.exito[0])}else Swal.fire(r.error[0],"","error")}catch(e){console.log(e)}}))})()}(e),((null==c?void 0:c.classList.contains("eliminarProductos"))||(null===(i=c.parentElement)||void 0===i?void 0:i.classList.contains("eliminarProductos")))&&function(e){let t=e.target.parentElement.id,o=u.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);p=u.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el prducto?",text:"El prducto sera eliminado definitivamente de todas las SEDES.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarProducto",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(u.row(p).remove().draw(),u.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateProducto"))||void 0===t||t.addEventListener("submit",e=>{var t;let n=document.querySelectorAll(".nuevosprecios");if(v){e.preventDefault();var r,i=u.page.info();if(r=m.foto,!d.src.includes(m.foto)&&(r=null===(t=e.target.elements.namedItem("upImage").files)||void 0===t?void 0:t[0])){if("image/png"!==r.type&&"image/jpeg"!==r.type)return void msjAlert("error","No es un formato valido para la foto",document.querySelector("#divmsjalerta1"));if(r.size>55e4)return void msjAlert("error","La imagen no debe superar los 500KB",document.querySelector("#divmsjalerta1"))}__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",m.id),e.append("idcategoria",$("#categoria").val()),e.append("nombre",$("#nombre").val()),e.append("foto",r),e.append("tipoproducto",$("#tipoproducto").val()),e.append("idunidadmedida",$("#idunidadmedida").val()),e.append("unidadmedida",$("#idunidadmedida option:selected").text()),e.append("stock",$("#stock").val()),e.append("precio_compra",$("#preciocompra").val()),e.append("precio_venta",$("#precioventa").val()),e.append("nuevosprecios",JSON.stringify(Array.from(n).map(e=>({id:e.dataset.id,precio:parseFloat(e.value)})).filter(e=>e.precio>0))),e.append("idprecionsadicionales",JSON.stringify(Array.from(n).filter(e=>e.dataset.id&&parseFloat(e.value)>0).map(e=>e.dataset.id))),e.append("sku",$("#sku").val()),e.append("tipoproduccion",null==$("#tipoproduccion").val()?"0":$("#tipoproduccion").val()),e.append("impuesto",$("#impuesto").val()),e.append("stockminimo",$("#stockminimo").val());try{const t="/admin/api/actualizarproducto",n=yield fetch(t,{method:"POST",body:e}),r=yield n.json();if(console.log(r),void 0!==r.exito){msjalertToast("success","¡Éxito!",r.exito[0]),g.forEach(e=>{e.id==m.id&&(e=Object.assign(e,r.producto[0]))});const e=u.row(p).data();e[1]=`<div class="text-center"><img class="inline" style="width: 50px;" src="/build/img/${r.producto[0].foto}" alt=""></div>`,e[2]='<div class="w-80 whitespace-normal">'+$("#nombre").val()+"</div>",e[3]=$("#categoria option:selected").text(),e[4]="",e[5]=$("#sku").val(),e[6]=$("#precioventa").val(),u.row(p).data(e).draw(),u.page(i.page).draw("page")}else msjalertToast("error","¡Error!",r.error[0]);a.close(),document.removeEventListener("click",o)}catch(e){console.log(e)}}))}}),null==c||c.addEventListener("click",()=>null==i?void 0:i.click()),null==i||i.addEventListener("change",(function(){var e;const t=null===(e=this.files)||void 0===e?void 0:e[0];if(t){const e=new FileReader;e.onload=function(){const t=e.result;"string"==typeof t&&(d.src=t)},e.readAsDataURL(t)}}))}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".solicitarinvnetario")){const t=document.getElementById("btnAnteriorSolicitudInv"),o=document.getElementById("btnSiguienteSolicitudInv"),n=document.querySelectorAll(".step-circle"),a=document.querySelectorAll(".step-section"),r=document.querySelector("#btnAddItem"),i=document.querySelector("#tablaItems tbody");let c,d=[],l=1;const s=3;__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/totalitems",t=yield fetch(e),o=yield t.json();c=o.map(e=>{var t;return{id:e.id,text:e.nombre,tipo:null!==(t=e.tipoproducto)&&void 0!==t?t:"1",sku:e.sku,unidadmedida:e.unidadmedida}}),function(e){$("#articulo").select2({width:"100%",data:e,placeholder:"Selecciona un item",maximumSelectionLength:1})}(c)}catch(e){console.log(e)}}));const u=document.getElementById("fecha"),m=new Date,p=m.getFullYear(),v=String(m.getMonth()+1).padStart(2,"0"),g=String(m.getDate()).padStart(2,"0");function e(){n.forEach((e,t)=>{const o=t+1;e.className=o<l?"step-circle w-10 h-10 rounded-full bg-green-500 text-white font-semibold flex items-center justify-center":o===l?"step-circle w-10 h-10 rounded-full bg-indigo-600 text-white font-semibold flex items-center justify-center":"step-circle w-10 h-10 rounded-full border-2 border-gray-300 text-gray-400 font-semibold flex items-center justify-center"}),a.forEach((e,t)=>{e.style.display=t+1===l?"block":"none"}),t.disabled=1===l,o.disabled=l===s}u.value=`${p}-${v}-${g}`,e(),o.addEventListener("click",()=>{if(l<s){if(l++,3===l&&0===d.length)return void l--;3===l&&d.length>0&&function(){const e=document.querySelector("#tablaproductosresumen tbody");for(;null==e?void 0:e.firstChild;)e.removeChild(e.firstChild);d.forEach(t=>{const o=document.createElement("tr"),n=document.createElement("td");n.textContent=t.nombreitem,null==o||o.appendChild(n);const a=document.createElement("td");a.textContent=t.cantidad+"",null==o||o.appendChild(a);const r=document.createElement("td");r.textContent=t.unidad,null==o||o.appendChild(r),null==e||e.appendChild(o)})}(),e()}}),t.addEventListener("click",()=>{l>1&&(l--,e())}),r.addEventListener("click",e=>{let t=parseFloat(document.querySelector("#cantidad").value),o=$("#articulo").select2("data")[0];if(console.log(o),o){const e=d.findIndex(e=>e.iditem==o.id&&e.tipo==o.tipo);if(-1==e){const e=c.find(e=>e.id==o.id&&e.tipo==o.tipo),n={iditem:null==e?void 0:e.id,idpx:"0"==e.tipo?e.id:"NULL",idsx:"1"==e.tipo?e.id:"NULL",tipo:e.tipo,nombreitem:e.text,unidad:e.unidadmedida,cantidad:t,factor:1,impuesto:0,valorunidad:0,subtotal:0,precio_compra:0,valorcompra:0};d=[...d,n],function(e,t,o,n){const a=c.find(o=>o.id==e&&o.tipo==t),r=document.createElement("TR");r.classList.add("itemselect"),r.dataset.id=""+e,r.dataset.tipo=""+t,r.insertAdjacentHTML("afterbegin",`<td class="p-4">${null==a?void 0:a.text}</td>\n                <td class="p-4">${n}</td>\n                <td class="p-4 flex items-center justify-center gap-2">\n                    <button class="flex items-center gap-1 px-3 py-1 text-base text-indigo-600 border border-indigo-200 rounded-lg hover:bg-indigo-50">\n                        👁 Ver\n                    </button>\n                    <button class="w-11 h-11 flex items-center justify-center text-green-600 border border-green-200 rounded-full hover:bg-green-50 text-xl">✅</button>\n                    <button class="eliminarItem w-11 h-11 flex items-center justify-center text-rose-600 border border-rose-200 rounded-full hover:bg-rose-50 text-xl">❌</button>\n                </td>`),null==i||i.appendChild(r)}(o.id,o.tipo,o.unidadmedida,t)}else{d[e].cantidad=t;document.querySelector(`[data-id="${d[e].iditem}"][data-tipo="${d[e].tipo}"]`).children[1].textContent=d[e].cantidad+""}}}),null==i||i.addEventListener("click",e=>{var t,o;const n=null===(t=e.target)||void 0===t?void 0:t.closest(".itemselect"),a=n.dataset.id,r=n.dataset.tipo;d.find(e=>e.iditem==a&&e.tipo==r);e.target.classList.contains("eliminarItem")&&(d=d.filter(e=>e.iditem!=a||e.tipo!=r),null===(o=null==i?void 0:i.querySelector(`TR[data-id="${a}"][data-tipo="${r}"]`))||void 0===o||o.remove())})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".subproductos")){const n=document.querySelector("#crearSubProducto"),a=document.querySelector("#miDialogoSubProducto");let r,i,c=0,d=0,l=[];function o(e){e.target!==a&&"salir"!==e.target.value&&"Actualizar"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allsubproducts",t=yield fetch(e);l=yield t.json(),console.log(l)}catch(e){console.log(e)}})),r=$("#tablaSubProductos").DataTable(configdatatables),null==n||n.addEventListener("click",e=>{d=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateSubProducto"))||void 0===e||e.reset(),document.querySelector("#formCrearUpdateSubProducto").action="/admin/almacen/crear_subproducto"}(),document.querySelector("#modalSubProducto").textContent="Crear sub producto",document.querySelector("#btnEditarCrearSubProducto").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaSubProductos"))||void 0===e||e.addEventListener("click",e=>{var t,n;const s=e.target;((null==s?void 0:s.classList.contains("editarSubProductos"))||(null===(t=s.parentElement)||void 0===t?void 0:t.classList.contains("editarSubProductos")))&&function(e){var t,n,s,u,m,p,v;let g=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(g=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);d=1,document.querySelector("#modalSubProducto").textContent="Actualizar producto",document.querySelector("#btnEditarCrearSubProducto").value="Actualizar",i=l.find(e=>e.id===g),$("#unidadmedida").val(null!==(m=null==i?void 0:i.id_unidadmedida)&&void 0!==m?m:""),document.querySelector("#nombre").value=null==i?void 0:i.nombre,document.querySelector("#sku").value=null==i?void 0:i.sku,document.querySelector("#preciocompra").value=null!==(p=null==i?void 0:i.precio_compra)&&void 0!==p?p:"",document.querySelector("#stockminimo").value=null!==(v=null==i?void 0:i.stockminimo)&&void 0!==v?v:"",c=r.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==s?void 0:s.classList.contains("eliminarSubProductos"))||(null===(n=s.parentElement)||void 0===n?void 0:n.classList.contains("eliminarSubProductos")))&&function(e){let t=e.target.parentElement.id,o=r.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);c=r.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el sub prducto?",text:"El sub prducto sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarSubProducto",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(r.row(c).remove().draw(),r.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateSubProducto"))||void 0===t||t.addEventListener("submit",e=>{if(d){e.preventDefault();var t=r.page.info();__awaiter(void 0,void 0,void 0,(function*(){var e;const n=new FormData;n.append("id",i.id),n.append("id_unidadmedida",$("#unidadmedida").val()),n.append("unidadmedida",$("#unidadmedida").find("option:selected").text()),n.append("nombre",$("#nombre").val()),n.append("sku",$("#sku").val()),n.append("precio_compra",$("#preciocompra").val()),n.append("stockminimo",$("#stockminimo").val());try{const a="/admin/api/actualizarsubproducto",d=yield fetch(a,{method:"POST",body:n}),s=yield d.json();if(console.log(s),void 0!==s.exito){msjalertToast("success","¡Éxito!",s.exito[0]),l.forEach(e=>{e.id==i.id&&(e=Object.assign(e,s.subproducto[0]))});const o=r.row(c+=t.start).data();o[1]='<div class="w-80 whitespace-normal">'+$("#nombre").val()+"</div>",o[2]="",o[3]=$("#sku").val(),o[4]=$("#unidadmedida option:selected").text(),o[5]="$"+(null===(e=Number($("#preciocompra").val()))||void 0===e?void 0:e.toLocaleString()),r.row(c).data(o).draw(),r.page(t.page).draw("page")}else msjalertToast("error","¡Error!",s.error[0]);document.addEventListener("click",o)}catch(e){console.log(e)}}))}})}})(),(()=>{var e;if(document.querySelector(".unidadesmedida")){const o=document.querySelector("#btnCrearUnidadMedida"),n=document.querySelector("#miDialogoUnidadMedida");let a;function t(e){const o=e.target;o!==n&&"Salir"!==o.value&&"Actualizar"!==o.value||(n.close(),document.removeEventListener("click",t))}a=$("#tablaUnidadesMedida").DataTable(configdatatables),null==o||o.addEventListener("click",e=>{!function(){var e;null===(e=document.querySelector("#formCrearUpdateUnidad"))||void 0===e||e.reset(),document.querySelector("#formCrearUpdateUnidad").action="/admin/almacen/crear_unidadmedida"}(),document.querySelector("#modalUnidadMedida").textContent="Crear unidad de medida",document.querySelector("#btnEditarCrearUnidadMedida").value="Crear",n.showModal(),document.addEventListener("click",t)}),null===(e=document.querySelector("#tablaUnidadesMedida"))||void 0===e||e.addEventListener("click",e=>{var o,a,r=e.target;((null==r?void 0:r.classList.contains("editarUnidadMedida"))||(null===(o=r.parentElement)||void 0===o?void 0:o.classList.contains("editarUnidadMedida")))&&function(e){var o,a,r,i,c;let d=null===(o=e.target.parentElement)||void 0===o?void 0:o.id;"I"===(null===(a=e.target)||void 0===a?void 0:a.tagName)&&(d=null===(i=null===(r=e.target.parentElement)||void 0===r?void 0:r.parentElement)||void 0===i?void 0:i.id);document.querySelector("#formCrearUpdateUnidad").action="/admin/almacen/editarunidademedida",document.querySelector("#modalUnidadMedida").textContent="Actualizar unidad de medida",document.querySelector("#btnEditarCrearUnidadMedida").value="Actualizar",document.querySelector("#idunidadmedida").value=d,document.querySelector("#unidad").value=null===(c=e.target.closest(".acciones-btns"))||void 0===c?void 0:c.dataset.unidadmedida,n.showModal(),document.addEventListener("click",t)}(e),((null==r?void 0:r.classList.contains("eliminarUnidadMedida"))||(null===(a=r.parentElement)||void 0===a?void 0:a.classList.contains("eliminarUnidadMedida")))&&function(e){let t=e.target.parentElement;"I"===e.target.tagName&&(t=t.parentElement);Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la unidad de medida?",text:"La unidad de medida sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&t.submit()})}(e)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".caja")){const a=document.querySelector("#gastosIngresos"),r=document.querySelector("#cambioMedioPago"),i=document.querySelector("#btnGastosingresos"),c=document.querySelector("#operacion"),d=document.querySelectorAll('input[name="origengasto"]'),l=document.querySelectorAll(".mediopago"),s=document.querySelector("#totalPagado"),u=document.querySelector("#numfactura");let m,p,v,g,f="0",y=[];const h=new Set,S=new Map;function o(){var e,t,o,n,a,r;const i=document.querySelector('input[name="origengasto"]:checked');"gastocaja"==(null==i?void 0:i.id)?(null===(e=document.querySelector("#showcajas"))||void 0===e||e.classList.remove("hidden"),null===(t=document.querySelector("#showcajas"))||void 0===t||t.setAttribute("required",""),null===(o=document.querySelector("#showbancos"))||void 0===o||o.classList.add("hidden"),null===(n=document.querySelector("#showbancos"))||void 0===n||n.removeAttribute("required")):(null===(a=document.querySelector("#showbancos"))||void 0===a||a.classList.remove("hidden"),null===(r=document.querySelector("#showbancos"))||void 0===r||r.setAttribute("required",""))}function n(e){e.target!==a&&e.target!==r&&"cancelar"!==e.target.value||(a.close(),r.close(),document.removeEventListener("click",n))}m=$("#tablaListaPedidos").DataTable(configdatatablescaja),null==i||i.addEventListener("click",()=>{a.showModal(),document.addEventListener("click",n)}),null==c||c.addEventListener("change",e=>{var t,n,a,r,i,c,d,l;const s=e.target,u=document.querySelector(".tipodegasto");"gasto"==s.value?(u.style.display="flex",null===(t=document.querySelector("#tipodegasto"))||void 0===t||t.setAttribute("required",""),null===(n=document.querySelector("#origengasto"))||void 0===n||n.classList.remove("hidden"),null===(a=document.querySelector("#origengasto"))||void 0===a||a.classList.add("flex"),o()):(u.style.display="none",null===(r=document.querySelector("#tipodegasto"))||void 0===r||r.removeAttribute("required"),null===(i=document.querySelector("#origengasto"))||void 0===i||i.classList.add("hidden"),null===(c=document.querySelector("#origengasto"))||void 0===c||c.classList.remove("flex"),null===(d=document.querySelector("#showcajas"))||void 0===d||d.classList.remove("hidden"),null===(l=document.querySelector("#showbancos"))||void 0===l||l.classList.add("hidden"))}),d.forEach(e=>e.addEventListener("click",o)),null===(e=document.querySelector("#tablaListaPedidos"))||void 0===e||e.addEventListener("click",e=>{var t,o,a;const i=e.target;((null==i?void 0:i.classList.contains("mediosdepago"))||(null===(t=i.parentElement)||void 0===t?void 0:t.classList.contains("mediosdepago")))&&function(e){var t,o,a,i,c,d,m;f=e.id,v=e,p=null!==(t=e.dataset.estado)&&void 0!==t?t:"",s.textContent=Number(null!==(o=e.dataset.totalpagado)&&void 0!==o?o:"0").toLocaleString(),"BUTTON"==e.tagName&&(f=e.parentElement.id,v=e.parentElement,p=null!==(i=null===(a=e.parentElement)||void 0===a?void 0:a.dataset.estado)&&void 0!==i?i:"",s.textContent=Number(null!==(c=e.parentElement.dataset.totalpagado)&&void 0!==c?c:"0").toLocaleString());(function(){u.textContent="Factura N° : "+f,(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/mediospagoXfactura?id="+f,t=yield fetch(e);g=yield t.json(),console.log(g),g.forEach(e=>h.add(e.idmediopago)),l.forEach(e=>{e.value="0";for(let t=0;t<g.length;t++)if(e.id==g[t].idmediopago){e.value=Number(g[t].valor).toLocaleString(),S.set(e.id,Number(g[t].valor));break}})}catch(e){console.log(e)}}))})()})(),"Eliminada"==p&&(null===(d=document.querySelector("#btnEnviarCambioMedioPago"))||void 0===d||d.classList.add("!hidden"));"Paga"==p&&(null===(m=document.querySelector("#btnEnviarCambioMedioPago"))||void 0===m||m.classList.remove("!hidden"));r.showModal(),document.addEventListener("click",n)}(i),((null==i?void 0:i.classList.contains("printPOS"))||(null===(o=i.parentElement)||void 0===o?void 0:o.classList.contains("printPOS")))&&function(e){let t=e.parentElement.id;"I"===e.tagName&&(t=e.parentElement.parentElement.id);window.open("/admin/printPDFPOS?id="+t,"_blank")}(i),((null==i?void 0:i.classList.contains("printPDF"))||(null===(a=i.parentElement)||void 0===a?void 0:a.classList.contains("printPDF")))&&function(e){var t,o;let n=e.parentElement.id,a=null===(t=e.parentElement)||void 0===t?void 0:t.dataset.cotizacion,r="/printfacturacarta?id=";"I"===e.tagName&&(n=e.parentElement.parentElement.id,a=null===(o=e.parentElement.parentElement)||void 0===o?void 0:o.dataset.cotizacion);"1"===a&&(r="/printcotizacion?id=");const i=window.open(r+n,"_blank");i&&(i.onload=()=>{null==i||i.focus(),null==i||i.print(),setTimeout(()=>{null==i||i.close()},200)})}(i)}),l.forEach(e=>{e.addEventListener("input",e=>{let t=0;l.forEach((e,o)=>{t+=parseInt(e.value.replace(/[,.]/g,""))}),t<=parseInt(s.textContent.replace(/[,.]/g,""))?(S.set(e.target.id,parseInt(e.target.value.replace(/[,.]/g,""))),document.querySelector("#diferencia").textContent=(parseInt(s.textContent.replace(/[,.]/g,""))-t).toLocaleString()):S.has(e.target.id)?e.target.value=S.get(e.target.id).toLocaleString():e.target.value="0"})}),null===(t=document.querySelector("#formCambioMedioPago"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault();let t=0;y.length=0,l.forEach((e,o)=>{t+=parseInt(e.value.replace(/[,.]/g,"")),"0"!=e.value&&(y=[...y,{idmediopago:e.id,valor:e.value.replace(/[,.]/g,"")}])}),t==parseInt(s.textContent.replace(/[,.]/g,""))?function(){__awaiter(this,void 0,void 0,(function*(){var e,t,o,a;const i=new Set(y.map(e=>e.idmediopago)),c=g.filter(e=>i.has(e.idmediopago)),d=y.filter(e=>!h.has(e.idmediopago)),l=g.filter(e=>!i.has(e.idmediopago)),s=new FormData;s.append("id_factura",f),s.append("efectivoDB",null!==(t=null===(e=g.find(e=>"1"==e.idmediopago))||void 0===e?void 0:e.valor)&&void 0!==t?t:"0"),s.append("nuevoEfectivo",null!==(a=null===(o=y.find(e=>"1"==e.idmediopago))||void 0===o?void 0:o.valor)&&void 0!==a?a:"0"),s.append("mediospagocompartidos",JSON.stringify(c)),s.append("nuevosMediosPagoNoEnDB",JSON.stringify(d)),s.append("mediosPagoDBNoEnNuevos",JSON.stringify(l)),s.append("nuevosMediosPago",JSON.stringify(y));try{const e="/admin/api/cambioMedioPago",t=yield fetch(e,{method:"POST",body:s}),o=yield t.json();void 0!==o.exito?(msjalertToast("success","¡Éxito!",o.exito[0]),function(e){for(;v.firstChild;)v.removeChild(v.firstChild);e.forEach(e=>{const t=document.createElement("button");t.classList.add("btn-xs","btn-light","mr-2"),t.textContent=e.mediopago,v.appendChild(t)})}(o.mediosPagoUpdate)):msjalertToast("error","¡Error!",o.error[0])}catch(e){console.log(e)}r.close(),document.removeEventListener("click",n)}))}():msjAlert("error","Valor diferente al pagado",document.querySelector("#divmsjalerta2"))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".cerrarcaja")){const o=document.querySelector("#modalArqueocaja"),n=document.querySelector("#Modalcerrarcaja"),a=document.querySelector("#modalCambiarCaja"),r=document.querySelector("#btnArqueocaja"),i=document.querySelector("#btnCerrarcaja"),c=document.querySelector("#btnImprimirDetalleCaja"),d=document.querySelector("#btnCambiarCaja"),l=document.querySelectorAll(".inputmediopago"),s=document.querySelector("#formArqueocaja"),u=document.querySelector("#formCambiarCaja");null==r||r.addEventListener("click",()=>{o.showModal(),document.addEventListener("click",t)}),null==i||i.addEventListener("click",()=>{n.showModal(),document.addEventListener("click",t)}),null==d||d.addEventListener("click",()=>{a.showModal(),document.addEventListener("click",t)}),null==s||s.addEventListener("submit",e=>{var n;e.preventDefault(),function(){const e=document.querySelector("#Efectivo"),t=Array.from(document.querySelectorAll(".denominacion")).reduce((e,t)=>Number(t.dataset.moneda)*Number(t.value)+e,0);e.value=t+"";const o=new Event("input");e.dispatchEvent(o)}();const a=new FormData(s);a.append("idcierrecaja",null===(n=document.querySelector("#idCierrecaja"))||void 0===n?void 0:n.textContent),__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/arqueocaja",n=yield fetch(e,{method:"POST",body:a}),r=yield n.json();void 0!==r.exito?(o.close(),document.removeEventListener("click",t),msjalertToast("success","¡Éxito!",r.exito[0])):msjalertToast("error","¡Error!",r.error[0])}catch(e){console.log(e)}}))}),l.forEach(e=>{e.addEventListener("input",e=>{const t=e.target,o=parseInt(e.target.value.replace(/[,.]/g,""));__awaiter(void 0,void 0,void 0,(function*(){var e;const n=new FormData;n.append("id_mediopago",t.dataset.idmediopago+""),n.append("nombremediopago",t.name),n.append("valordeclarado",o+""),n.append("idcierrecaja",null===(e=document.querySelector("#idCierrecaja"))||void 0===e?void 0:e.textContent);try{const e="/admin/api/declaracionDinero",a=yield fetch(e,{method:"POST",body:n}),r=yield a.json();void 0!==r.exito?(t.style.color="#02db02",t.style.fontWeight="500",function(e,t,o){var n,a;const r=document.querySelector(`.coldeclarado[data-mediopagoid="${e}"]`);if(r){const e=r.nextElementSibling;r.textContent=Number(t).toLocaleString("es-ES",{useGrouping:!0});const o=null===(a=null===(n=r.previousElementSibling)||void 0===n?void 0:n.textContent)||void 0===a?void 0:a.replace(/[.,]/g,"");e.textContent=(Number(t)-Number(o)).toLocaleString("es-ES",{useGrouping:!0})}else{const n=document.querySelector(".cuerpoanalisis");null==n||n.insertAdjacentHTML("beforeend",`\n          <tr class="${"Efectivo"==o?"!border-2 !border-indigo-600":""}">\n            <td class="">${o}</td> \n            <td class="colsistem">0</td>\n            <td class="coldeclarado" data-mediopagoid="${e}">${Number(t).toLocaleString("es-ES",{useGrouping:!0})}</td>\n            <td class="coldif">${Number(t).toLocaleString("es-ES",{useGrouping:!0})}</td>\n          </tr>`)}}(t.dataset.idmediopago,o+"",t.name)):msjalertToast("error","¡Error!",r.error[0])}catch(e){console.log(e)}}))})});const m=null===(e=document.querySelector("#idCierrecaja"))||void 0===e?void 0:e.textContent;function t(e){(e.target===o||e.target===n||e.target===a||"Cancelar"===e.target.value||e.target.closest(".salircerrarcaja")||e.target.closest(".finCerrarcaja"))&&(o.close(),n.close(),a.close(),document.removeEventListener("click",t),e.target.closest(".finCerrarcaja")&&function(){var e;const o=new FormData;o.append("idcierrecaja",null===(e=document.querySelector("#idCierrecaja"))||void 0===e?void 0:e.textContent),document.querySelector(".content-spinner1").style.display="grid",n.close(),document.removeEventListener("click",t),(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/cierrecajaconfirmado",t=yield fetch(e,{method:"POST",body:o}),n=yield t.json();void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),setTimeout(()=>{document.querySelector(".content-spinner1").style.display="none",window.location.href="/admin/caja/detallecierrecaja?id="+n.ultimocierre[0]},1600)):(document.querySelector(".content-spinner1").style.display="none",msjalertToast("error","¡Error!",n.error[0]))}catch(e){console.log(e)}}))})()}())}null==c||c.addEventListener("click",()=>{const e=window.open("/printdetallecierre?id="+m,"_blank");e&&(e.onload=()=>{null==e||e.focus(),null==e||e.print(),setTimeout(()=>{null==e||e.close()},200)})}),null==u||u.addEventListener("submit",e=>{e.preventDefault();const o=new FormData;o.append("idcaja",$("#CambiarCaja").val()),__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/datoscajaseleccionada",n=yield fetch(e,{method:"POST",body:o}),r=yield n.json();void 0!==r.exito?(a.close(),document.removeEventListener("click",t),console.log(r),document.querySelector("#nombreCaja").textContent=$("#CambiarCaja option:selected").text(),document.querySelector("#idCierrecaja").textContent=r.ultimocierre.id,function(e){const t=document.querySelector("#tablaMediosPago tbody");for(;t.firstChild;)t.removeChild(t.firstChild);e.forEach(e=>{const o=document.createElement("tr");o.innerHTML=`<td class="">${e.mediopago}</td> \n                        <td class=""><strong>$ </strong>${Number(e.valor).toLocaleString()}</td>\n                      `,t.appendChild(o)})}(r.discriminarmediospagos),function(e){const t=Number(e.basecaja),o=Number(e.ventasenefectivo),n=Number(e.gastoscaja),a=Number(e.domicilios),r=Number(e.ingresoventas),i=Number(e.totaldescuentos);document.querySelector("#basecajaResumen").textContent="$"+t.toLocaleString(),document.querySelector("#gastoscajaResumen").textContent="$"+n.toLocaleString(),document.querySelector("#domiciliosResumen").textContent="$"+a.toLocaleString(),document.querySelector("#ingresoventasResumen").textContent="$"+r.toLocaleString(),document.querySelector("#totalfacturasResumen").textContent=e.totalfacturas,document.querySelector("#totalcotizacionesResumen").textContent=e.totalcotizaciones,document.querySelector("#baseIngresoCaja").textContent="+ $"+t.toLocaleString(),document.querySelector("#ventasEfectivo").textContent="+ $"+o.toLocaleString(),document.querySelector("#gastosCaja").textContent="- $"+n.toLocaleString(),document.querySelector("#dineroCaja").textContent="= $"+(t+o-n).toLocaleString(),document.querySelector("#domicilios").textContent="- $"+a.toLocaleString(),document.querySelector("#realCaja").textContent="= $"+(t+o-n-a).toLocaleString(),document.querySelector("#ingresoVentasTotal").textContent="+ $"+r.toLocaleString(),document.querySelector("#totalGastosCaja").textContent="- $"+n.toLocaleString(),document.querySelector("#totalDescuentos").textContent="- $"+i.toLocaleString(),document.querySelector("#totalDomicilios").textContent="= $"+a.toLocaleString(),document.querySelector("#realVentas").textContent="= $"+(r-i-a-n).toLocaleString(),document.querySelector("#totalBaseGravable").textContent="+ $"+Number(e.basegravable).toLocaleString(),document.querySelector("#impuestoTotal").textContent="+ $"+Number(e.valorimpuestototal).toLocaleString(),document.querySelector("#otrosGastosBancarios").textContent="+ $"+Number(e.gastosbanco).toLocaleString(),document.querySelector("#cantidadFacturasFE").textContent=e.facturaselectronicas,document.querySelector("#cantidadFacturasPOS").textContent=e.facturaspos}(r.ultimocierre),function(e){const t=document.querySelector("#sobranteFaltante tbody");for(;t.firstChild;)t.removeChild(t.firstChild);e.forEach(e=>{const o=document.createElement("tr");"Efectivo"==e.nombremediopago&&o.classList.add("!border-2","!border-indigo-600"),o.innerHTML=`<td class="">${e.nombremediopago}</td> \n                        <td class="colsistem">${e.valorsistema.toLocaleString()}</td>\n                        <td class="coldeclarado" data-mediopagoid="${e.id_mediopago}">${e.valordeclarado.toLocaleString()}</td>\n                        <td class="coldif">${(e.valordeclarado-e.valorsistema).toLocaleString()}</td>\n                      `,t.appendChild(o)})}(r.sobrantefaltante),function(e){const t=document.querySelector("#ventasXUsuario tbody");for(;t.firstChild;)t.removeChild(t.firstChild);e.forEach(e=>{const o=document.createElement("tr");o.innerHTML=`<td class="">${e.Nombre}</td>\n                        <td class="">${e.N_ventas}</td>\n                        <td class=""><strong>$ </strong>${Number(e.ventas).toLocaleString()}</td>\n                      `,t.appendChild(o)})}(r.ventasxusuarios),function(e){const t=document.querySelector("#tablaVentas tbody");for(;t.firstChild;)t.removeChild(t.firstChild);e.forEach((e,o)=>{const n=document.createElement("tr");n.innerHTML=`<td class="">${o}</td>        \n                        <td class="">${e.fechapago}</td> \n                        <td class="">${e.cliente}</td> \n                        <td class="">${e.id}</td>\n                        <td>\n                            <div data-estado="${e.estado}" data-totalpagado="${e.total}" id="${e.id}" class="mediosdepago max-w-full flex flex-wrap gap-2">\n                                ${e.mediosdepago.map(e=>`<button class="btn-xs btn-light">${e.mediopago}</button>`).join(" ")}\n                            </div>\n                        </td>\n                        <td class="${"Paga"==e.estado?"btn-xs btn-lima":"btn-xs btn-blueintense"}">${e.estado}</td>\n                        <td class="">$ ${Number(e.subtotal).toLocaleString()}</td>\n                        <td class="">$ ${Number(e.total).toLocaleString()}</td>\n                        <td class="accionestd"><div class="acciones-btns" id="${e.id}">\n                                <a class="btn-xs btn-turquoise" href="/admin/caja/ordenresumen?id=${e.id}">Ver</a> <button class="btn-xs btn-light"><i class="fa-solid fa-print"></i></button>\n                            </div>\n                        </td>\n                      `,t.appendChild(n)})}(r.facturas),msjalertToast("success","¡Éxito!",r.exito[0])):msjalertToast("error","¡Error!",r.error[0])}catch(e){console.log(e)}}))})}})(),(()=>{var e;if(document.querySelector(".detallecierrecaja")){const t=document.querySelector("#btnImprimirDetalleCaja"),o=null!==(e=new URLSearchParams(window.location.search).get("id"))&&void 0!==e?e:"";null==t||t.addEventListener("click",()=>{if(""!=o){const e=window.open("/printdetallecierre?id="+o,"_blank");e&&(e.onload=()=>{null==e||e.focus(),null==e||e.print(),setTimeout(()=>{null==e||e.close()},200)})}})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".fechazetadiario")){const o=document.querySelectorAll(".btnmultiselect"),n=document.querySelectorAll(".caja"),a=document.querySelector("#consultarZDiario"),r=document.querySelector("#tablaMediosPago tbody"),i=document.querySelector("#base"),c=document.querySelector("#valorImpuestoTotal"),d=document.querySelector("#ingresoVentas"),l=document.querySelector("#totalDescuentos"),s=document.querySelector("#realVentas"),u=document.querySelector("#cantidadElectronicas"),m=document.querySelector("#cantidadPOS"),p=document.querySelector("#valorElectronicas"),v=document.querySelector("#valorPOS");let g="",f="";function t(){const e=document.querySelectorAll('input.caja[type="checkbox"]:checked'),t=document.querySelector("#cajastext");t.textContent=". ",e.forEach((o,n)=>{var a,r;n<e.length-1?t.textContent+=(null===(a=o.nextElementSibling)||void 0===a?void 0:a.textContent)+" - ":t.textContent+=null===(r=o.nextElementSibling)||void 0===r?void 0:r.textContent})}o.forEach((e,t)=>{e.addEventListener("click",n=>{!function(e){o.forEach((t,o)=>{o==e&&t.classList.contains("open")||t.classList.remove("open")})}(t),e.classList.toggle("open")})}),null===(e=document.querySelector(".fechazetadiario"))||void 0===e||e.addEventListener("click",e=>{if(!e.target.closest(".btnmultiselect")&&!e.target.closest(".list-items")){const e=document.querySelector(".open");e&&e.classList.toggle("open")}}),n.forEach(e=>{e.addEventListener("click",t)}),$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");g=o,f=n,document.querySelector("#fechainicio").textContent=g,document.querySelector("#fechafin").textContent=f})),a.addEventListener("click",()=>{if(""==g||""==f)return void msjalertToast("error","¡Error!","Elegir fechas a consultar");const e=document.querySelectorAll('input.caja[type="checkbox"]:checked'),t=document.querySelectorAll('input.facturador[type="checkbox"]:checked'),o=Array.from(e).map(e=>e.value),n=Array.from(t).map(e=>e.value);document.querySelector(".content-spinner1").style.display="grid",__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("fechainicio",g),e.append("fechafin",f),e.append("cajas",JSON.stringify(o)),e.append("facturadores",JSON.stringify(n));try{const o="/admin/api/consultafechazetadiario",n=yield fetch(o,{method:"POST",body:e}),a=yield n.json();console.log(a),document.querySelector(".content-spinner1").style.display="none",function(){for(;r.firstChild;)r.removeChild(r.firstChild);d.textContent="",l.textContent="",s.textContent="",u.textContent="",m.textContent="",p.textContent="",v.textContent=""}(),a.datosmediospago.forEach(e=>{const t=document.createElement("tr");t.innerHTML=`<td class="">${e.nombre}</td> \n                        <td class="">$${Number(e.valor).toLocaleString()}</td>`,r.appendChild(t)}),t=a.datosventa,i.textContent="$"+Number(t.base).toLocaleString(),c.textContent="$"+Number(t.valorimpuestototal).toLocaleString(),d.textContent="$"+Number(t.subtotalventa).toLocaleString(),l.textContent="$"+(Number(t.subtotalventa)-Number(t.totalventa)).toLocaleString(),s.textContent="$"+Number(t.totalventa).toLocaleString(),u.textContent=t.ELECTRONICAS,m.textContent=t.POS,p.textContent="$"+Number(t.total_ELECTRONICAS).toLocaleString(),v.textContent="$"+Number(t.total_POS).toLocaleString()}catch(e){console.log(e)}var t}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t,o,n,a;if(document.querySelector(".ordenresumen")){const d=document.querySelector("#miDialogoFacturar"),l=document.querySelector("#miDialogoEliminarOrden"),s=document.querySelector("#btnfacturar"),u=document.querySelector("#btneliminarorden"),m=document.querySelector("#caja"),p=document.querySelector("#facturador"),v=document.querySelectorAll(".mediopago"),g=document.querySelectorAll('input[name="devolverinventario"]'),f=document.querySelectorAll(".inputInv"),y=document.querySelector("#printcarta"),h=document.querySelector("#printcotizacion"),S=(document.querySelector("#numOrden"),document.querySelector("#referenciaFactura"),{subtotal:0,impuesto:0,dctox100:0,descuento:0,idtarifa:0,valortarifa:0,total:0}),b=new Map;function r(e){var t;$("#facturador").val(null!==(t=e.options[e.selectedIndex].dataset.idfacturador)&&void 0!==t?t:"1")}function i(e){e=e.replace(/[,.]/g,""),Number(e)>b.get("1")?document.querySelector("#cambio").textContent=(Number(e)-b.get("1")).toLocaleString()+"":document.querySelector("#cambio").textContent="0"}function c(e){const t=e.target;(e.target===d||e.target===l||"cancelar"===e.target.value||t.closest(".noeliminar")||t.closest(".sieliminar"))&&(d.close(),l.close(),t.closest(".sieliminar")&&function(){var e=[];f.forEach(t=>{const o=t;e=[...e,{id:o.id,idproducto:o.id,tipoproducto:o.dataset.tipoproducto,tipoproduccion:o.dataset.tipoproduccion,rendimientoestandar:o.dataset.rendimientoestandar,cantidad:o.value}]}),(()=>{__awaiter(this,void 0,void 0,(function*(){const t=new FormData;t.append("id",document.querySelector("#idorden").dataset.idorden),t.append("inv",JSON.stringify(e)),t.append("devolverinv",document.querySelector('input[name="devolverinventario"]:checked').value);try{const e="/admin/api/eliminarOrden",o=yield fetch(e,{method:"POST",body:t}),n=yield o.json();void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),u.style.display="none",document.querySelector("#estadoOrden").textContent="Eliminada"):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))})()}(),document.removeEventListener("click",c))}S.subtotal=Number(null===(e=document.querySelector("#subTotal"))||void 0===e?void 0:e.textContent),S.total=Number(null===(o=null===(t=document.querySelector("#total"))||void 0===t?void 0:t.textContent)||void 0===o?void 0:o.replace(/[^\d]/g,"")),r(m),m.addEventListener("change",e=>r(e.target)),null==y||y.addEventListener("click",()=>{const e=new URLSearchParams(window.location.search).get("id"),t=window.open("/printfacturacarta?id="+e,"_blank");t&&(t.onload=()=>{null==t||t.focus(),null==t||t.print(),setTimeout(()=>{null==t||t.close()},200)})}),null==h||h.addEventListener("click",()=>{const e=new URLSearchParams(window.location.search).get("id"),t=window.open("/printcotizacion?id="+e,"_blank");t&&(t.onload=()=>{null==t||t.focus(),null==t||t.print(),setTimeout(()=>{null==t||t.close()},200)})}),null==s||s.addEventListener("click",()=>{!function(){document.querySelector("#totalPagar").textContent=""+S.total.toLocaleString();let e=0;v.forEach((t,o)=>{o>0&&(e+=parseInt(t.value.replace(/[,.]/g,"")))}),S.total<e&&(e=0,b.clear(),$(".mediopago").val(0));document.querySelector(".Efectivo").value=""+(S.total-e).toLocaleString(),b.set("1",S.total-e),S.total-e==0&&b.has("1")&&b.delete("1");i(document.querySelector("#recibio").value)}(),d.showModal(),document.addEventListener("click",c)}),null==u||u.addEventListener("click",()=>{l.showModal(),document.addEventListener("click",c)}),g.forEach(e=>{e.addEventListener("change",e=>{var t;null===(t=document.querySelector("#productsInv"))||void 0===t||t.classList.toggle("hidden"),"1"===e.target.value?document.querySelectorAll(".inputInv").forEach(e=>e.setAttribute("required","")):document.querySelectorAll(".inputInv").forEach(e=>e.removeAttribute("required"))})}),f.forEach(e=>{e.addEventListener("input",e=>{var t,o;const n=e.target;n.value!=(null===(t=n.parentElement)||void 0===t?void 0:t.dataset.qty)?(n.classList.add("border-2","border-rose-600"),document.querySelector(".alerta")||msjAlert("error","Cantidad diferente a devolver a inventario",document.querySelector("#divmsjalerta1"))):(n.classList.remove("border-2","border-rose-600"),null===(o=document.querySelector(".alerta"))||void 0===o||o.remove())})}),v.forEach(e=>{e.addEventListener("input",e=>{!function(e){var t;let o=0;v.forEach((e,t)=>{t>0&&(o+=parseInt(e.value.replace(/[,.]/g,"")))}),o<=S.total?(b.set("1",S.total-o),S.total-o==0&&b.has("1")&&b.delete("1"),b.set(e.target.id,parseInt(e.target.value.replace(/[,.]/g,""))),"0"==e.target.value&&b.has(e.target.id)&&b.delete(e.target.id)):b.has(e.target.id)?e.target.value=b.get(e.target.id).toLocaleString():e.target.value="0";v[0].value=(null!==(t=b.get("1"))&&void 0!==t?t:0).toLocaleString(),i(document.querySelector("#recibio").value)}(e)})}),null===(n=document.querySelector("#recibio"))||void 0===n||n.addEventListener("input",e=>{i(e.target.value)}),null===(a=document.querySelector("#formfacturar"))||void 0===a||a.addEventListener("submit",e=>{e.preventDefault(),function(e){__awaiter(this,void 0,void 0,(function*(){const t=document.querySelector('input[name="imprimir"]:checked'),o=new FormData;o.append("id",document.querySelector("#idorden").dataset.idorden),o.append("idcaja",m.value),o.append("idconsecutivo",p.value),o.append("caja",document.querySelector("#caja option:checked").textContent),o.append("tipofacturador",p.options[p.selectedIndex].textContent),o.append("mediosPago",JSON.stringify(Array.from(b,([e,t])=>({idmediopago:e,id_factura:0,valor:t})))),o.append("recibido",document.querySelector("#recibio").value),o.append("transaccion",""),o.append("estado",e),o.append("cambioaventa","1"),o.append("observacion",document.querySelector("#observacion").value);try{const e="/admin/api/facturarCotizacion",a=yield fetch(e,{method:"POST",body:o}),r=yield a.json();console.log(r),void 0!==r.exito?(msjalertToast("success","¡Éxito!",r.exito[0]),r.idfactura&&"1"===t.value&&(n=r.idfactura,setTimeout(()=>{window.open("/admin/printPDFPOS?id="+n,"_blank")},1200)),function(){s&&(s.style.display="none");document.querySelector("#abrirOrden").style.display="none",document.querySelector("#estadoOrden").textContent="Paga"}()):msjalertToast("error","¡Error!",r.error[0])}catch(e){console.log(e)}var n;d.close(),document.removeEventListener("click",c)}))}("Guardado")})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".pedidosguardados")){let t,o=0;t=$("#tablaPedidosGuardados").DataTable(configdatatables),null===(e=document.querySelector("#tablaPedidosGuardados"))||void 0===e||e.addEventListener("click",e=>{var n;const a=e.target;((null==a?void 0:a.classList.contains("eliminarPedidoGuardado"))||(null===(n=a.parentElement)||void 0===n?void 0:n.classList.contains("eliminarPedidoGuardado")))&&function(e){let n=e.target.parentElement.id,a=t.page.info();"I"===e.target.tagName&&(n=e.target.parentElement.parentElement.id);o=t.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:`Desea eliminar la orden guardado #${n}?`,text:"La orden/cotizacion guardado sera eliminado definitivamente del sistema.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",n);try{const n="/admin/api/eliminarPedidoGuardado",r=yield fetch(n,{method:"POST",body:e}),i=yield r.json();void 0!==i.exito?(t.row(o).remove().draw(),t.page(a.page).draw("page"),Swal.fire(i.exito[0],"","success")):Swal.fire(i.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};!function(){var e,t,o;if(document.querySelector(".empleados")){const a=document.querySelector("#crearempleado"),r=document.getElementById("miDialogoEmpleado"),i=document.getElementById("miDialogoContraseña"),c=document.querySelector("#upImage"),d=document.querySelector("#customUpImage"),l=document.querySelector("#imginputfile"),s=document.querySelector("#nombreempleado"),u=document.querySelector("#apellidoempleado"),m=document.querySelector("#nicknameempleado"),p=document.querySelector("#passwordempleado"),v=document.querySelector("#passwordempleado2 "),g=document.querySelector("#movilempleado "),f=document.querySelector("#perfilempleado");let y,h,S=0,b=0,x=[];function n(e){e.target!==r&&e.target!==i&&"Cancelar"!==e.target.value||(r.close(),null==i||i.close(),document.removeEventListener("click",n))}(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/getAllemployee",t=yield fetch(e);x=yield t.json()}catch(e){console.log(e)}}))})(),f.addEventListener("change",e=>{"2"==e.target.value&&(document.querySelector("#contentpermisos").style.display="none",document.querySelector("#contentpermisosadmin").style.display="none"),"3"==e.target.value&&(document.querySelector("#contentpermisos").style.display="none",document.querySelector("#contentpermisosadmin").style.display="block"),"4"==e.target.value&&(document.querySelector("#contentpermisos").style.display="block",document.querySelector("#contentpermisosadmin").style.display="none")}),y=$("#tablaempleados").DataTable(configdatatables),a.addEventListener("click",e=>{b=0,function(){var e;l.src=" ",null===(e=document.querySelector("#formCrearUpdateEmpleado"))||void 0===e||e.reset()}(),document.querySelector("#modalEmpleado").textContent="Crear empleado",document.querySelector("#btnEditarCrearEmpleado").value="Crear",r.showModal(),document.addEventListener("click",n)}),d.addEventListener("click",()=>c.click()),c.addEventListener("change",(function(){var e;const t=null===(e=this.files)||void 0===e?void 0:e[0];if(t){const e=new FileReader;e.onload=function(){const t=e.result;"string"==typeof t&&(l.src=t)},e.readAsDataURL(t)}})),null===(e=document.querySelector("#tablaempleados"))||void 0===e||e.addEventListener("click",e=>{var t,o,a,c,d;const p=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarEmpleado"))||(null===(o=e.target.parentElement)||void 0===o?void 0:o.classList.contains("editarEmpleado")))&&function(e){var t,o,a,i,c,d,p,v,f,w;let E=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(o=e.target)||void 0===o?void 0:o.tagName)&&(E=null===(i=null===(a=e.target.parentElement)||void 0===a?void 0:a.parentElement)||void 0===i?void 0:i.id);b=1,document.querySelector("#modalEmpleado").textContent="Actualizar Empleado",document.querySelector("#btnEditarCrearEmpleado").value="Actualizar",h=x.find(e=>e.id==E),l.src="/build/img/"+(null==h?void 0:h.img),s.value=null!==(c=null==h?void 0:h.nombre)&&void 0!==c?c:"",u.value=null!==(d=null==h?void 0:h.apellido)&&void 0!==d?d:"",m.value=null!==(p=null==h?void 0:h.nickname)&&void 0!==p?p:"",g.value=null!==(v=null==h?void 0:h.movil)&&void 0!==v?v:"",$("#perfilempleado").val(null!==(f=null==h?void 0:h.perfil)&&void 0!==f?f:""),"2"==(null==h?void 0:h.perfil)&&(document.querySelector("#contentpermisos").style.display="none",document.querySelector("#contentpermisosadmin").style.display="none");"3"==(null==h?void 0:h.perfil)&&(document.querySelector("#contentpermisos").style.display="none",document.querySelector("#contentpermisosadmin").style.display="block");"4"==(null==h?void 0:h.perfil)&&(document.querySelector("#contentpermisos").style.display="block",document.querySelector("#contentpermisosadmin").style.display="none");q=null!==(w=null==h?void 0:h.permisos)&&void 0!==w?w:[],document.querySelectorAll('#contentpermisos input[type="checkbox"]').forEach(e=>{e.checked=!1}),q.forEach(e=>{document.querySelector(`input[value="${e.id}"]`).checked=!0}),S=y.row(e.target.closest("tr")).index(),r.showModal(),document.addEventListener("click",n);var q}(e),((null===(a=e.target)||void 0===a?void 0:a.classList.contains("updatePassword"))||(null===(c=e.target.parentElement)||void 0===c?void 0:c.classList.contains("updatePassword")))&&function(e){var t,o,a,r;let c=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===e.target.tagName&&(c=null===(a=null===(o=e.target.parentElement)||void 0===o?void 0:o.parentElement)||void 0===a?void 0:a.id);h=x.find(e=>e.id==c),document.querySelector("#nombreEmpleadoPass").textContent=(null==h?void 0:h.nombre)+" "+(null!==(r=null==h?void 0:h.apellido)&&void 0!==r?r:""),null==i||i.showModal(),document.addEventListener("click",n)}(e),((null==p?void 0:p.classList.contains("eliminarEmpleado"))||(null===(d=p.parentElement)||void 0===d?void 0:d.classList.contains("eliminarEmpleado")))&&function(e){let t=e.target.parentElement.id,o=y.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);S=y.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el empleado?",text:"El empleado sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const n="/admin/api/eliminarEmpleado",a=yield fetch(n,{method:"POST",body:e}),r=yield a.json();void 0!==r.exito?(y.row(S).remove().draw(),y.page(o.page).draw("page"),x=x.filter(e=>e.id!=t),Swal.fire(r.exito[0],"","success")):Swal.fire(r.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateEmpleado"))||void 0===t||t.addEventListener("submit",e=>{var t;if(b){e.preventDefault();var o,a=y.page.info();if(o=h.img,!l.src.includes(h.img)&&(o=null===(t=e.target.elements.namedItem("upImage").files)||void 0===t?void 0:t[0])){if("image/png"!==o.type&&"image/jpeg"!==o.type)return void msjAlert("error","No es un formato valido para la foto",document.querySelector("#divmsjalertaempleado1"));if(o.size>55e4)return void msjAlert("error","La imagen no debe superar los 500KB",document.querySelector("#divmsjalertaempleado1"))}var i=[];document.querySelectorAll('#contentpermisos input[type="checkbox"]').forEach(e=>{var t,o;e.checked&&(i=[...i,{id:e.value,nombre:null!==(o=null===(t=e.nextElementSibling)||void 0===t?void 0:t.textContent)&&void 0!==o?o:"permiso"}])}),(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",h.id),e.append("img",o),e.append("nombre",s.value),e.append("apellido",u.value),e.append("nickname",m.value),e.append("password",p.value),e.append("password2",v.value),e.append("movil",g.value),e.append("perfil",f.value),e.append("idpermisos",JSON.stringify(i.map(e=>e.id)));try{const t="/admin/api/actualizarEmpleado",o=yield fetch(t,{method:"POST",body:e}),c=yield o.json();if(void 0!==c.exito){msjalertToast("success","¡Éxito!",c.exito[0]);const e=y.row(S+=a.start).data();e[1]=s.value+" "+u.value,e[2]=`<div class="text-center"><img style="width: 40px;" src="/build/img/${c.rutaimg}" alt=""></div>`,e[3]=m.value,e[6]="1"===f.value?"root":"2"==f.value?"Superior":"3"==f.value?"Admin":"Asesor",x.forEach(e=>{e.id==(null==h?void 0:h.id)&&(e.permisos=i,e.img=c.rutaimg)}),y.row(S).data(e).draw(),y.page(a.page).draw("page")}else msjalertToast("error","¡Error!",c.error[0]);r.close(),document.removeEventListener("click",n)}catch(e){console.log(e)}}))})()}}),null===(o=document.querySelector("#formContraseña"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault(),(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",h.id),e.append("password",document.querySelector("#changePassword").value);try{const t="/admin/api/updatepassword",o=yield fetch(t,{method:"POST",body:e}),a=yield o.json();void 0!==a.exito?msjalertToast("success","¡Éxito!",a.exito[0]):msjalertToast("error","¡Error!",a.exito[0]),null==i||i.close(),document.removeEventListener("click",n)}catch(e){console.log(e)}}))})()})}}();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gestionbancos")){const n=document.querySelector("#crearBanco"),a=document.querySelector("#miDialogoBanco");let r,i,c=0,d=0,l=[];function o(e){e.target!==a&&"Salir"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allbancos",t=yield fetch(e);l=yield t.json(),console.log(l)}catch(e){console.log(e)}})),r=$("#tablaBancos").DataTable(configdatatables),n.addEventListener("click",()=>{d=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateBanco"))||void 0===e||e.reset()}(),document.querySelector("#modalBanco").textContent="Crear banco",document.querySelector("#btnEditarCrearBanco").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaBancos"))||void 0===e||e.addEventListener("click",e=>{var t,n,s;const u=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarBanco"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarBanco")))&&function(e){var t,n,s,u;let m=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(m=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);d=1,document.querySelector("#modalBanco").textContent="Actualizar banco",document.querySelector("#btnEditarCrearBanco").value="Actualizar",i=l.find(e=>e.id==m),document.querySelector("#nombreBanco").value=null==i?void 0:i.nombre,document.querySelector("#numeroCuenta").value=null==i?void 0:i.numerocuenta,c=r.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==u?void 0:u.classList.contains("eliminarBanco"))||(null===(s=u.parentElement)||void 0===s?void 0:s.classList.contains("eliminarBanco")))&&function(e){let t=e.target.parentElement.id,o=r.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);c=r.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la banco?",text:"La banco sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarBanco",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(r.row(c+o.start).remove().draw(),r.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateBanco"))||void 0===t||t.addEventListener("submit",e=>{let t="crearBanco";d&&(t="actualizarBanco"),e.preventDefault();var n=r.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==i?void 0:i.id)?null==i?void 0:i.id:""),e.append("nombre",$("#nombreBanco").val()),e.append("numerocuenta",$("#numeroCuenta").val());try{const s="/admin/api/"+t,u=yield fetch(s,{method:"POST",body:e}),m=yield u.json();if(void 0!==m.exito)if(a.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),d){l.forEach(e=>{e.id==(null==i?void 0:i.id)&&(e=Object.assign(e,m.banco[0]))});const e=r.row(c+=n.start).data();e[1]=m.banco[0].nombre,e[2]=m.banco[0].numerocuenta,r.row(c).data(e).draw(),r.page(n.page).draw("page")}else l=[...l,m.banco],r.row.add([r.rows().count()+1,m.banco.nombre,m.banco.numerocuenta,m.banco.created_at,`<div class="acciones-btns" id="${m.banco.id}" data-banco="${m.banco.nombre}">\n                          <button class="btn-md btn-turquoise editarBanco"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarBanco"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gestioncajas")){const n=document.querySelector("#crearCaja"),a=document.querySelector("#miDialogoCaja");let r,i,c=0,d=0,l=[];function o(e){e.target!==a&&"Salir"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allcajas",t=yield fetch(e);l=yield t.json(),console.log(l)}catch(e){console.log(e)}})),r=$("#tablaCajas").DataTable(configdatatables),n.addEventListener("click",()=>{d=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateCaja"))||void 0===e||e.reset()}(),document.querySelector("#modalCaja").textContent="Crear caja",document.querySelector("#btnEditarCrearCaja").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaCajas"))||void 0===e||e.addEventListener("click",e=>{var t,n,s;const u=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarCaja"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarCaja")))&&function(e){var t,n,s,u,m;let p=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(p=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);d=1,document.querySelector("#modalCaja").textContent="Actualizar caja",document.querySelector("#btnEditarCrearCaja").value="Actualizar",i=l.find(e=>e.id==p),document.querySelector("#nombrecaja").value=null==i?void 0:i.nombre,$("#idtipoconsecutivo").val(null!==(m=null==i?void 0:i.idtipoconsecutivo)&&void 0!==m?m:""),$("#negociogestioncaja").val(1),c=r.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==u?void 0:u.classList.contains("eliminarCaja"))||(null===(s=u.parentElement)||void 0===s?void 0:s.classList.contains("eliminarCaja")))&&function(e){let t=e.target.parentElement.id,o=r.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);c=r.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la caja?",text:"La caja sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarCaja",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(r.row(c+o.start).remove().draw(),r.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateCaja"))||void 0===t||t.addEventListener("submit",e=>{let t="crearCaja";d&&(t="actualizarCaja"),e.preventDefault();var n=r.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==i?void 0:i.id)?null==i?void 0:i.id:""),e.append("idtipoconsecutivo",$("#idtipoconsecutivo").val()),e.append("nombre",$("#nombrecaja").val()),e.append("negocio",$("#negociogestioncaja").val());try{const s="/admin/api/"+t,u=yield fetch(s,{method:"POST",body:e}),m=yield u.json();if(void 0!==m.exito)if(a.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),d){l.forEach(e=>{e.id==(null==i?void 0:i.id)&&(e=Object.assign(e,m.caja[0]))});const e=r.row(c+=n.start).data();e[1]=m.caja[0].nombre,e[2]=$("#idtipoconsecutivo option:selected").text(),e[3]=$("#negociogestioncaja option:selected").text(),r.row(c).data(e).draw(),r.page(n.page).draw("page")}else l=[...l,m.caja],r.row.add([r.rows().count()+1,m.caja.nombre,m.caja.nombreconsecutivo.nombre,m.caja.negocio,`<div class="acciones-btns" id="${m.caja.id}" data-caja="${m.caja.nombre}">\n                          <button class="btn-md btn-turquoise editarCaja"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarCaja"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})(),(()=>{if(document.querySelector(".gestionfacturadores")){const o=document.querySelector("#crearCompañia"),n=document.querySelector("#obtenerresolucion"),a=document.querySelector("#setpruebas"),r=document.querySelector("#miDialogoCompañia"),i=document.querySelector("#miDialogoGetResolucion"),c=document.querySelector("#miDialogosetpruebas");let d=0;function e(t){t.target!==r&&t.target!==c&&t.target!==i&&"Salir"!==t.target.value&&"Cancelar"!==t.target.value||(r.close(),i.close(),c.close(),document.removeEventListener("click",e))}function t(){var e;null===(e=document.querySelector("#formCrearUpdateCompañia"))||void 0===e||e.reset()}o.addEventListener("click",()=>{d=0,t(),document.querySelector("#modalCompañia").textContent="Crear compañia",document.querySelector("#btnEditarCrearCompañia").value="Crear",r.showModal(),document.addEventListener("click",e)}),n.addEventListener("click",()=>{d=0,t(),i.showModal(),document.addEventListener("click",e)}),a.addEventListener("click",()=>{d=0,t(),c.showModal(),document.addEventListener("click",e)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gestionfacturadores")){const n=document.querySelector("#crearFacturador"),a=document.querySelector("#miDialogoFacturador");let r,i,c=0,d=0,l=[];function o(e){e.target!==a&&"Salir"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allfacturadores",t=yield fetch(e);l=yield t.json(),console.log(l)}catch(e){console.log(e)}})),r=$("#tablaFacturadores").DataTable(configdatatables),n.addEventListener("click",()=>{d=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateFacturador"))||void 0===e||e.reset()}(),document.querySelector("#modalFacturador").textContent="Crear facturador",document.querySelector("#btnEditarCrearFacturador").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaFacturadores"))||void 0===e||e.addEventListener("click",e=>{var t,n,s;const u=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarFacturador"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarFacturador")))&&function(e){var t,n,s,u,m,p,v,g,f,y,h,S;let b=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(b=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);d=1,document.querySelector("#modalFacturador").textContent="Actualizar facturador",document.querySelector("#btnEditarCrearFacturador").value="Actualizar",i=l.find(e=>e.id==b),document.querySelector("#nombrefacturador").value=null==i?void 0:i.nombre,$("#idtipofacturador").val(null!==(m=null==i?void 0:i.idtipofacturador)&&void 0!==m?m:""),$("#rangoinicial").val(null!==(p=null==i?void 0:i.rangoinicial)&&void 0!==p?p:""),$("#rangofinal").val(null!==(v=null==i?void 0:i.rangofinal)&&void 0!==v?v:""),$("#siguientevalor").val(null!==(g=null==i?void 0:i.siguientevalor)&&void 0!==g?g:""),$("#fechainicio").val(null!==(f=null==i?void 0:i.fechainicio)&&void 0!==f?f:""),$("#fechafin").val(null!==(y=null==i?void 0:i.fechafin)&&void 0!==y?y:""),$("#resolucion").val(null!==(h=null==i?void 0:i.resolucion)&&void 0!==h?h:""),$("#prefijo").val(null!==(S=null==i?void 0:i.prefijo)&&void 0!==S?S:""),$("#negociofacturador").val(1),c=r.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==u?void 0:u.classList.contains("eliminarFacturador"))||(null===(s=u.parentElement)||void 0===s?void 0:s.classList.contains("eliminarFacturador")))&&function(e){let t=e.target.parentElement.id,o=r.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);c=r.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el facturador?",text:"El facturador sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarFacturador",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(r.row(c+o.start).remove().draw(),r.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateFacturador"))||void 0===t||t.addEventListener("submit",e=>{let t="crearFacturador";d&&(t="actualizarFacturador"),e.preventDefault();var n=r.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==i?void 0:i.id)?null==i?void 0:i.id:""),e.append("idtipofacturador",$("#idtipofacturador").val()),e.append("idnegocio",$("#negociofacturador").val()),e.append("nombre",$("#nombrefacturador").val()),e.append("rangoinicial",$("#rangoinicial").val()),e.append("rangofinal",$("#rangofinal").val()),e.append("siguientevalor",$("#siguientevalor").val()),e.append("fechainicio",$("#fechainicio").val()),e.append("fechafin",$("#fechafin").val()),e.append("resolucion",$("#resolucion").val()),e.append("prefijo",$("#prefijo").val());try{const s="/admin/api/"+t,u=yield fetch(s,{method:"POST",body:e}),m=yield u.json();if(void 0!==m.exito)if(a.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),d){console.log(m),l.forEach(e=>{e.id==(null==i?void 0:i.id)&&(e=Object.assign(e,m.facturador[0]))});const e=r.row(c+=n.start).data();e[1]=m.facturador[0].nombre,e[2]=m.facturador[0].nombretipofacturador,e[3]=m.facturador[0].rangoinicial,e[4]=m.facturador[0].siguientevalor,e[5]=m.facturador[0].fechafin,e[6]=1==m.facturador.estado?"Activo":"Inactivo",r.row(c).data(e).draw(),r.page(n.page).draw("page")}else l=[...l,m.facturador],r.row.add([r.rows().count()+1,m.facturador.nombre,m.facturador.nombretipofacturador.nombre,m.facturador.rangoinicial,m.facturador.siguientevalor,m.facturador.fechafin,1==m.facturador.estado?"Activo":"Inactivo",`<div class="acciones-btns" id="${m.facturador.id}" data-facturador="${m.facturador.nombre}">\n                          <button class="btn-md btn-turquoise editarFacturador"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarFacturador"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else a.close(),document.removeEventListener("click",o),msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".tarifas")){const n=document.querySelector("#crearBanco"),a=document.querySelector("#miDialogoBanco");let r,i,c=0,d=0,l=[];function o(e){e.target!==a&&"Salir"!==e.target.value||(a.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allbancos",t=yield fetch(e);l=yield t.json(),console.log(l)}catch(e){console.log(e)}})),r=$("#tablaBancos").DataTable(configdatatables),n.addEventListener("click",()=>{d=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateBanco"))||void 0===e||e.reset()}(),document.querySelector("#modalBanco").textContent="Crear banco",document.querySelector("#btnEditarCrearBanco").value="Crear",a.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaBancos"))||void 0===e||e.addEventListener("click",e=>{var t,n,s;const u=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarBanco"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("editarBanco")))&&function(e){var t,n,s,u;let m=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(m=null===(u=null===(s=e.target.parentElement)||void 0===s?void 0:s.parentElement)||void 0===u?void 0:u.id);d=1,document.querySelector("#modalBanco").textContent="Actualizar banco",document.querySelector("#btnEditarCrearBanco").value="Actualizar",i=l.find(e=>e.id==m),document.querySelector("#nombreBanco").value=null==i?void 0:i.nombre,document.querySelector("#numeroCuenta").value=null==i?void 0:i.numerocuenta,c=r.row(e.target.closest("tr")).index(),a.showModal(),document.addEventListener("click",o)}(e),((null==u?void 0:u.classList.contains("eliminarBanco"))||(null===(s=u.parentElement)||void 0===s?void 0:s.classList.contains("eliminarBanco")))&&function(e){let t=e.target.parentElement.id,o=r.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);c=r.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la banco?",text:"La banco sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarBanco",n=yield fetch(t,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(r.row(c+o.start).remove().draw(),r.page(o.page).draw("page"),Swal.fire(a.exito[0],"","success")):Swal.fire(a.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateBanco"))||void 0===t||t.addEventListener("submit",e=>{let t="crearBanco";d&&(t="actualizarBanco"),e.preventDefault();var n=r.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==i?void 0:i.id)?null==i?void 0:i.id:""),e.append("nombre",$("#nombreBanco").val()),e.append("numerocuenta",$("#numeroCuenta").val());try{const s="/admin/api/"+t,u=yield fetch(s,{method:"POST",body:e}),m=yield u.json();if(void 0!==m.exito)if(a.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),d){l.forEach(e=>{e.id==(null==i?void 0:i.id)&&(e=Object.assign(e,m.banco[0]))});const e=r.row(c+=n.start).data();e[1]=m.banco[0].nombre,e[2]=m.banco[0].numerocuenta,r.row(c).data(e).draw(),r.page(n.page).draw("page")}else l=[...l,m.banco],r.row.add([r.rows().count()+1,m.banco.nombre,m.banco.numerocuenta,m.banco.created_at,`<div class="acciones-btns" id="${m.banco.id}" data-banco="${m.banco.nombre}">\n                          <button class="btn-md btn-turquoise editarBanco"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarBanco"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};!function(){var e,t;if(document.querySelector(".reportes")){const n=document.querySelectorAll(".graficaventa"),a=null===(e=document.getElementById("chartventas"))||void 0===e?void 0:e.getContext("2d"),r=null===(t=document.getElementById("chartutilidad"))||void 0===t?void 0:t.getContext("2d");let i=null;function o(e){return __awaiter(this,void 0,void 0,(function*(){try{const t=yield fetch(e);!function(e){i&&i.destroy();i=new Chart(a,{type:"bar",data:{labels:e.label,datasets:[{label:"Total Ventas",data:e.datos,borderWidth:1}]},options:{scales:{y:{beginAtZero:!0,grid:{display:!1}},x:{grid:{display:!1}}},responsive:!0}})}(yield t.json())}catch(e){console.log(e)}}))}o("/admin/api/ventasGraficaMensual"),n.forEach((e,t)=>{e.addEventListener("click",e=>{let n="/admin/api/ventasGraficaMensual";1==t&&(n="/admin/api/ventasGraficaDiario"),o(n)})}),(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/graficaValorInventario",t=yield fetch(e),o=yield t.json();new Chart(r,{type:"doughnut",data:{labels:["Ventas total:","Costo:","Utilidad:"],datasets:[{label:"Total Ventas",data:[Number(o.valorventa),Number(o.costoinv),Number(o.valorventa)-Number(o.costoinv)],backgroundColor:["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 205, 86)"],hoverOffset:4}]},options:{responsive:!0,plugins:{legend:{labels:{generateLabels:e=>{const t=e.data.datasets[0].data;return e.data.labels.map((o,n)=>({text:`${o}: ${t[n]}`,fillStyle:e.data.datasets[0].backgroundColor[n],index:n}))}}}}}})}catch(e){console.log(e)}}))})()}}(),(()=>{if(document.querySelector(".paginadorventas")){const o=document.querySelectorAll(".filtrocategorias");var e=new List("hacker-list",{valueNames:["card-producto",{data:["categoria","code"]}],page:18,pagination:!0});o.forEach(t=>{t.addEventListener("click",t=>{const o=t.target.dataset.categoria;e.filter(e=>"Todos"===o||e.values().categoria===o)})});const n=document.querySelector("#btnCarritoMovil"),a=document.getElementById("contenidocarrito"),r=document.getElementById("contenedorDesktop"),i=document.getElementById("miDialogoCarritoMovil"),c=document.querySelector("#btnCerrarCarritoMovil");function t(e){e.target===i&&(i.close(),document.removeEventListener("click",t))}window.innerWidth<992&&i.appendChild(a),window.addEventListener("resize",()=>{window.innerWidth>=992?(r.appendChild(a),i.close(),document.removeEventListener("click",t)):i.appendChild(a)}),null==n||n.addEventListener("click",e=>{i.showModal(),document.addEventListener("click",t)}),c.addEventListener("click",()=>{i.close(),document.removeEventListener("click",t)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t,o,n,a,r;if(document.querySelector(".ventas")){const f=document.querySelector("#addcliente"),y=document.querySelector("#adddir"),h=document.querySelector("#selectCliente"),S=document.querySelector("#direccionEntrega"),b=document.querySelector("#facturarA"),x=(document.querySelectorAll("#producto"),document.querySelector("#productos")),w=document.querySelector("#btnotros"),E=document.querySelector("#btndescuento"),q=document.querySelector("#btnEntrega"),L=document.querySelector("#modalidadEntrega"),C=document.querySelector("#totalunidades"),_=document.querySelector("#tablaventa tbody"),D=document.querySelector("#btnguardar"),k=document.querySelector("#btnfacturar"),j=document.querySelector("#btnaplicarcredito"),T=document.querySelector("#miDialogoAddCliente"),M=document.querySelector("#miDialogoAddDir"),P=document.querySelector("#miDialogoOtrosProductos"),N=document.querySelector("#miDialogoFacturarA"),I=document.querySelector("#miDialogoDescuento"),A=document.querySelector("#miDialogoCredito"),F=document.querySelector("#miDialogoGuardar"),B=document.querySelector("#miDialogoFacturar"),O=document.querySelector("#caja"),Y=document.querySelector("#facturador"),H=document.querySelectorAll(".mediopago"),U=document.querySelectorAll('input[name="tipodescuento"]'),z=document.querySelector("#inputDescuento");let R=[];const G={subtotal:0,base:0,valorimpuestototal:0,dctox100:0,descuento:0,idtarifa:0,valortarifa:0,total:0};let V=[],X="",J=0,W="Contado";const Z={excluido:0,0:0,5:.0476190476190476,8:.0740740740740741,16:.1379310344827586,19:.1596638655462185};let K=[],Q={id:0,nombre:"",cantidad:0,valorunidad:0,total:0},ee=[];const te=new Map;function i(e){var t;$("#facturador").val(null!==(t=e.options[e.selectedIndex].dataset.idfacturador)&&void 0!==t?t:"1")}function c(e){for(var t,o;null==S?void 0:S.firstChild;)S.removeChild(null==S?void 0:S.firstChild);const n=new Set;V.length=0,console.log(e),e.forEach(e=>{const t=document.createElement("option");t.textContent=e.direccion,t.value=e.id,t.dataset.idcliente=e.idcliente,t.dataset.idtarifa=e.idtarifa,t.dataset.ciudad=e.ciudad,S.appendChild(t),e.tarifa.idcliente=e.idcliente,n.has(e.tarifa.id)||(V=[...V,e.tarifa],n.add(e.tarifa.id))}),n.clear(),d(),u(),document.querySelector("#ciudadEntrega").value=null!==(o=null===(t=e[0])||void 0===t?void 0:t.ciudad)&&void 0!==o?o:"No especificado"}function d(){const e=S.options[S.selectedIndex];if(": Presencial"==L.textContent||-1==S.selectedIndex)return G.valortarifa=0,void(X="");if((null==e?void 0:e.dataset.idtarifa)&&": Domicilio"==L.textContent){const t=V.find(t=>{if(t.idcliente==e.dataset.idcliente&&t.id==e.dataset.idtarifa)return!0});G.valortarifa=Number(null==t?void 0:t.valor),G.idtarifa=Number(null==t?void 0:t.id),X=null==t?void 0:t.nombre}}function l(e){const t=R.find(t=>t.idproducto==e),o=document.createElement("TR");o.classList.add("productselect"),o.dataset.id=""+e,o.insertAdjacentHTML("afterbegin",`<td class="!px-0 !py-2 text-xl text-gray-500 leading-5">${null==t?void 0:t.nombreproducto}</td> \n\n      <td class="!px-0 !py-2">\n        <div class="flex items-center gap-2 px-4">\n          <button type="button" class="w-8 h-8 bg-indigo-700 text-white rounded-full flex items-center justify-center">\n            <span class="menos material-symbols-outlined text-base">remove</span>\n          </button>\n\n          <input type="text" class="inputcantidad w-20 px-2 text-center" value="${t.cantidad}"\n            >\n\n          <button type="button" class="w-8 h-8 bg-indigo-700 text-white rounded-full flex items-center justify-center">\n            <span class="mas material-symbols-outlined text-base">add</span>\n          </button>\n        </div>\n      </td>\n\n\n      <td class="!p-2 text-xl text-gray-500 leading-5">$${Number(null==t?void 0:t.valorunidad).toLocaleString()}</td>\n      <td class="!p-2 text-xl text-gray-500 leading-5">$${Number(null==t?void 0:t.total).toLocaleString()}</td>\n      <td class="accionestd"><div class="acciones-btns"><button class="btn-md btn-red eliminarProducto"><i class="fa-solid fa-trash-can"></i></button></div></td>`),null==_||_.appendChild(o)}function s(e,t,o,n){var a,r,i,c;const d=R.findIndex(t=>t.idproducto==e);if(d>-1)t<=0&&(t=0,R[d].total=0),o?R[d].cantidad+=t:R[d].cantidad=t,R[d].subtotal=parseInt(R[d].valorunidad)*R[d].cantidad,R[d].total=R[d].subtotal,R[d].valorimp=parseFloat((R[d].total*Z[null!==(a=R[d].impuesto)&&void 0!==a?a:0]).toFixed(3)),R[d].base=parseFloat((R[d].total-R[d].valorimp).toFixed(3)),u(),n&&((null==_?void 0:_.querySelector(`TR[data-id="${e}"] .inputcantidad`)).value=R[d].cantidad+""),(null===(i=null===(r=null==_?void 0:_.querySelector(`TR[data-id="${e}"]`))||void 0===r?void 0:r.children)||void 0===i?void 0:i[3]).textContent="$"+R[d].total.toLocaleString();else{const o=ee.find(t=>t.id==e),n=Number(o.precio_venta)*t*Z[null!==(c=o.impuesto)&&void 0!==c?c:"0"],a=Number(o.precio_venta)*t;var s={id:"",idproducto:null==o?void 0:o.id,tipoproducto:o.tipoproducto,tipoproduccion:o.tipoproduccion,idcategoria:o.idcategoria,nombreproducto:o.nombre,rendimientoestandar:o.rendimientoestandar,foto:o.foto,costo:o.precio_compra,valorunidad:o.precio_venta,cantidad:t,subtotal:a,base:a-n,impuesto:o.impuesto,valorimp:n,descuento:0,total:a};R=[...R,s],u(),l(e)}}function u(){const e={0:1,5:2,16:3,19:4,excluido:5,8:6},t={0:0,5:0,16:0,19:0,excluido:0,8:0},o=new Map;R.forEach(n=>{var a;if(n.impuesto)if(o.has(n.impuesto)){const e=o.get(n.impuesto)+n.total*Z[n.impuesto];o.set(n.impuesto,e)}else o.set(n.impuesto,n.total*Z[n.impuesto]);null==n.impuesto&&(n.impuesto="excluido"),t[n.impuesto]+=n.base;const r=null!==(a=o.get(n.impuesto))&&void 0!==a?a:0,i=K.findIndex(t=>t.id_impuesto==e[n.impuesto]);-1!=i?K[i]={id_impuesto:e[n.impuesto],facturaid:0,basegravable:t[n.impuesto],valorimpuesto:r}:K=[...K,{id_impuesto:e[n.impuesto],facturaid:0,basegravable:t[n.impuesto],valorimpuesto:r}]});let n=0;for(let e of o.values())n+=e;G.valorimpuestototal=parseFloat(n.toFixed(3)),G.subtotal=R.reduce((e,t)=>t.total+e,0),G.base=G.subtotal-G.valorimpuestototal,G.total=G.subtotal+G.valortarifa-G.descuento,document.querySelector("#subTotal").textContent="$"+G.subtotal.toLocaleString(),document.querySelector("#impuesto").textContent="$"+n.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}),document.querySelector("#valorTarifa").textContent="$"+G.valortarifa.toLocaleString(),document.querySelector("#total").textContent="$ "+G.total.toLocaleString(),C.textContent=R.reduce((e,t)=>t.cantidad+e,0)+""}function m(){document.querySelector("#totalPagar").textContent=""+G.total.toLocaleString();let e=0;H.forEach((t,o)=>{o>0&&(e+=parseInt(t.value.replace(/[,.]/g,"")))}),G.total<e&&(e=0,te.clear(),$(".mediopago").val(0)),document.querySelector(".Efectivo").value=""+(G.total-e).toLocaleString(),te.set("1",G.total-e),G.total-e==0&&te.has("1")&&te.delete("1"),p(document.querySelector("#recibio").value)}function p(e){e=e.replace(/[,.]/g,""),Number(e)>te.get("1")?document.querySelector("#cambio").textContent=(Number(e)-te.get("1")).toLocaleString()+"":document.querySelector("#cambio").textContent="0"}function v(e){const t=e.target;(t===I||t===A||t===F||t===B||t===T||t===P||t===N||t===M||t.closest(".salir")||t.closest(".novaciar")||t.closest(".sivaciar")||t.closest(".noguardar")||t.closest(".siguardar")||"Cancelar"==t.value)&&(I.close(),A.close(),F.close(),B.close(),T.close(),M.close(),N.close(),P.close(),document.removeEventListener("click",v),t.closest(".siguardar")&&(W="",g("Guardado","1")))}function g(e,t){return __awaiter(this,void 0,void 0,(function*(){var o,n,a;const r=document.querySelector('input[name="imprimir"]:checked'),i=new FormData;i.append("id",null!==(o=null==ne?void 0:ne.id)&&void 0!==o?o:""),i.append("idcliente",document.querySelector("#selectCliente").value),i.append("idvendedor",document.querySelector("#vendedor").dataset.idvendedor),i.append("idcaja",O.value),i.append("idconsecutivo",Y.value),i.append("iddireccion",S.value),i.append("idtarifazona",G.idtarifa+""),i.append("cliente","1"==h.value?"N/A":h.options[h.selectedIndex].textContent),i.append("vendedor",document.querySelector("#vendedor").value),i.append("caja",document.querySelector("#caja option:checked").textContent),i.append("tipofacturador",Y.options[Y.selectedIndex].textContent),i.append("direccion",null!==(a=null===(n=S.options[S.selectedIndex])||void 0===n?void 0:n.text)&&void 0!==a?a:""),i.append("tarifazona",X||""),i.append("carrito",JSON.stringify(R.filter(e=>e.cantidad>0))),i.append("totalunidades",C.textContent),i.append("mediosPago",JSON.stringify(Array.from(te,([e,t])=>({idmediopago:e,id_factura:0,valor:t})))),i.append("factimpuestos",JSON.stringify(K)),i.append("recibido",document.querySelector("#recibio").value),i.append("transaccion",""),i.append("tipoventa",W),i.append("cotizacion",t),i.append("estado",e),i.append("subtotal",G.subtotal+""),i.append("base",G.base.toFixed(3)),i.append("valorimpuestototal",G.valorimpuestototal+""),i.append("dctox100",G.dctox100+""),i.append("descuento",G.descuento+""),i.append("total",G.total.toString()),i.append("observacion",document.querySelector("#observacion").value),i.append("departamento",""),i.append("ciudad",document.querySelector("#ciudadEntrega").value),i.append("entrega",L.textContent.replace(": ","")),i.append("valortarifa",G.valortarifa+""),i.append("opc1",""),i.append("opc2","");try{const e="/admin/api/facturar",t=yield fetch(e,{method:"POST",body:i}),o=yield t.json();console.log(o),void 0!==o.exito?(msjalertToast("success","¡Éxito!",o.exito[0]),function(){for((null==ne?void 0:ne.id)&&(ne.id=""),te.clear(),$(".mediopago").val(0),R.length=0,K.length=0,history.replaceState({},"","/admin/ventas");null==_?void 0:_.firstChild;)_.removeChild(null==_?void 0:_.firstChild);document.querySelector("#npedido").value="",document.querySelector("#subTotal").textContent="$0",document.querySelector("#descuento").textContent="$0",document.querySelector("#total").textContent="$0",$("#selectCliente").val(1).trigger("change");for(const e in G)G[e]=0}(),o.idfactura&&"1"===r.value&&(c=o.idfactura,setTimeout(()=>{window.open("/admin/printPDFPOS?id="+c,"_blank")},1200))):msjalertToast("error","¡Error!",o.error[0])}catch(e){console.log(e)}var c;B.close(),document.getElementById("miDialogoCarritoMovil").close(),document.removeEventListener("click",v)}))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allproducts",t=yield fetch(e);ee=yield t.json(),console.log(ee)}catch(e){console.log(e)}})),$("#selectCliente").select2(),i(O),O.addEventListener("change",e=>i(e.target)),null==f||f.addEventListener("click",e=>{T.showModal(),document.addEventListener("click",v)}),null==y||y.addEventListener("click",e=>{M.showModal(),document.addEventListener("click",v)}),null===(e=document.querySelector("#formAddCliente"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault(),__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("nombre",document.querySelector("#nombreclientenuevo").value),e.append("apellido",document.querySelector("#clientenuevoapellido").value),e.append("tipodocumento",document.querySelector("#tipodocumento").value),e.append("identificacion",document.querySelector("#identificacion").value),e.append("telefono",document.querySelector("#telefono").value),e.append("email",document.querySelector("#clientenuevoemail").value),e.append("idtarifa",document.querySelector("#clientenuevotarifa").value),e.append("direccion",document.querySelector("#clientenuevodireccion").value),e.append("departamento",document.querySelector("#departamento").value),e.append("ciudad",document.querySelector("#ciudad").value);try{const t="/admin/api/apiCrearCliente",o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),function(e){const t=document.createElement("option");t.textContent=document.querySelector("#nombreclientenuevo").value+" "+document.querySelector("#clientenuevoapellido").value,t.value=e,t.dataset.tipodocumento=document.querySelector("#tipodocumento").value,t.dataset.identidad=document.querySelector("#identificacion").value,null==h||h.appendChild(t),$("#selectCliente").val(e).trigger("change")}(n.nextID),function(){var e;null===(e=document.querySelector("#formAddCliente"))||void 0===e||e.reset()}()):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}})),T.close(),document.removeEventListener("click",v)}),$("#selectCliente").on("change",e=>{const t=e.target.value;__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/direccionesXcliente?id="+t,o=yield fetch(e);c(yield o.json())}catch(e){console.log(e)}}));const o=e.target,n=o.options[o.selectedIndex].dataset.identidad||"";document.querySelector("#documento").value=n}),null==S||S.addEventListener("change",e=>{const t=e.target,o=t.options[t.selectedIndex].dataset.ciudad||"";document.querySelector("#ciudadEntrega").value=o,d(),u()}),null===(t=document.querySelector("#formAddDir"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault(),__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("idcliente",h.value),e.append("departamento",document.querySelector("#adddepartamento").value),e.append("ciudad",document.querySelector("#addciudad").value),e.append("direccion",document.querySelector("#adddireccion").value),e.append("idtarifa",document.querySelector("#tarifa").value);try{const t="/admin/api/addDireccionCliente",o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),c(n.direcciones)):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}})),M.close(),document.removeEventListener("click",v)}),null==q||q.addEventListener("click",e=>{": Presencial"==L.textContent?L.textContent=": Domicilio":L.textContent=": Presencial",d(),u()}),b.addEventListener("click",e=>{N.showModal(),document.addEventListener("click",v)}),w.addEventListener("click",e=>{P.showModal(),document.addEventListener("click",v)}),null===(o=document.querySelector("#formOtrosProductos"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault();const t=e.target.elements,o=Number(t.namedItem("cantidadotros").value),n=Number(t.namedItem("preciootros").value);Q.id+=-1,Q.nombre=t.namedItem("nombreotros").value,Q.cantidad=o,Q.valorunidad=n/o,Q.total=n,ee=[...ee,{id:Q.id+"",idcategoria:"-1",idunidadmedida:"1",nombre:Q.nombre,foto:"na",impuesto:"0",marca:"na",tipoproducto:"-1",tipoproduccion:"-1",codigo:"-1",unidadmedida:"Unidad",descripcion:"na",peso:"na",medidas:"na",color:"na",funcion:"na",uso:"na",fabricante:"na",garantia:"na",stock:"0",stockminimo:"1",categoria:"na",rendimientoestandar:"1",precio_compra:"na",precio_venta:Q.valorunidad+"",fecha_ingreso:"",estado:"1",visible:"1"}],s(Q.id+"",o,!1,!1),P.close(),document.removeEventListener("click",v)}),null==x||x.addEventListener("click",e=>{var t,o;const n=null===(t=e.target)||void 0===t?void 0:t.closest(".producto"),a=R.find(e=>e.idproducto==n.dataset.id);if(window.innerWidth<992){const e=document.createElement("div");e.className="popup absolute z-40 right-8 top-1/3 opacity-0 translate-x-0 translate-y-0 transition-all duration-500 w-10 h-10 rounded-full text-center grid place-items-center bg-teal-400 text-white font-semibold text-lg",e.innerHTML=""+((null!==(o=null==a?void 0:a.cantidad)&&void 0!==o?o:0)+1),n.appendChild(e),requestAnimationFrame(()=>{e.classList.remove("opacity-0","translate-y-0","translate-x-0"),e.classList.add("opacity-100","-translate-y-14","translate-x-10")});const t=document.querySelectorAll(".popup");setTimeout(()=>{t.forEach(e=>{e.remove()})},2500)}n&&s(n.dataset.id,1,!0,!0)}),null==_||_.addEventListener("click",e=>{var t,o,n;const a=(null===(t=e.target)||void 0===t?void 0:t.closest(".productselect")).dataset.id;if(e.target.classList.contains("menos")){const e=R.find(e=>e.idproducto==a);s(a,e.cantidad-1,!1,!0)}if(e.target.classList.contains("inputcantidad")&&"eventInput"!=e.target.dataset.event&&(null===(o=e.target)||void 0===o||o.addEventListener("input",e=>{let t=e.target.value;t=t.replace(/[^0-9.]/g,"");const o=t.split(".");o.length>2&&(t=o[0]+"."+o.slice(1).join("")),t.startsWith(".")&&(t="1"),(""===t||isNaN(parseFloat(t)))&&(t="0"),e.target.value=t,s(a,Number(e.target.value),!1,!1)}),e.target.dataset.event="eventInput"),e.target.classList.contains("mas")){const e=R.find(e=>e.idproducto==a);s(a,e.cantidad+1,!1,!0)}(e.target.classList.contains("eliminarProducto")||"I"==e.target.tagName)&&(R=R.filter(e=>e.idproducto!=a),u(),null===(n=null==_?void 0:_.querySelector(`TR[data-id="${a}"]`))||void 0===n||n.remove())}),null==E||E.addEventListener("click",()=>{R.length&&(J=G.subtotal,I.showModal(),document.addEventListener("click",v))}),null==D||D.addEventListener("click",()=>{R.length&&(F.showModal(),document.addEventListener("click",v))}),null==j||j.addEventListener("click",()=>{var e,t;(": Domicilio"!==L.textContent||"1"!=h.value&&S.value)&&"1"!=h.value?R.length&&(null===(e=document.querySelector("#inputscreditos"))||void 0===e||e.classList.add("flex"),null===(t=document.querySelector("#inputscreditos"))||void 0===t||t.classList.remove("hidden"),W="Credito",m(),B.showModal(),document.addEventListener("click",v)):msjAlert("error","Cliente o direccion no seleccionado",document.querySelector("#divmsjalerta1"))}),null==k||k.addEventListener("click",()=>{var e,t;": Domicilio"!==L.textContent||"1"!=h.value&&S.value?R.length&&(null===(e=document.querySelector("#inputscreditos"))||void 0===e||e.classList.add("hidden"),null===(t=document.querySelector("#inputscreditos"))||void 0===t||t.classList.remove("flex"),W="Contado",m(),B.showModal(),document.addEventListener("click",v)):msjAlert("error","Cliente o direccion no seleccionado",document.querySelector("#divmsjalerta1"))}),U.forEach(e=>{e.addEventListener("change",e=>{"porcentaje"===e.target.value&&(J=100,z.value=""),"valor"===e.target.value&&(z.value="",J=G.subtotal)})}),null==z||z.addEventListener("input",e=>{var t=Number(e.target.value);t>J&&(z.value=J+"",t=J)}),null===(n=document.querySelector("#formDescuento"))||void 0===n||n.addEventListener("submit",e=>{e.preventDefault();const t=Number(z.value);U[0].checked&&(G.dctox100=Math.round(100*t/G.subtotal),G.descuento=t),U[1].checked&&(G.descuento=G.subtotal*t/100,G.dctox100=t),G.total=G.subtotal-G.descuento+G.valortarifa,document.querySelector("#total").textContent="$ "+G.total.toLocaleString(),document.querySelector("#descuento").textContent="$"+G.descuento.toLocaleString(),I.close(),document.removeEventListener("click",v)}),H.forEach(e=>{e.addEventListener("input",e=>{!function(e){var t;let o=0;H.forEach((e,t)=>{t>0&&(o+=parseInt(e.value.replace(/[,.]/g,"")))}),o<=G.total?(te.set("1",G.total-o),G.total-o==0&&te.has("1")&&te.delete("1"),te.set(e.target.id,parseInt(e.target.value.replace(/[,.]/g,""))),"0"==e.target.value&&te.has(e.target.id)&&te.delete(e.target.id)):te.has(e.target.id)?e.target.value=te.get(e.target.id).toLocaleString():e.target.value="0";H[0].value=(null!==(t=te.get("1"))&&void 0!==t?t:0).toLocaleString(),p(document.querySelector("#recibio").value)}(e)})}),null===(a=document.querySelector("#recibio"))||void 0===a||a.addEventListener("input",e=>{p(e.target.value)}),null===(r=document.querySelector("#formfacturar"))||void 0===r||r.addEventListener("submit",e=>{e.preventDefault(),G.total<=0||G.subtotal<=0?msjAlert("error","No se puede procesar pago con $0",document.querySelector("#divmsjalerta2")):g("Paga","0")});const oe=new URLSearchParams(window.location.search).get("id");let ne;oe&&__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/getcotizacion_venta?id="+oe,t=yield fetch(e),o=yield t.json();ne=o.factura,R=o.productos,console.log(R),R.forEach(e=>l(e.idproducto)),u(),document.querySelector("#npedido").value=ne.num_orden,$("#selectCliente").val(ne.idcliente).trigger("change")}catch(e){console.log(e)}}))}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};!function(){if(document.querySelector(".contenedorsetup")){const e=document.querySelectorAll('.contenedorsetup input[type="radio"]'),t=document.querySelectorAll(".keyinput"),o=document.querySelector("#porcentaje_de_impuesto");e.forEach(e=>{e.addEventListener("change",()=>{const t=e.name,o=document.querySelector(`input[name="${t}"]:checked`);console.log(`${t}, Opción seleccionada: ${o.value}`),function(e,t){const o=new FormData;o.append(e,t),(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/parametrosSistema",t=yield fetch(e,{method:"POST",body:o}),n=yield t.json();void 0!==n.exito?msjalertToast("success","¡Éxito!",n.exito[0]):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))})()}(t,o.value)})}),t.forEach(e=>{e.addEventListener("input",e=>{const t=e.target,o=e.target.value;(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append(t.name,o);try{const o="/admin/api/parametrosSistemaClaves",n=yield fetch(o,{method:"POST",body:e}),a=yield n.json();void 0!==a.exito?(t.style.color="#02db02",t.style.fontWeight="500"):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))})()})}),null==o||o.addEventListener("input",e=>{console.log(e.target.value),(()=>{__awaiter(this,void 0,void 0,(function*(){const t=new FormData;t.append("porcentaje_de_impuesto",e.target.value);try{const e="/admin/api/parametrosSistemaPorcentajeImpuesto",o=yield fetch(e,{method:"POST",body:t}),n=yield o.json();void 0!==n.exito?msjalertToast("success","¡Éxito!",n.exito[0]):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))})()})}}();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".facturasanuladasxx")){const n=document.querySelector("#consultarFechaPersonalizada"),a=document.querySelector("#btnmesactual"),r=document.querySelector("#btnmesanterior"),i=document.querySelector("#btnhoy"),c=document.querySelector("#btnayer");let d,l="",s="",u=[];function e(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function t(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const n=new FormData;n.append("fechainicio",e),n.append("fechafin",t);try{const e="/admin/api/facturasanuladas",t=yield fetch(e,{method:"POST",body:n}),a=yield t.json();u=a,o(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function o(){d=$("#tablaFacturasAnuladas").DataTable({responsive:!0,destroy:!0,data:u,columns:[{title:"Orden",data:"num_orden"},{title:"N° Factura",data:"num_consecutivo"},{title:"Tipo",data:"tipofacturador"},{title:"Cant vendida",data:"totalunidades"},{title:"B. gravable",data:"base",render:e=>"$"+Number(e).toLocaleString()},{title:"Imp",data:"valorimpuestototal"},{title:"Descuento",data:"descuento"},{title:"Total",data:"total",render:e=>"$"+Number(e).toLocaleString()},{title:"Vendedor",data:"vendedor"},{title:"Caja",data:"caja"}],pageLength:25,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"facturas procesadas"},{extend:"csvHtml5",title:"facturas procesadas"},{extend:"pdfHtml5",title:"facturas procesadas"},{extend:"print",title:"facturas procesadas",text:"Imprimir"},"colvis"],pageLength:"pageLength"}}})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");l=o,s=n})),a.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth(),1),a=new Date(o.getFullYear(),o.getMonth()+1,0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth()-1,1),a=new Date(o.getFullYear(),o.getMonth(),0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),i.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),r=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);t(e(a),e(r))}),c.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);t(e(r),e(i))}),n.addEventListener("click",()=>{""!=l&&""!=s?t(l,s):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),o()}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".facturasanuladasxxz")){const n=document.querySelector("#consultarFechaPersonalizada"),a=document.querySelector("#btnmesactual"),r=document.querySelector("#btnmesanterior"),i=document.querySelector("#btnhoy"),c=document.querySelector("#btnayer");let d,l="",s="",u=[];function e(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function t(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const n=new FormData;n.append("fechainicio",e),n.append("fechafin",t);try{const e="/admin/api/facturasanuladas",t=yield fetch(e,{method:"POST",body:n}),a=yield t.json();u=a,o(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function o(){d=$("#tablaFacturasAnuladas").DataTable({responsive:!0,destroy:!0,data:u,columns:[{title:"Orden",data:"num_orden"},{title:"N° Factura",data:"num_consecutivo"},{title:"Tipo",data:"tipofacturador"},{title:"Cant vendida",data:"totalunidades"},{title:"B. gravable",data:"base",render:e=>"$"+Number(e).toLocaleString()},{title:"Imp",data:"valorimpuestototal"},{title:"Descuento",data:"descuento"},{title:"Total",data:"total",render:e=>"$"+Number(e).toLocaleString()},{title:"Vendedor",data:"vendedor"},{title:"Caja",data:"caja"}],pageLength:25,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"facturas procesadas"},{extend:"csvHtml5",title:"facturas procesadas"},{extend:"pdfHtml5",title:"facturas procesadas"},{extend:"print",title:"facturas procesadas",text:"Imprimir"},"colvis"],pageLength:"pageLength"}}})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");l=o,s=n})),a.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth(),1),a=new Date(o.getFullYear(),o.getMonth()+1,0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth()-1,1),a=new Date(o.getFullYear(),o.getMonth(),0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),i.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),r=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);t(e(a),e(r))}),c.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);t(e(r),e(i))}),n.addEventListener("click",()=>{""!=l&&""!=s?t(l,s):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),o()}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".facturasprocesadas")){const n=document.querySelector("#consultarFechaPersonalizada"),a=document.querySelector("#btnmesactual"),r=document.querySelector("#btnmesanterior"),i=document.querySelector("#btnhoy"),c=document.querySelector("#btnayer");let d,l="",s="",u=[];function e(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function t(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const n=new FormData;n.append("fechainicio",e),n.append("fechafin",t);try{const e="/admin/api/facturaspagas",t=yield fetch(e,{method:"POST",body:n}),a=yield t.json();u=a,o(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function o(){d=$("#tablaFacturasProcesadas").DataTable({responsive:!0,destroy:!0,data:u,columns:[{title:"Orden",data:"num_orden"},{title:"N° Factura",data:"num_consecutivo"},{title:"Tipo",data:"tipofacturador"},{title:"Cant vendida",data:"totalunidades"},{title:"B. gravable",data:"base",render:e=>"$"+Number(e).toLocaleString()},{title:"Imp",data:"valorimpuestototal"},{title:"Descuento",data:"descuento"},{title:"Total",data:"total",render:e=>"$"+Number(e).toLocaleString()},{title:"Vendedor",data:"vendedor"},{title:"Caja",data:"caja"}],pageLength:25,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"facturas procesadas"},{extend:"csvHtml5",title:"facturas procesadas"},{extend:"pdfHtml5",title:"facturas procesadas"},{extend:"print",title:"facturas procesadas",text:"Imprimir"},"colvis"],pageLength:"pageLength"}}})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");l=o,s=n})),a.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth(),1),a=new Date(o.getFullYear(),o.getMonth()+1,0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth()-1,1),a=new Date(o.getFullYear(),o.getMonth(),0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),i.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),r=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);t(e(a),e(r))}),c.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);t(e(r),e(i))}),n.addEventListener("click",()=>{""!=l&&""!=s?t(l,s):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),o()}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".facturasanuladas")){const n=document.querySelector("#consultarFechaPersonalizada"),a=document.querySelector("#btnmesactual"),r=document.querySelector("#btnmesanterior"),i=document.querySelector("#btnhoy"),c=document.querySelector("#btnayer");let d,l="",s="",u=[];function e(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function t(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const n=new FormData;n.append("fechainicio",e),n.append("fechafin",t);try{const e="/admin/api/facturasanuladas",t=yield fetch(e,{method:"POST",body:n}),a=yield t.json();u=a,o(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function o(){d=$("#tablaFacturasAnuladas").DataTable({responsive:!0,destroy:!0,data:u,columns:[{title:"Orden",data:"num_orden"},{title:"N° Factura",data:"num_consecutivo"},{title:"Tipo",data:"tipofacturador"},{title:"Cant vendida",data:"totalunidades"},{title:"B. gravable",data:"base",render:e=>"$"+Number(e).toLocaleString()},{title:"Imp",data:"valorimpuestototal"},{title:"Descuento",data:"descuento"},{title:"Total",data:"total",render:e=>"$"+Number(e).toLocaleString()},{title:"Vendedor",data:"vendedor"},{title:"Caja",data:"caja"}],pageLength:25,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"facturas procesadas"},{extend:"csvHtml5",title:"facturas procesadas"},{extend:"pdfHtml5",title:"facturas procesadas"},{extend:"print",title:"facturas procesadas",text:"Imprimir"},"colvis"],pageLength:"pageLength"}}})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");l=o,s=n})),a.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth(),1),a=new Date(o.getFullYear(),o.getMonth()+1,0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth()-1,1),a=new Date(o.getFullYear(),o.getMonth(),0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),i.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),r=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);t(e(a),e(r))}),c.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);t(e(r),e(i))}),n.addEventListener("click",()=>{""!=l&&""!=s?t(l,s):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),o()}})(),(()=>{if(document.querySelector(".inventarioxproducto")){let e;e=$("#tablaStockRapido").DataTable(configdatatablesstockrapido)}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".facturasprocesadasza")){const n=document.querySelector("#consultarFechaPersonalizada"),a=document.querySelector("#btnmesactual"),r=document.querySelector("#btnmesanterior"),i=document.querySelector("#btnhoy"),c=document.querySelector("#btnayer");let d,l="",s="",u=[];function e(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function t(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const n=new FormData;n.append("fechainicio",e),n.append("fechafin",t);try{const e="/admin/api/facturaspagas",t=yield fetch(e,{method:"POST",body:n}),a=yield t.json();u=a,o(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function o(){d=$("#tablaFacturasProcesadas").DataTable({responsive:!0,destroy:!0,data:u,columns:[{title:"Orden",data:"num_orden"},{title:"N° Factura",data:"num_consecutivo"},{title:"Tipo",data:"tipofacturador"},{title:"Cant vendida",data:"totalunidades"},{title:"B. gravable",data:"base",render:e=>"$"+Number(e).toLocaleString()},{title:"Imp",data:"valorimpuestototal"},{title:"Descuento",data:"descuento"},{title:"Total",data:"total",render:e=>"$"+Number(e).toLocaleString()},{title:"Vendedor",data:"vendedor"},{title:"Caja",data:"caja"}],pageLength:25,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}},layout:{topStart:{buttons:[{extend:"copyHtml5",text:"Copia"},{extend:"excelHtml5",title:"facturas procesadas"},{extend:"csvHtml5",title:"facturas procesadas"},{extend:"pdfHtml5",title:"facturas procesadas"},{extend:"print",title:"facturas procesadas",text:"Imprimir"},"colvis"],pageLength:"pageLength"}}})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");l=o,s=n})),a.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth(),1),a=new Date(o.getFullYear(),o.getMonth()+1,0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth()-1,1),a=new Date(o.getFullYear(),o.getMonth(),0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),i.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),r=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);t(e(a),e(r))}),c.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);t(e(r),e(i))}),n.addEventListener("click",()=>{""!=l&&""!=s?t(l,s):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),o()}})(),(()=>{if(document.querySelector(".utilidadxproducto")){let e;e=$("#tablaUtilidadXProducto").DataTable(configdatatablesgenerico)}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".ventasxtransaccion")){const a=document.querySelector("#btnmensual"),r=document.querySelector("#btndiario"),i=document.querySelector("#miDialogoMes"),c=document.querySelector("#miDialogoDiario");let d,l=[];function o(){d=$("#tablaTransaccioneXVenta").DataTable({destroy:!0,data:l,columns:[{title:"Fecha",data:"fecha"},{title:"Toal venta",data:"total_venta",render:e=>"$"+Number(e).toLocaleString()},{title:"Numero de transacciones",data:"num_transacciones"},{title:"Promedio por transacción",data:"promedio_transaccion"},{title:"Transacción mas alta",data:"transaccion_mas_alta"},{title:"Transacción mas baja",data:"transaccion_mas_baja"}]})}function n(e){const t=e.target;(t===i||t===c||t.closest(".salir"))&&(i.close(),c.close(),document.removeEventListener("click",n))}null==a||a.addEventListener("click",()=>{i.showModal(),document.addEventListener("click",n)}),null==r||r.addEventListener("click",()=>{c.showModal(),document.addEventListener("click",n)}),null===(e=document.querySelector("#formMes"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault();const t=document.querySelector("#inputselectaño");__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/ventasxtransaccionanual?x="+t.value,n=yield fetch(e),a=yield n.json();l=a,console.log(a),o()}catch(e){console.log(e)}})),i.close(),document.removeEventListener("click",n)}),null===(t=document.querySelector("#formDiario"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault();const t=document.querySelector("#inputselectmesyaño");__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/ventasxtransaccionmes?x="+t.value,n=yield fetch(e),a=yield n.json();l=a,o()}catch(e){console.log(e)}})),c.close(),document.removeEventListener("click",n)}),o()}})();__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(a,r){function i(e){try{d(n.next(e))}catch(e){r(e)}}function c(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,c)}d((n=n.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".ventasxcliente")){const n=document.querySelector("#consultarFechaPersonalizada"),a=document.querySelector("#btnmesactual"),r=document.querySelector("#btnmesanterior"),i=document.querySelector("#btnhoy"),c=document.querySelector("#btnayer");let d,l="",s="",u=[];function e(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function t(e,t){return __awaiter(this,void 0,void 0,(function*(){console.log(e,t),document.querySelector(".content-spinner1").style.display="grid";const n=new FormData;n.append("fechainicio",e),n.append("fechafin",t);try{const e="/admin/api/ventasxcliente",t=yield fetch(e,{method:"POST",body:n}),a=yield t.json();u=a,o(),document.querySelector(".content-spinner1").style.display="none"}catch(e){console.log(e)}}))}function o(){d=$("#tablaVentasXCliente").DataTable({destroy:!0,data:u,columns:[{title:"Nombre",data:"nombre"},{title:"Cantidad_facturas",data:"cantidad_facturas"},{title:"Total ventas",data:"total_ventas",render:e=>"$"+Number(e).toLocaleString()}]})}$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),n=t.endDate.format("YYYY-MM-DD HH:mm:ss");l=o,s=n})),a.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth(),1),a=new Date(o.getFullYear(),o.getMonth()+1,0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),r.addEventListener("click",e=>{const o=new Date,n=new Date(o.getFullYear(),o.getMonth()-1,1),a=new Date(o.getFullYear(),o.getMonth(),0);t(n.toISOString().split("T")[0],a.toISOString().split("T")[0])}),i.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),r=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);t(e(a),e(r))}),c.addEventListener("click",o=>{const n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);t(e(r),e(i))}),n.addEventListener("click",()=>{""!=l&&""!=s?t(l,s):msjalertToast("error","¡Error!","Elegir fechas a consultar")}),o()}})();
//# sourceMappingURL=bundle.ts.js.map
