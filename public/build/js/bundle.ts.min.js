"use strict";const mobilemenu=document.querySelector("#mobile-menu"),sidebar=document.querySelector(".sidebar"),btnmenux=document.querySelector("#mobile-menux"),barra=document.querySelector(".barra-mobile"),nametop=document.querySelector(".nametop");mobilemenu&&mobilemenu.addEventListener("click",(function(){sidebar&&barra&&(sidebar.classList.toggle("mostrar"),barra.classList.toggle("ocultarmenu"))})),btnmenux&&btnmenux.addEventListener("click",(function(){sidebar&&barra&&(sidebar.classList.toggle("mostrar"),barra.classList.toggle("ocultarmenu"))})),document.querySelector(".sidebartoggle").addEventListener("click",e=>{sidebar&&(null==sidebar||sidebar.classList.toggle("minsidebar")),nametop&&nametop.classList.toggle("noneElement"),$(".btnav").toggleClass("noneElement")});const configdatatables={paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,responsive:!0,deferRender:!0,retrieve:!0,processing:!0,language:{search:"Busqueda",emptyTable:"No Hay datos disponibles",zeroRecords:"No se encontraron registros coincidentes",lengthMenu:"_MENU_ Entradas por pagina",info:"Mostrando pagina _PAGE_ de _PAGES_",infoEmpty:"No hay entradas a mostrar",infoFiltered:" (filtrado desde _MAX_ registros)",paginate:{first:"<<",last:">>",next:">",previous:"<"}}};function msjAlert(e,t,o){o.insertAdjacentHTML("beforeend",`<div class="alerta alerta__${e}">\n      <p><i class="fa-solid fa-circle-exclamation"></i> ${t}</p></div>`),borrarMsjAlert(o)}function borrarMsjAlert(e){document.querySelector(".alerta")&&setTimeout(()=>{for(;e.firstChild;)e.removeChild(e.firstChild)},5e3)}function msjalertToast(e,t,o){Swal.fire({icon:e,title:t,text:o,toast:!0,position:"top-end",showConfirmButton:!1,timer:2700})}if(document.querySelectorAll(".count-charts").forEach(e=>{var t;e.textContent=(parseInt(e.dataset.num)-e.previousElementSibling.value.length).toString(),null===(t=e.previousElementSibling)||void 0===t||t.addEventListener("input",t=>{if(e.textContent=parseInt(e.dataset.num)-t.target.value.length+"",parseInt(e.dataset.num)-t.target.value.length<=0){let o=t.target.value.slice(0,parseInt(e.dataset.num));t.target.value=o,e.textContent="0"}})}),document.querySelector("#tabulacion")){const e=document.querySelector('#tabulacion input[type="radio"]:checked').nextElementSibling;document.querySelector("."+e.id).style.display="block";const t=document.querySelectorAll(".tabs span"),o=document.querySelectorAll(".paginas");t.forEach(e=>{e.addEventListener("click",e=>{const t=e.target;o.forEach(e=>e.style.display="none"),document.querySelector("."+t.id).style.display="block"})})}var __awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e,t,o;if(document.querySelector(".clientes")){const n=document.querySelector("#crearCliente"),i=document.querySelector("#crearDireccion"),r=document.querySelector("#miDialogoCliente"),c=document.querySelector("#miDialogoCrearDireccion"),d=document.querySelector("#miDialogoUpDireccion"),l=document.querySelector("#selectdirecciones"),u=document.querySelector("#btnCerrarUpDireccion");let s,m,v=0,p=0,f=[],g=[];function a(e){e.target!==r&&e.target!==c&&e.target!==d&&"salir"!==e.target.value||(r.close(),c.close(),d.close(),document.removeEventListener("click",a))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allclientes",t=yield fetch(e);g=yield t.json(),console.log(g)}catch(e){console.log(e)}})),s=$("#tablaClientes").DataTable(configdatatables),null==n||n.addEventListener("click",e=>{p=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateCliente"))||void 0===e||e.reset()}(),document.querySelector("#modalCliente").textContent="Crear cliente",document.querySelector("#btnEditarCrearCliente").value="Crear",r.showModal(),document.addEventListener("click",a)}),null==i||i.addEventListener("click",e=>{p=0,document.querySelector("#modalDireccion").textContent="Crear direccion",document.querySelector("#btnEditarCrearDireccion").value="Crear",c.showModal(),document.addEventListener("click",a),$("#selectcliente").select2({dropdownParent:$("#miDialogoCrearDireccion"),placeholder:"Seleccionar el cliente",maximumSelectionLength:1})}),null===(e=document.querySelector("#tablaClientes"))||void 0===e||e.addEventListener("click",e=>{var t,o,n,i;const c=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarClientes"))||(null===(o=e.target.parentElement)||void 0===o?void 0:o.classList.contains("editarClientes")))&&function(e){var t,o,n,i,c,d,l,u,s;let v=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(o=e.target)||void 0===o?void 0:o.tagName)&&(v=null===(i=null===(n=e.target.parentElement)||void 0===n?void 0:n.parentElement)||void 0===i?void 0:i.id);p=1,document.querySelector("#modalCliente").textContent="Actualizar cliente",document.querySelector("#btnEditarCrearCliente").value="Actualizar",m=g.find(e=>e.id===v),document.querySelector("#nombre").value=null==m?void 0:m.nombre,document.querySelector("#apellido").value=null==m?void 0:m.apellido,$("#tipodocumento").val(null!==(c=null==m?void 0:m.tipodocumento)&&void 0!==c?c:""),document.querySelector("#identificacion").value=null!==(d=null==m?void 0:m.identificacion)&&void 0!==d?d:"",document.querySelector("#telefono").value=null!==(l=null==m?void 0:m.telefono)&&void 0!==l?l:"",document.querySelector("#email").value=null!==(u=null==m?void 0:m.email)&&void 0!==u?u:"",document.querySelector("#fecha_nacimiento").value=null!==(s=null==m?void 0:m.fecha_nacimiento)&&void 0!==s?s:"",r.showModal(),document.addEventListener("click",a)}(e),((null==c?void 0:c.classList.contains("eliminarClientes"))||(null===(n=c.parentElement)||void 0===n?void 0:n.classList.contains("eliminarClientes")))&&function(e){let t=e.target.parentElement.id,o=s.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);v=s.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el cliente?",text:"El cliente sera eliminado por completo.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarCliente",a=yield fetch(t,{method:"POST",body:e}),n=yield a.json();void 0!==n.exito?(s.row(v+o.start).remove().draw(),s.page(o.page).draw("page"),Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e),((null==c?void 0:c.classList.contains("editarEliminarDireccion"))||(null===(i=c.parentElement)||void 0===i?void 0:i.classList.contains("editarEliminarDireccion")))&&function(e){let t=e.target.parentElement.id;s.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/direccionesXcliente?id="+t,o=yield fetch(e),a=yield o.json();f=a,function(e){for(;null==l?void 0:l.firstChild;)l.removeChild(null==l?void 0:l.firstChild);e.forEach(e=>{const t=document.createElement("option");t.textContent=e.direccion,t.value=e.id,t.dataset.idcliente=e.idcliente,t.dataset.idtarifa=e.idtarifa,l.appendChild(t)}),$("#uptarifa").val(e[0].idtarifa),document.querySelector("#updepartamento").value=e[0].departamento,document.querySelector("#upciudad").value=e[0].ciudad,document.querySelector("#updireccion").value=e[0].direccion}(a)}catch(e){console.log(e)}}))})(),d.showModal(),document.addEventListener("click",a)}(e)}),null===(t=document.querySelector("#formCrearUpdateCliente"))||void 0===t||t.addEventListener("submit",e=>{if(p){e.preventDefault();var t=s.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",m.id),e.append("nombre",$("#nombre").val()),e.append("apellido",$("#apellido").val()),e.append("tipodocumento",$("#tipodocumento").val()),e.append("identificacion",$("#identificacion").val()),e.append("telefono",$("#telefono").val()),e.append("email",$("#email").val()),e.append("fecha_nacimiento",$("#fecha_nacimiento").val());try{const o="/admin/api/actualizarCliente",n=yield fetch(o,{method:"POST",body:e}),i=yield n.json();if(console.log(i),void 0!==i.exito){msjalertToast("success","¡Éxito!",i.exito[0]),g.forEach(e=>{e.id==m.id&&(e=Object.assign(e,i.cliente[0]))});const e=s.row(v).data();e[1]=$("#nombre").val(),e[2]=$("#apellido").val(),e[3]=$("#telefono").val(),e[4]=$("#email").val(),s.row(v).data(e).draw(),s.page(t.page).draw("page")}else msjalertToast("error","¡Error!",i.error[0]);r.close(),document.removeEventListener("click",a)}catch(e){console.log(e)}}))}}),null==l||l.addEventListener("change",e=>{var t;const o=e.target,a=o.options[o.selectedIndex].value,n=f.find(e=>e.id==a);$("#uptarifa").val(null!==(t=null==n?void 0:n.idtarifa)&&void 0!==t?t:1),document.querySelector("#updepartamento").value=n.departamento,document.querySelector("#upciudad").value=n.ciudad,document.querySelector("#updireccion").value=n.direccion}),null===(o=document.querySelector("#formUpDireccion"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault()}),u.addEventListener("click",()=>d.close())}})(),function(){var e;if(document.querySelector(".inicio")){const t=null===(e=document.getElementById("chartventas"))||void 0===e?void 0:e.getContext("2d");new Chart(t,{type:"line",data:{labels:["25-8-2024","26-8-2024","27-8-2024","28-8-2024","29-8-2024","30-8-2024","31-8-2024","01-09-2024"],datasets:[{label:"# of Votes",data:[8,9,3,5,8,4,2,5],borderColor:"#7C3AED",backgroundColor:"#00c8c2",tension:.3}]},options:{scales:{y:{beginAtZero:!0}},plugins:{legend:{display:!1}}}})}}();const mobilemenu1=document.querySelector("#mobile-menu1"),miDialogomenumovil=document.querySelector("#miDialogomenumovil");function cerrarDialogoExterno(e){e.target===miDialogomenumovil&&(miDialogomenumovil.close(),miDialogomenumovil.setAttribute("hidden","true"),document.removeEventListener("click",cerrarDialogoExterno))}miDialogomenumovil.close(),miDialogomenumovil.setAttribute("hidden","true"),mobilemenu1.addEventListener("click",()=>{miDialogomenumovil.showModal(),miDialogomenumovil.removeAttribute("hidden"),document.addEventListener("click",cerrarDialogoExterno)}),(()=>{if(document.querySelector(".perfil")){const t=document.querySelector("#btnCambiarEmail"),o=document.querySelector("#miDialogoUpEmail");function e(t){t.target!==o&&"salir"!==t.target.value||(o.close(),document.removeEventListener("click",e))}null==t||t.addEventListener("click",t=>{o.showModal(),document.addEventListener("click",e)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".ajustarcostos")){let t,o=[];__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",a=yield fetch(e);o=yield a.json(),console.log(o),o.forEach(e=>{var t;const o=null===(t=document.querySelector(`tr[data-idsubproducto="${e.idsubproducto}"]`))||void 0===t?void 0:t.children[5].children[0],a=document.createElement("option");a.textContent=e.nombreunidaddestino,a.dataset.factor=e.factorconversion,null==o||o.appendChild(a)}),t=$("#tablaAjustarCostos").DataTable(configdatatables)}catch(e){console.log(e)}})),null===(e=document.querySelector("#tablaAjustarCostos"))||void 0===e||e.addEventListener("input",e=>{var t,o=e.target;let a="",n="";if(o.classList.contains("inputAjustarCosto")){var i=o.closest("tr");const e=null==i?void 0:i.querySelector(".formulario__select"),c=Number(e.options[e.selectedIndex].dataset.factor);var r=o.closest(".fila");r||(r=null===(t=o.closest("tr"))||void 0===t?void 0:t.previousSibling),r.classList.contains("producto")?(n=r.dataset.idproducto,a="0"):(n=r.dataset.idsubproducto,a="1"),function(e,t,o,a){""==a.value&&(a.value="0");const n=Number(a.value)/o;console.log(n),(()=>{__awaiter(this,void 0,void 0,(function*(){const o=new FormData;o.append("tipoelemento",e),o.append("idelemento",t),o.append("precio_compra",n+"");try{const e="/admin/api/actualizarcostos",t=yield fetch(e,{method:"POST",body:o}),n=yield t.json();void 0!==n.exito?(a.style.color="#02db02",a.style.fontWeight="500"):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))})()}(a,n,c,o)}})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e,t,o;if(document.querySelector(".almacen")){const r=document.querySelector("#reinciarinv"),c=document.querySelector("#miDialogoStock"),d=document.querySelector("#modalStock"),l=document.querySelector("#selectStockRapidoUndmedida");let u=document.querySelector("#cantidadStockRapido");const s=document.querySelector("#miDialogoIngresarProduccion"),m=document.querySelector("#itemAproducir"),v=document.querySelectorAll(".btnproduccion"),p=document.querySelector("#selectIngresarProduccionUnidadmedida"),f=document.querySelector("#stockIngresarProduccion");let g,y=0,b=0,S="",h=0,q="",E="",x=[];function a(e){document.querySelector("#stock").textContent=Number(e.stock).toLocaleString(),document.querySelector("#costoProduccion").textContent="$"+Number(e.precio_compra).toLocaleString(),document.querySelector("#precioVenta").textContent="$"+Number(e.precio_venta).toLocaleString()}function n(e,t){e.forEach(e=>{g.rows().every((function(){const o=this.node();let a=o.getAttribute("data-idsubproducto");if("0"==t&&(a=o.getAttribute("data-idproducto")),a&&a===e.id){this.cell(this.index(),3).data(e.stock);const t=g.cell(this.index(),3).node();Number(e.stock)<=Number(e.stockminimo)?(t.classList.remove("bg-cyan-50","text-cyan-600"),t.classList.add("bg-red-300","text-white")):(t.classList.remove("bg-red-300","text-white"),t.classList.add("bg-cyan-50","text-cyan-600"))}}))})}function i(e){e.target!==c&&e.target!==s&&"salir"!==e.target.value||(c.close(),s.close(),document.removeEventListener("click",i))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",t=yield fetch(e);x=yield t.json()}catch(e){console.log(e)}})),r.addEventListener("click",e=>{Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea reiniciar el inventario a cero?",text:"Todos los productos e insumos del inventario se reiniciaran a cero.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/reiniciarinv",t=yield fetch(e);msjalertToast("success","¡Éxito!",yield t.json()),setTimeout(()=>{window.location.reload()},1200)}catch(e){console.log(e)}}))})}),g=$("#tablaStockRapido").DataTable(configdatatables),null===(e=document.querySelector("#tablaStockRapido"))||void 0===e||e.addEventListener("click",e=>{var t,o,a,n,r,u;let s="";const m=e.target;for(m.closest(".btnsproducto")&&(E=m.closest(".btnsproducto").id,q="0",y=Number(m.closest(".btnsproducto").dataset.stock),document.querySelector("#nombreItemstockrapido").textContent=m.closest(".btnsproducto").dataset.nombre),m.closest(".btnssubproducto")&&(E=m.closest(".btnssubproducto").id,q="1",y=Number(m.closest(".btnssubproducto").dataset.stock),document.querySelector("#nombreItemstockrapido").textContent=m.closest(".btnssubproducto").dataset.nombre);l.firstChild;)l.removeChild(l.firstChild);if("0"==q){x.filter(e=>e.idproducto==E).forEach(e=>s+=`<option data-factor="${e.factorconversion}" value="${e.idproducto}" >${e.nombreunidaddestino}</option>`),l.insertAdjacentHTML("afterbegin",s)}if("1"==q){x.filter(e=>e.idsubproducto==E).forEach(e=>s+=`<option data-factor="${e.factorconversion}" value="${e.idsubproducto}" >${e.nombreunidaddestino}</option>`),l.insertAdjacentHTML("afterbegin",s)}((null===(t=e.target)||void 0===t?void 0:t.classList.contains("descontarStock"))||(null===(o=e.target.parentElement)||void 0===o?void 0:o.classList.contains("descontarStock")))&&function(e){d.textContent="Descontar cantidad a inventario",S="descontarstock",b=g.row(e.target.closest("tr")).index(),c.showModal(),document.addEventListener("click",i)}(e),((null===(a=e.target)||void 0===a?void 0:a.classList.contains("aumentarStock"))||(null===(n=e.target.parentElement)||void 0===n?void 0:n.classList.contains("aumentarStock")))&&function(e){d.textContent="Ingreasar cantidad a inventario",S="aumentarstock",b=g.row(e.target.closest("tr")).index(),c.showModal(),document.addEventListener("click",i)}(e),((null===(r=e.target)||void 0===r?void 0:r.classList.contains("ajustarStock"))||(null===(u=e.target.parentElement)||void 0===u?void 0:u.classList.contains("ajustarStock")))&&function(e){d.textContent="Ajustar cantidad a inventario",S="ajustarstock",b=g.row(e.target.closest("tr")).index(),c.showModal(),document.addEventListener("click",i)}(e)}),null===(t=document.querySelector("#formStock"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault(),h=Number(l.options[l.selectedIndex].dataset.factor);let t=g.page.info(),o=h*Number(u.value);"descontarstock"==S&&(y-=o),"aumentarstock"==S&&(y+=o),"ajustarstock"==S&&(y=o),__awaiter(void 0,void 0,void 0,(function*(){var e;const a=new FormData;a.append("tipoitem",q),a.append("iditem",E),a.append("cantidad",o.toString());try{const o="/admin/api/"+S,r=yield fetch(o,{method:"POST",body:a}),d=yield r.json();void 0!==d.exito?(msjalertToast("success","¡Éxito!",d.exito[0]),null===(e=document.querySelector("#formStock"))||void 0===e||e.reset(),g.cell(b,3).data(y).draw(),g.page(t.page).draw("page"),n([d.item[0]],q)):msjalertToast("error","¡Error!",d.error[0]),c.close(),document.removeEventListener("click",i)}catch(e){console.log(e)}}))}),$("#itemAproducir").select2({maximumSelectionLength:1}),$("#itemAproducir").on("change",e=>{const t=e.target.value,o=$("#itemAproducir option:selected");if(t){let e;!function(e){for(;null==p?void 0:p.firstChild;)p.removeChild(null==p?void 0:p.firstChild);e.forEach(e=>{const t=document.createElement("option");t.textContent=e.nombreunidaddestino,t.value=e.id,t.dataset.factor=e.factorconversion,p.appendChild(t)})}(x.filter(e=>e.idproducto==t)),e={stock:o.data("stock"),precio_compra:o.data("precio_compra"),precio_venta:o.data("precio_venta")},a(e)}}),v.forEach((e,t)=>{e.addEventListener("click",e=>{m.value&&(document.querySelector("#nombreItemAProducir").textContent=m.options[m.selectedIndex].textContent,0===t&&(S="aumentarstock",document.querySelector("#modalIngresarProduccion").textContent="Ingreasar produccion a inventario"),1===t&&(S="descontarstock",document.querySelector("#modalIngresarProduccion").textContent="Descontar catnidad de inventario"),2===t&&(S="ajustarstock",document.querySelector("#modalIngresarProduccion").textContent="Ajustar cantidad de inventario"),s.showModal(),document.addEventListener("click",i))})}),null===(o=document.querySelector("#formIngresarProduccion"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault(),h=Number(p.options[p.selectedIndex].dataset.factor);let t=h*Number(f.value);__awaiter(void 0,void 0,void 0,(function*(){var e;const o=new FormData;o.append("tipoitem","0"),o.append("iditem",m.value),o.append("cantidad",t.toString()),o.append("construccion","1");try{const t="/admin/api/"+S,r=yield fetch(t,{method:"POST",body:o}),c=yield r.json();void 0!==c.exito?(msjalertToast("success","¡Éxito!",c.exito[0]),null===(e=document.querySelector("#formIngresarProduccion"))||void 0===e||e.reset(),a(c.item[0]),void 0!==c.insumos&&n(c.insumos[0],"1"),$("#itemAproducir option:selected").data("stock",c.item[0].stock)):msjalertToast("error","¡Error!",c.error[0]),s.close(),document.removeEventListener("click",i)}catch(e){console.log(e)}}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".categorias")){const a=document.querySelector("#crearCategoria"),n=document.querySelector("#miDialogoCategoria");let i,r=0,c=0;function o(e){e.target!==n&&"Salir"!==e.target.value&&"Actualizar"!==e.target.value||(n.close(),document.removeEventListener("click",o))}i=$("#tablaCategorias").DataTable(configdatatables),null==a||a.addEventListener("click",e=>{c=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateCategoria"))||void 0===e||e.reset(),document.querySelector("#formCrearUpdateCategoria").action="/admin/almacen/crear_categoria",document.querySelector("#idcategoria").value="0"}(),document.querySelector("#modalCategoria").textContent="Crear categoria",document.querySelector("#btnEditarCrearCategoria").value="Crear",n.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaCategorias"))||void 0===e||e.addEventListener("click",e=>{var t,a,d;const l=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarCategoria"))||(null===(a=e.target.parentElement)||void 0===a?void 0:a.classList.contains("editarCategoria")))&&function(e){var t,a,d,l,u;c=1;let s=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(a=e.target)||void 0===a?void 0:a.tagName)&&(s=null===(l=null===(d=e.target.parentElement)||void 0===d?void 0:d.parentElement)||void 0===l?void 0:l.id);document.querySelector("#modalCategoria").textContent="Actualizar categoria",document.querySelector("#btnEditarCrearCategoria").value="Actualizar",document.querySelector("#idcategoria").value=s,document.querySelector("#categoria").value=null===(u=e.target.closest(".acciones-btns"))||void 0===u?void 0:u.dataset.categoria,r=i.row(e.target.closest("tr")).index(),n.showModal(),document.addEventListener("click",o)}(e),((null==l?void 0:l.classList.contains("eliminarCategoria"))||(null===(d=l.parentElement)||void 0===d?void 0:d.classList.contains("eliminarCategoria")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);r=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la categoria?",text:"La categoria sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarCategoria",a=yield fetch(t,{method:"POST",body:e}),n=yield a.json();n.length||void 0!==n.exito?(i.row(r+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateCategoria"))||void 0===t||t.addEventListener("submit",e=>{if(c){e.preventDefault();var t=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",$("#idcategoria").val()),e.append("nombre",$("#categoria").val());try{const a="/admin/api/actualizar_categoria",n=yield fetch(a,{method:"POST",body:e}),c=yield n.json();if(console.log(c),void 0!==c.exito){msjalertToast("success","¡Éxito!",c.exito[0]);const e=i.row(r+=t.start).data();e[1]=$("#categoria").val(),e[3]=`<div class="acciones-btns" id="${$("#idcategoria").val()}" data-categoria="${$("#categoria").val()}"><button class="btn-md btn-turquoise editarCategoria"><i class="fa-solid fa-pen-to-square"></i></button><button class="btn-md btn-red eliminarCategoria"><i class="fa-solid fa-trash-can"></i></button></div>`,i.row(r).data(e).draw(),i.page(t.page).draw("page")}else msjalertToast("error","¡Error!",c.error[0]);document.addEventListener("click",o)}catch(e){console.log(e)}}))}})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".compras")){const n=document.querySelector("#proveedor"),i=document.querySelector("#inputimpuesto"),r=document.querySelector("#nfactura"),c=document.querySelector("#fecha"),d=document.querySelector("#origenPago"),l=document.querySelector("#formapago"),u=document.querySelector("#observacion"),s=document.querySelector("#btnvaciar"),m=document.querySelector("#miDialogoVaciar"),v=document.querySelector("#miDialogoRegistrarcompra"),p=document.querySelector("#tablaCompras tbody");let f,g=[],y=[];function t(){document.querySelector("#impuesto").textContent="% "+i.value,document.querySelector("#total").textContent="$ "+g.reduce((e,t)=>t.valorcompra+e,0).toLocaleString()}function o(){for(g.length=0;null==p?void 0:p.firstChild;)p.removeChild(null==p?void 0:p.firstChild);document.querySelector("#impuesto").textContent="% 0",document.querySelector("#total").textContent="$ 0"}function a(e){const t=e.target;(t===m||t===v||t.closest(".novaciar")||t.closest(".sivaciar")||t.closest(".nocomprar")||t.closest(".sicomprar"))&&(m.close(),v.close(),document.removeEventListener("click",a),t.closest(".sicomprar")&&(g.some(e=>Number.isNaN(e.valorcompra)||0==e.valorcompra)?msjalertToast("error","¡Error!","Verifica el valor de compra de la lista de productos"):function(e){__awaiter(this,void 0,void 0,(function*(){var t;const a=new FormData;a.append("idproveedor",n.options[n.selectedIndex].value),a.append("idorigenpago",d.options[d.selectedIndex].value),a.append("idformapago",l.options[l.selectedIndex].value),a.append("nombreproveedor",n.options[n.selectedIndex].textContent),a.append("nombreorigenpago",d.options[d.selectedIndex].textContent+""),a.append("formapago",l.options[l.selectedIndex].text),a.append("nfactura",r.value),a.append("impuesto",i.value),a.append("cantidaditems",g.reduce((e,t)=>t.cantidad+e,0)+""),a.append("observacion",u.value),a.append("estado",e),a.append("subtotal",g.reduce((e,t)=>t.valorcompra+e,0)+""),a.append("valortotal",g.reduce((e,t)=>t.valorcompra+e,0)+""),a.append("fechacompra",c.value),a.append("carrito",JSON.stringify(g)),a.append("subID",JSON.stringify(g.map(e=>{if(e.idsx)return e.idsx})));try{const e="/admin/api/registrarCompra",n=yield fetch(e,{method:"POST",body:a}),i=yield n.json();void 0!==i.exito?(msjalertToast("success","¡Éxito!",i.exito[0]),o(),null===(t=document.querySelector("#formComprar"))||void 0===t||t.reset()):msjalertToast("error","¡Error!",i.error[0])}catch(e){console.log(e)}}))}("paga")),t.closest(".sivaciar")&&o())}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",t=yield fetch(e);y=yield t.json(),console.log(y)}catch(e){console.log(e)}})),__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/totalitems",t=yield fetch(e),o=yield t.json();f=o.map(e=>{var t;return{id:e.id,text:e.nombre,tipo:null!==(t=e.tipoproducto)&&void 0!==t?t:"1",sku:e.sku,unidadmedida:e.unidadmedida}}),function(e){$("#articulo").select2({data:e,placeholder:"Selecciona un item",maximumSelectionLength:1})}(f)}catch(e){console.log(e)}})),i.addEventListener("input",()=>t()),$("#articulo").on("change",e=>{let t=$("#articulo").select2("data")[0];if(t){if(-1==g.findIndex(e=>e.iditem==t.id&&e.tipo==t.tipo)){const e=f.find(e=>e.id==t.id&&e.tipo==t.tipo),o={iditem:null==e?void 0:e.id,idpx:"0"==e.tipo?e.id:"NULL",idsx:"1"==e.tipo?e.id:"NULL",tipo:e.tipo,nombreitem:e.text,unidad:e.unidadmedida,cantidad:1,cantidadcomprado:1,factor:1,impuesto:0,valorunidad:0,subtotal:0,precio_compra:0,valorcompra:0};g=[...g,o],function(e,t,o){let a=`<option data-factor="1" value="" >${o}</option>`;const n=f.find(o=>o.id==e&&o.tipo==t);if("1"==t){a="";y.filter(t=>t.idsubproducto==e).forEach(e=>a+=`<option data-factor="${e.factorconversion}" value="${e.idsubproducto}" >${e.nombreunidaddestino}</option>`)}const i=document.createElement("TR");i.classList.add("itemselect"),i.dataset.id=""+e,i.dataset.tipo=""+t,i.insertAdjacentHTML("afterbegin",`<td class="!px-0 !py-2 text-xl text-gray-500 leading-5">${null==n?void 0:n.text}</td> \n            <td class="!p-2 text-xl text-gray-500 leading-5">\n                <select class="formulario__select selectunidad">\n                    ${a}  \n                </select>\n            </td>\n            <td class="!px-0 !py-2"><div class="flex"><button type="button"><span class="menos material-symbols-outlined">remove</span></button><input type="text" class="inputcantidad w-20 px-2 text-center" value="1" oninput="this.value = parseInt(this.value.replace(/[,.]/g, '')||1)"><button type="button"><span class="mas material-symbols-outlined">add</span></button></div></td>\n            <td class="!p-2 text-xl text-gray-500 leading-5"><input type="text" placeholder="Ingresa Valor Total Producto" class="inputcompra text-base sm:text-lg md:text-xl lg:text-2xl placeholder:text-sm sm:placeholder:text-base md:placeholder:text-lg lg:placeholder:text-xl bg-gray-50 border border-gray-300 text-gray-900 rounded-lg focus:border-indigo-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white h-14 focus:outline-none focus:ring-1" value="" oninput="this.value = parseInt(this.value.replace(/[,.]/g, '')||0)"></td>\n            <td class="accionestd"><div class="acciones-btns"><button class="btn-md btn-red eliminarItem"><i class="fa-solid fa-trash-can"></i></button></div></td>`),null==p||p.appendChild(i)}(t.id,t.tipo,t.unidadmedida)}}}),null==p||p.addEventListener("click",e=>{var o,a,n,i,r;const c=null===(o=e.target)||void 0===o?void 0:o.closest(".itemselect"),d=c.dataset.id,l=c.dataset.tipo,u=g.find(e=>e.iditem==d&&e.tipo==l);e.target.classList.contains("selectunidad")&&"eventSelect"!=e.target.dataset.event&&(null===(a=e.target)||void 0===a||a.addEventListener("change",e=>{const t=e.target;u.factor=Number(t.options[t.selectedIndex].dataset.factor)}),e.target.dataset.event="eventSelect"),e.target.classList.contains("menos")&&(u.cantidadcomprado--,u.cantidadcomprado<0&&(u.cantidadcomprado=0)),e.target.classList.contains("inputcantidad")&&"eventInput"!=e.target.dataset.event&&(null===(n=e.target)||void 0===n||n.addEventListener("input",e=>{u.cantidadcomprado=Number(e.target.value),u.cantidad=u.cantidadcomprado*u.factor}),e.target.dataset.event="eventInput"),e.target.classList.contains("mas")&&u.cantidadcomprado++,(null==p?void 0:p.querySelector(`TR[data-id="${d}"][data-tipo="${l}"] .inputcantidad`)).value=(null==u?void 0:u.cantidadcomprado)+"",e.target.classList.contains("inputcompra")&&"eventInput"!=e.target.dataset.event&&(null===(i=e.target)||void 0===i||i.addEventListener("input",e=>{u.valorcompra=Number(e.target.value),u.precio_compra=u.valorcompra/u.cantidad,t()}),e.target.dataset.event="eventInput"),(e.target.classList.contains("eliminarItem")||"I"==e.target.tagName)&&(g=g.filter(e=>e.iditem!=d||e.tipo!=l),null===(r=null==p?void 0:p.querySelector(`TR[data-id="${d}"][data-tipo="${l}"]`))||void 0===r||r.remove(),t()),u.cantidad=u.cantidadcomprado*u.factor}),null==s||s.addEventListener("click",()=>{g.length&&(m.showModal(),document.addEventListener("click",a))}),null===(e=document.querySelector("#formComprar"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault(),v.showModal(),document.addEventListener("click",a)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".ensamblaje")){const a=document.querySelector(".listaSubproductos"),n=document.querySelector("#unidadmedida");let i=document.querySelector("#cantidad"),r=[],c=0;function o(){var e;const t=null===(e=n.options[n.selectedIndex])||void 0===e?void 0:e.value,o=r.find(e=>e.id==t);c=Number(null==o?void 0:o.factorconversion)}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allConversionesUnidades",t=yield fetch(e);r=yield t.json()}catch(e){console.log(e)}})),$("#subproducto").select2({maximumSelectionLength:1}),$("#subproducto").on("change",e=>{const t=e.target.value;!function(e){for(;null==n?void 0:n.firstChild;)n.removeChild(null==n?void 0:n.firstChild);e.forEach(e=>{const t=document.createElement("option");t.textContent=e.nombreunidaddestino,t.value=e.id,n.appendChild(t)}),o()}(r.filter(e=>e.idsubproducto==t))}),n.addEventListener("change",o),document.querySelector("#cantidad").addEventListener("input",e=>{o()}),null===(e=document.querySelector("#rendimientoestandar"))||void 0===e||e.addEventListener("input",e=>{const t=e.target;__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",document.querySelector("#idproducto").value),e.append("rendimientoestandar",t.value);try{const o="/admin/api/setrendimientoestandar",a=yield fetch(o,{method:"POST",body:e}),n=yield a.json();void 0!==n.exito?(t.style.color="#02db02",t.style.fontWeight="500"):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))}),null===(t=document.querySelector("#formAddSubproducto"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault();const t=$("#subproducto").find("option:selected"),o=$("#unidadmedida").find("option:selected").text();let n=c*Number(i.value);__awaiter(void 0,void 0,void 0,(function*(){var e;const r=new FormData;r.append("id_producto",document.querySelector("#idproducto").value),r.append("id_subproducto",$("#subproducto").val()),r.append("cantidadsubproducto",n.toString()),r.append("costo",Number(t.data("costo"))*n+"");try{const n="/admin/api/ensamblar",c=yield fetch(n,{method:"POST",body:r}),d=yield c.json();void 0!==d.exito?(msjalertToast("success","¡Éxito!",d.exito[0]),function(e,t,o){const n=document.querySelector(`.listaSubproductos div[id="${e}"]`);n?n.querySelector("strong").textContent=i.value+" "+t:null==a||a.insertAdjacentHTML("beforeend",`\n                <div id="${e}" class="mb-4 flex items-center justify-between p-4 text-blue-600 bg-blue-100 rounded-lg shadow-md shadow-blue-500/30" role="alert">\n                    <p class="m-0"><strong>${i.value} ${t}</strong>.  ${o}</p>\n                    <button type="button"><span id="${e}" class="material-symbols-outlined">cancel</span></button>\n                </div>`)}($("#subproducto").val(),o,t.data("subproducto")),$("#subproducto").val([]).trigger("change"),null===(e=document.querySelector("#formAddSubproducto"))||void 0===e||e.reset()):msjalertToast("error","¡Error!",d.error[0])}catch(e){console.log(e)}}))}),null==a||a.addEventListener("click",e=>{const t=e.target;"SPAN"==t.tagName&&function(e,t){const o=document.querySelector(`.listaSubproductos div[id="${t}"]`);(()=>{__awaiter(this,void 0,void 0,(function*(){try{const a="/admin/api/desasociarsubproducto?idproducto="+e+"&idsubproducto="+t,n=yield fetch(a),i=yield n.json();void 0!==i.exito?(null==o||o.remove(),msjalertToast("success","¡Éxito!",i.exito[0])):msjalertToast("error","¡Error!",i.error[0])}catch(e){console.log(e)}}))})()}(document.querySelector("#idproducto").value,t.id)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".productos")){const a=document.querySelector("#crearProducto"),n=document.querySelector("#miDialogoProducto"),i=document.querySelector("#upImage"),r=document.querySelector("#customUpImage"),c=document.querySelector("#imginputfile"),d=document.querySelector("#tipoproducto");let l,u,s=0,m=0,v=[];__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allproducts",t=yield fetch(e);v=yield t.json(),console.log(v)}catch(e){console.log(e)}}));const p=document.querySelector(".divmsjalerta0");function o(e){e.target!==n&&"salir"!==e.target.value||(n.close(),document.removeEventListener("click",o))}p&&borrarMsjAlert(p),null==d||d.addEventListener("change",e=>{var t,o,a,n;const i=e.target,r=document.querySelector(".preciocompra"),c=document.querySelector(".stock"),d=document.querySelector(".habtipoproduccion");"0"==i.value?(c.style.display="flex",r.style.display="flex",d.style.display="none",null===(t=document.querySelector("#preciocompra"))||void 0===t||t.setAttribute("required",""),null===(o=document.querySelector("#tipoproduccion"))||void 0===o||o.removeAttribute("required")):(c.style.display="none",r.style.display="none",d.style.display="flex",null===(a=document.querySelector("#preciocompra"))||void 0===a||a.removeAttribute("required"),null===(n=document.querySelector("#tipoproduccion"))||void 0===n||n.setAttribute("required",""))}),l=$("#tablaProductos").DataTable(configdatatables),null==a||a.addEventListener("click",e=>{m=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateProducto"))||void 0===e||e.reset(),c.src=""}(),document.querySelector("#modalProducto").textContent="Crear producto",document.querySelector("#btnEditarCrearProducto").value="Crear",document.querySelector(".stock").style.display="block",document.querySelector(".preciocompra").style.display="block",n.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaProductos"))||void 0===e||e.addEventListener("click",e=>{var t,a,i,r;const d=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarProductos"))||(null===(a=e.target.parentElement)||void 0===a?void 0:a.classList.contains("editarProductos")))&&function(e){var t,a,i,r,d,p,f,g,y,b,S,h,q;let E=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(a=e.target)||void 0===a?void 0:a.tagName)&&(E=null===(r=null===(i=e.target.parentElement)||void 0===i?void 0:i.parentElement)||void 0===r?void 0:r.id);m=1,document.querySelector("#modalProducto").textContent="Actualizar producto",document.querySelector("#btnEditarCrearProducto").value="Actualizar",u=v.find(e=>e.id===E),$("#categoria").val(null!==(d=null==u?void 0:u.idcategoria)&&void 0!==d?d:""),document.querySelector("#nombre").value=null==u?void 0:u.nombre,$("#tipoproducto").val(null!==(p=null==u?void 0:u.tipoproducto)&&void 0!==p?p:"0"),$("#idunidadmedida").val(null!==(f=null==u?void 0:u.idunidadmedida)&&void 0!==f?f:"1"),document.querySelector(".stock").style.display="block",document.querySelector(".preciocompra").style.display="block","1"==(null==u?void 0:u.tipoproducto)&&(document.querySelector(".stock").style.display="none",document.querySelector(".preciocompra").style.display="none");document.querySelector("#stock").value=null!==(g=null==u?void 0:u.stock)&&void 0!==g?g:"",document.querySelector("#preciocompra").value=null!==(y=null==u?void 0:u.precio_compra)&&void 0!==y?y:"",document.querySelector("#precioventa").value=null!==(b=null==u?void 0:u.precio_venta)&&void 0!==b?b:"",document.querySelector("#sku").value=null!==(S=null==u?void 0:u.sku)&&void 0!==S?S:"",document.querySelector("#impuesto").value=null!==(h=null==u?void 0:u.impuesto)&&void 0!==h?h:"",document.querySelector("#stockminimo").value=null!==(q=null==u?void 0:u.stockminimo)&&void 0!==q?q:"",c.src="/build/img/"+(null==u?void 0:u.foto),s=l.row(e.target.closest("tr")).index(),n.showModal(),document.addEventListener("click",o)}(e),((null==d?void 0:d.classList.contains("bloquearProductos"))||(null===(i=d.parentElement)||void 0===i?void 0:i.classList.contains("bloquearProductos")))&&function(e){let t=e.target.parentElement,o=l.page.info();"SPAN"===e.target.tagName&&(t=e.target.parentElement.parentElement);s=l.row(e.target.closest("tr")).index(),(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t.id);try{const a="/admin/api/cambiarestadoproducto",n=yield fetch(a,{method:"POST",body:e}),i=yield n.json();if(void 0!==i.exito){const e=`<div class="acciones-btns my-[0.7rem]" id="${t.id}">\n                              ${1==i.tipoproducto[0]?`<a class="btn-xs btn-blue" title="Agregar Materia Prima" href="/admin/almacen/componer?id=${t.id}"><i class="fa-solid fa-subscript text-[17px] leading-none"></i></a>`:""}\n                              <button class="btn-xs btn-lima" title="Más opciones"><i class="fa-solid fa-circle-plus text-[17px] leading-none"></i></button>\n                              <button class="btn-xs btn-turquoise editarProductos" title="Actualizar Producto"><i class="fa-solid fa-pen-to-square text-[17px] leading-none"></i></button>\n                              <button class="btn-xs ${1==i.estado[0]?"btn-light":"btn-orange"} bloquearProductos" title="Bloquear Producto"><span class="material-symbols-outlined text-[18px] leading-none">hide_source</span></button>\n                              <button class="btn-xs btn-red eliminarProductos" title="Eliminar Producto"><i class="fa-solid fa-trash-can text-[17px] leading-none"></i></button>\n                            </div>`;l.cell(l.row(s+=o.start),7).data(e).draw(),l.page(o.page).draw("page"),msjalertToast("success","¡Éxito!",i.exito[0])}else Swal.fire(i.error[0],"","error")}catch(e){console.log(e)}}))})()}(e),((null==d?void 0:d.classList.contains("eliminarProductos"))||(null===(r=d.parentElement)||void 0===r?void 0:r.classList.contains("eliminarProductos")))&&function(e){let t=e.target.parentElement.id,o=l.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);s=l.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el prducto?",text:"El prducto sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarProducto",a=yield fetch(t,{method:"POST",body:e}),n=yield a.json();void 0!==n.exito?(l.row(s+o.start).remove().draw(),l.page(o.page).draw("page"),Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateProducto"))||void 0===t||t.addEventListener("submit",e=>{var t;if(m){e.preventDefault();var a,i=l.page.info();if(a=u.foto,!c.src.includes(u.foto)&&(a=null===(t=e.target.elements.namedItem("upImage").files)||void 0===t?void 0:t[0])){if("image/png"!==a.type&&"image/jpeg"!==a.type)return void msjAlert("error","No es un formato valido para la foto",document.querySelector("#divmsjalerta1"));if(a.size>55e4)return void msjAlert("error","La imagen no debe superar los 500KB",document.querySelector("#divmsjalerta1"))}__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",u.id),e.append("idcategoria",$("#categoria").val()),e.append("nombre",$("#nombre").val()),e.append("foto",a),e.append("tipoproducto",$("#tipoproducto").val()),e.append("idunidadmedida",$("#idunidadmedida").val()),e.append("unidadmedida",$("#idunidadmedida option:selected").text()),e.append("stock",$("#stock").val()),e.append("precio_compra",$("#preciocompra").val()),e.append("precio_venta",$("#precioventa").val()),e.append("sku",$("#sku").val()),e.append("tipoproduccion",null==$("#tipoproduccion").val()?"0":$("#tipoproduccion").val()),e.append("impuesto",$("#impuesto").val()),e.append("stockminimo",$("#stockminimo").val());try{const t="/admin/api/actualizarproducto",a=yield fetch(t,{method:"POST",body:e}),r=yield a.json();if(console.log(r),void 0!==r.exito){msjalertToast("success","¡Éxito!",r.exito[0]),v.forEach(e=>{e.id==u.id&&(e=Object.assign(e,r.producto[0]))});const e=l.row(s).data();e[1]=`<div class="text-center"><img class="inline" style="width: 50px;" src="/build/img/${r.producto[0].foto}" alt=""></div>`,e[2]='<div class="w-80 whitespace-normal">'+$("#nombre").val()+"</div>",e[3]=$("#categoria option:selected").text(),e[4]="",e[5]=$("#sku").val(),e[6]=$("#precioventa").val(),l.row(s).data(e).draw(),l.page(i.page).draw("page")}else msjalertToast("error","¡Error!",r.error[0]);n.close(),document.removeEventListener("click",o)}catch(e){console.log(e)}}))}}),null==r||r.addEventListener("click",()=>null==i?void 0:i.click()),null==i||i.addEventListener("change",(function(){var e;const t=null===(e=this.files)||void 0===e?void 0:e[0];if(t){const e=new FileReader;e.onload=function(){const t=e.result;"string"==typeof t&&(c.src=t)},e.readAsDataURL(t)}}))}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".subproductos")){const a=document.querySelector("#crearSubProducto"),n=document.querySelector("#miDialogoSubProducto");let i,r,c=0,d=0,l=[];function o(e){e.target!==n&&"salir"!==e.target.value&&"Actualizar"!==e.target.value||(n.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allsubproducts",t=yield fetch(e);l=yield t.json(),console.log(l)}catch(e){console.log(e)}})),i=$("#tablaSubProductos").DataTable(configdatatables),null==a||a.addEventListener("click",e=>{d=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateSubProducto"))||void 0===e||e.reset(),document.querySelector("#formCrearUpdateSubProducto").action="/admin/almacen/crear_subproducto"}(),document.querySelector("#modalSubProducto").textContent="Crear sub producto",document.querySelector("#btnEditarCrearSubProducto").value="Crear",n.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaSubProductos"))||void 0===e||e.addEventListener("click",e=>{var t,a;const u=e.target;((null==u?void 0:u.classList.contains("editarSubProductos"))||(null===(t=u.parentElement)||void 0===t?void 0:t.classList.contains("editarSubProductos")))&&function(e){var t,a,u,s,m,v,p;let f=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(a=e.target)||void 0===a?void 0:a.tagName)&&(f=null===(s=null===(u=e.target.parentElement)||void 0===u?void 0:u.parentElement)||void 0===s?void 0:s.id);d=1,document.querySelector("#modalSubProducto").textContent="Actualizar producto",document.querySelector("#btnEditarCrearSubProducto").value="Actualizar",r=l.find(e=>e.id===f),$("#unidadmedida").val(null!==(m=null==r?void 0:r.id_unidadmedida)&&void 0!==m?m:""),document.querySelector("#nombre").value=null==r?void 0:r.nombre,document.querySelector("#sku").value=null==r?void 0:r.sku,document.querySelector("#preciocompra").value=null!==(v=null==r?void 0:r.precio_compra)&&void 0!==v?v:"",document.querySelector("#stockminimo").value=null!==(p=null==r?void 0:r.stockminimo)&&void 0!==p?p:"",c=i.row(e.target.closest("tr")).index(),n.showModal(),document.addEventListener("click",o)}(e),((null==u?void 0:u.classList.contains("eliminarSubProductos"))||(null===(a=u.parentElement)||void 0===a?void 0:a.classList.contains("eliminarSubProductos")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);c=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el sub prducto?",text:"El sub prducto sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarSubProducto",a=yield fetch(t,{method:"POST",body:e}),n=yield a.json();void 0!==n.exito?(i.row(c+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateSubProducto"))||void 0===t||t.addEventListener("submit",e=>{if(d){e.preventDefault();var t=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){var e;const a=new FormData;a.append("id",r.id),a.append("id_unidadmedida",$("#unidadmedida").val()),a.append("unidadmedida",$("#unidadmedida").find("option:selected").text()),a.append("nombre",$("#nombre").val()),a.append("sku",$("#sku").val()),a.append("precio_compra",$("#preciocompra").val()),a.append("stockminimo",$("#stockminimo").val());try{const n="/admin/api/actualizarsubproducto",d=yield fetch(n,{method:"POST",body:a}),u=yield d.json();if(console.log(u),void 0!==u.exito){msjalertToast("success","¡Éxito!",u.exito[0]),l.forEach(e=>{e.id==r.id&&(e=Object.assign(e,u.subproducto[0]))});const o=i.row(c+=t.start).data();o[1]='<div class="w-80 whitespace-normal">'+$("#nombre").val()+"</div>",o[2]="",o[3]=$("#sku").val(),o[4]=$("#unidadmedida option:selected").text(),o[5]="$"+(null===(e=Number($("#preciocompra").val()))||void 0===e?void 0:e.toLocaleString()),i.row(c).data(o).draw(),i.page(t.page).draw("page")}else msjalertToast("error","¡Error!",u.error[0]);document.addEventListener("click",o)}catch(e){console.log(e)}}))}})}})(),(()=>{var e;if(document.querySelector(".unidadesmedida")){const o=document.querySelector("#btnCrearUnidadMedida"),a=document.querySelector("#miDialogoUnidadMedida");let n;function t(e){const o=e.target;o!==a&&"Salir"!==o.value&&"Actualizar"!==o.value||(a.close(),document.removeEventListener("click",t))}n=$("#tablaUnidadesMedida").DataTable(configdatatables),null==o||o.addEventListener("click",e=>{!function(){var e;null===(e=document.querySelector("#formCrearUpdateUnidad"))||void 0===e||e.reset(),document.querySelector("#formCrearUpdateUnidad").action="/admin/almacen/crear_unidadmedida"}(),document.querySelector("#modalUnidadMedida").textContent="Crear unidad de medida",document.querySelector("#btnEditarCrearUnidadMedida").value="Crear",a.showModal(),document.addEventListener("click",t)}),null===(e=document.querySelector("#tablaUnidadesMedida"))||void 0===e||e.addEventListener("click",e=>{var o,n,i=e.target;((null==i?void 0:i.classList.contains("editarUnidadMedida"))||(null===(o=i.parentElement)||void 0===o?void 0:o.classList.contains("editarUnidadMedida")))&&function(e){var o,n,i,r,c;let d=null===(o=e.target.parentElement)||void 0===o?void 0:o.id;"I"===(null===(n=e.target)||void 0===n?void 0:n.tagName)&&(d=null===(r=null===(i=e.target.parentElement)||void 0===i?void 0:i.parentElement)||void 0===r?void 0:r.id);document.querySelector("#formCrearUpdateUnidad").action="/admin/almacen/editarunidademedida",document.querySelector("#modalUnidadMedida").textContent="Actualizar unidad de medida",document.querySelector("#btnEditarCrearUnidadMedida").value="Actualizar",document.querySelector("#idunidadmedida").value=d,document.querySelector("#unidad").value=null===(c=e.target.closest(".acciones-btns"))||void 0===c?void 0:c.dataset.unidadmedida,a.showModal(),document.addEventListener("click",t)}(e),((null==i?void 0:i.classList.contains("eliminarUnidadMedida"))||(null===(n=i.parentElement)||void 0===n?void 0:n.classList.contains("eliminarUnidadMedida")))&&function(e){let t=e.target.parentElement;"I"===e.target.tagName&&(t=t.parentElement);Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la unidad de medida?",text:"La unidad de medida sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&t.submit()})}(e)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".caja")){const a=document.querySelector("#gastosIngresos"),n=document.querySelector("#cambioMedioPago"),i=document.querySelector("#btnGastosingresos"),r=document.querySelector("#operacion"),c=document.querySelectorAll(".mediopago"),d=document.querySelector("#totalPagado"),l=document.querySelector("#numfactura");let u,s,m,v,p="0",f=[];const g=new Set;function o(e){e.target!==a&&e.target!==n&&"cancelar"!==e.target.value||(a.close(),n.close(),document.removeEventListener("click",o))}u=$("#tablaListaPedidos").DataTable(configdatatables),null==i||i.addEventListener("click",()=>{a.showModal(),document.addEventListener("click",o)}),null==r||r.addEventListener("change",e=>{var t,o;const a=e.target,n=document.querySelector(".tipodegasto");"gasto"==a.value?(n.style.display="flex",null===(t=document.querySelector("#tipodegasto"))||void 0===t||t.setAttribute("required","")):(n.style.display="none",null===(o=document.querySelector("#tipodegasto"))||void 0===o||o.removeAttribute("required"))}),null===(e=document.querySelector("#tablaListaPedidos"))||void 0===e||e.addEventListener("click",e=>{var t;const a=e.target;((null==a?void 0:a.classList.contains("mediosdepago"))||(null===(t=a.parentElement)||void 0===t?void 0:t.classList.contains("mediosdepago")))&&function(e){var t,a,i,r,u,f,y;p=e.id,m=e,s=null!==(t=e.dataset.estado)&&void 0!==t?t:"",d.textContent=Number(null!==(a=e.dataset.totalpagado)&&void 0!==a?a:"0").toLocaleString(),"BUTTON"==e.tagName&&(p=e.parentElement.id,m=e.parentElement,s=null!==(r=null===(i=e.parentElement)||void 0===i?void 0:i.dataset.estado)&&void 0!==r?r:"",d.textContent=Number(null!==(u=e.parentElement.dataset.totalpagado)&&void 0!==u?u:"0").toLocaleString());(function(){l.textContent="Factura N° : "+p,(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/mediospagoXfactura?id="+p,t=yield fetch(e);v=yield t.json(),console.log(v),v.forEach(e=>g.add(e.idmediopago)),c.forEach(e=>{e.value="0";for(let t=0;t<v.length;t++)if(e.id==v[t].idmediopago){e.value=v[t].valor;break}})}catch(e){console.log(e)}}))})()})(),"Eliminada"==s&&(null===(f=document.querySelector("#btnEnviarCambioMedioPago"))||void 0===f||f.classList.add("!hidden"));"Paga"==s&&(null===(y=document.querySelector("#btnEnviarCambioMedioPago"))||void 0===y||y.classList.remove("!hidden"));n.showModal(),document.addEventListener("click",o)}(a)}),null===(t=document.querySelector("#formCambioMedioPago"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault();let t=0;f.length=0,c.forEach((e,o)=>{t+=parseInt(e.value.replace(/[,.]/g,"")),"0"!=e.value&&(f=[...f,{idmediopago:e.id,valor:e.value.replace(/[,.]/g,"")}])}),t==parseInt(d.textContent.replace(/[,.]/g,""))?function(){__awaiter(this,void 0,void 0,(function*(){var e,t,a,i;const r=new Set(f.map(e=>e.idmediopago)),c=v.filter(e=>r.has(e.idmediopago)),d=f.filter(e=>!g.has(e.idmediopago)),l=v.filter(e=>!r.has(e.idmediopago)),u=new FormData;u.append("id_factura",p),u.append("efectivoDB",null!==(t=null===(e=v.find(e=>"1"==e.idmediopago))||void 0===e?void 0:e.valor)&&void 0!==t?t:"0"),u.append("nuevoEfectivo",null!==(i=null===(a=f.find(e=>"1"==e.idmediopago))||void 0===a?void 0:a.valor)&&void 0!==i?i:"0"),u.append("mediospagocompartidos",JSON.stringify(c)),u.append("nuevosMediosPagoNoEnDB",JSON.stringify(d)),u.append("mediosPagoDBNoEnNuevos",JSON.stringify(l)),u.append("nuevosMediosPago",JSON.stringify(f));try{const e="/admin/api/cambioMedioPago",t=yield fetch(e,{method:"POST",body:u}),o=yield t.json();void 0!==o.exito?(msjalertToast("success","¡Éxito!",o.exito[0]),function(e){for(;m.firstChild;)m.removeChild(m.firstChild);e.forEach(e=>{const t=document.createElement("button");t.classList.add("btn-xs","btn-light","mr-2"),t.textContent=e.mediopago,m.appendChild(t)})}(o.mediosPagoUpdate)):msjalertToast("error","¡Error!",o.error[0])}catch(e){console.log(e)}n.close(),document.removeEventListener("click",o)}))}():msjAlert("error","Valor diferente al pagado",document.querySelector("#divmsjalerta2"))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{if(document.querySelector(".cerrarcaja")){const t=document.querySelector("#modalArqueocaja"),o=document.querySelector("#Modalcerrarcaja"),a=document.querySelector("#btnArqueocaja"),n=document.querySelector("#btnCerrarcaja"),i=document.querySelectorAll(".inputmediopago"),r=document.querySelector("#formArqueocaja");function e(a){(a.target===t||a.target===o||"cancelar"===a.target.value||a.target.closest(".salircerrarcaja")||a.target.closest(".finCerrarcaja"))&&(t.close(),o.close(),document.removeEventListener("click",e),a.target.closest(".finCerrarcaja")&&function(){var t;const a=new FormData;a.append("idcierrecaja",null===(t=document.querySelector("#idCierrecaja"))||void 0===t?void 0:t.textContent),document.querySelector(".content-spinner1").style.display="grid",o.close(),document.removeEventListener("click",e),(()=>{__awaiter(this,void 0,void 0,(function*(){try{const e="/admin/api/cierrecajaconfirmado",t=yield fetch(e,{method:"POST",body:a}),o=yield t.json();void 0!==o.exito?(msjalertToast("success","¡Éxito!",o.exito[0]),setTimeout(()=>{document.querySelector(".content-spinner1").style.display="none",window.location.href="/admin/caja/detallecierrecaja?id="+o.ultimocierre[0]},1600)):msjalertToast("error","¡Error!",o.error[0])}catch(e){console.log(e)}}))})()}())}null==a||a.addEventListener("click",()=>{t.showModal(),document.addEventListener("click",e)}),null==n||n.addEventListener("click",()=>{o.showModal(),document.addEventListener("click",e)}),null==r||r.addEventListener("submit",o=>{o.preventDefault(),function(){const e=document.querySelector("#Efectivo"),t=Array.from(document.querySelectorAll(".denominacion")).reduce((e,t)=>Number(t.dataset.moneda)*Number(t.value)+e,0);e.value=t+"";const o=new Event("input");e.dispatchEvent(o)}();const a=new FormData(r);__awaiter(void 0,void 0,void 0,(function*(){try{const o="/admin/api/arqueocaja",n=yield fetch(o,{method:"POST",body:a}),i=yield n.json();void 0!==i.exito?(t.close(),document.removeEventListener("click",e),msjalertToast("success","¡Éxito!",i.exito[0])):msjalertToast("error","¡Error!",i.error[0])}catch(e){console.log(e)}}))}),i.forEach(e=>{e.addEventListener("input",e=>{const t=e.target;__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id_mediopago",t.dataset.idmediopago+""),e.append("nombremediopago",t.name),e.append("valordeclarado",t.value);try{const o="/admin/api/declaracionDinero",a=yield fetch(o,{method:"POST",body:e}),n=yield a.json();void 0!==n.exito?(t.style.color="#02db02",t.style.fontWeight="500",function(e,t,o){var a,n;const i=document.querySelector(`.coldeclarado[data-mediopagoid="${e}"]`);if(i){const e=i.nextElementSibling;i.textContent=Number(t).toLocaleString("es-ES",{useGrouping:!0});const o=null===(n=null===(a=i.previousElementSibling)||void 0===a?void 0:a.textContent)||void 0===n?void 0:n.replace(/[.,]/g,"");e.textContent=(Number(t)-Number(o)).toLocaleString("es-ES",{useGrouping:!0})}else{const a=document.querySelector(".cuerpoanalisis");null==a||a.insertAdjacentHTML("beforeend",`\n          <tr class="${"Efectivo"==o?"!border-2 !border-indigo-600":""}">\n            <td class="">${o}</td> \n            <td class="colsistem">0</td>\n            <td class="coldeclarado" data-mediopagoid="${e}">${Number(t).toLocaleString("es-ES",{useGrouping:!0})}</td>\n            <td class="coldif">${Number(t).toLocaleString("es-ES",{useGrouping:!0})}</td>\n          </tr>`)}}(t.dataset.idmediopago,t.value,t.name)):msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))})})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e;if(document.querySelector(".fechazetadiario")){const o=document.querySelectorAll(".btnmultiselect"),a=document.querySelectorAll(".caja"),n=document.querySelector("#consultarZDiario"),i=document.querySelector("#tablaMediosPago tbody"),r=document.querySelector("#base"),c=document.querySelector("#valorImpuestoTotal"),d=document.querySelector("#ingresoVentas"),l=document.querySelector("#totalDescuentos"),u=document.querySelector("#realVentas"),s=document.querySelector("#cantidadElectronicas"),m=document.querySelector("#cantidadPOS"),v=document.querySelector("#valorElectronicas"),p=document.querySelector("#valorPOS");let f="",g="";function t(){const e=document.querySelectorAll('input.caja[type="checkbox"]:checked'),t=document.querySelector("#cajastext");t.textContent=". ",e.forEach((o,a)=>{var n,i;a<e.length-1?t.textContent+=(null===(n=o.nextElementSibling)||void 0===n?void 0:n.textContent)+" - ":t.textContent+=null===(i=o.nextElementSibling)||void 0===i?void 0:i.textContent})}o.forEach((e,t)=>{e.addEventListener("click",a=>{!function(e){o.forEach((t,o)=>{o==e&&t.classList.contains("open")||t.classList.remove("open")})}(t),e.classList.toggle("open")})}),null===(e=document.querySelector(".fechazetadiario"))||void 0===e||e.addEventListener("click",e=>{if(!e.target.closest(".btnmultiselect")&&!e.target.closest(".list-items")){const e=document.querySelector(".open");e&&e.classList.toggle("open")}}),a.forEach(e=>{e.addEventListener("click",t)}),$('input[name="datetimes"]').daterangepicker({timePicker:!0,startDate:moment().set({hour:0,minute:0,second:1}),endDate:moment().set({hour:23,minute:59,second:59}),locale:{format:"M/DD hh:mm A"}}),$('input[name="datetimes"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD HH:mm:ss"),a=t.endDate.format("YYYY-MM-DD HH:mm:ss");f=o,g=a,document.querySelector("#fechainicio").textContent=f,document.querySelector("#fechafin").textContent=g})),n.addEventListener("click",()=>{if(""==f||""==g)return void msjalertToast("error","¡Error!","Elegir fechas a consultar");const e=document.querySelectorAll('input.caja[type="checkbox"]:checked'),t=document.querySelectorAll('input.facturador[type="checkbox"]:checked'),o=Array.from(e).map(e=>e.value),a=Array.from(t).map(e=>e.value);document.querySelector(".content-spinner1").style.display="grid",__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("fechainicio",f),e.append("fechafin",g),e.append("cajas",JSON.stringify(o)),e.append("facturadores",JSON.stringify(a));try{const o="/admin/api/consultafechazetadiario",a=yield fetch(o,{method:"POST",body:e}),n=yield a.json();console.log(n),document.querySelector(".content-spinner1").style.display="none",function(){for(;i.firstChild;)i.removeChild(i.firstChild);d.textContent="",l.textContent="",u.textContent="",s.textContent="",m.textContent="",v.textContent="",p.textContent=""}(),n.datosmediospago.forEach(e=>{const t=document.createElement("tr");t.innerHTML=`<td class="">${e.nombre}</td> \n                        <td class="">$${Number(e.valor).toLocaleString()}</td>`,i.appendChild(t)}),t=n.datosventa,r.textContent="$"+Number(t.base).toLocaleString(),c.textContent="$"+Number(t.valorimpuestototal).toLocaleString(),d.textContent="$"+Number(t.subtotalventa).toLocaleString(),l.textContent="$"+(Number(t.subtotalventa)-Number(t.totalventa)).toLocaleString(),u.textContent="$"+Number(t.totalventa).toLocaleString(),s.textContent=t.ELECTRONICAS,m.textContent=t.POS,v.textContent="$"+Number(t.total_ELECTRONICAS).toLocaleString(),p.textContent="$"+Number(t.total_POS).toLocaleString()}catch(e){console.log(e)}var t}))})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e,t,o,a,n;if(document.querySelector(".ordenresumen")){const c=document.querySelector("#miDialogoFacturar"),d=document.querySelector("#miDialogoEliminarOrden"),l=document.querySelector("#btnfacturar"),u=document.querySelector("#btneliminarorden"),s=document.querySelector("#caja"),m=document.querySelector("#facturador"),v=document.querySelectorAll(".mediopago"),p=document.querySelectorAll('input[name="devolverinventario"]'),f=document.querySelectorAll(".inputInv"),g=document.querySelector("#printcarta"),y={subtotal:0,impuesto:0,dctox100:0,descuento:0,idtarifa:0,valortarifa:0,total:0},b=new Map;function i(e){e=e.replace(/[,.]/g,""),Number(e)>b.get("1")?document.querySelector("#cambio").textContent=(Number(e)-b.get("1")).toLocaleString()+"":document.querySelector("#cambio").textContent="0"}function r(e){const t=e.target;(e.target===c||e.target===d||"cancelar"===e.target.value||t.closest(".noeliminar")||t.closest(".sieliminar"))&&(c.close(),d.close(),t.closest(".sieliminar")&&function(){var e=[];f.forEach(t=>{const o=t;e=[...e,{id:o.id,idproducto:o.id,tipoproducto:o.dataset.tipoproducto,cantidad:o.value}]}),(()=>{__awaiter(this,void 0,void 0,(function*(){const t=new FormData;t.append("id",document.querySelector("#idorden").dataset.idorden),t.append("inv",JSON.stringify(e)),t.append("devolverinv",document.querySelector('input[name="devolverinventario"]:checked').value);try{const e="/admin/api/eliminarOrden",o=yield fetch(e,{method:"POST",body:t}),a=yield o.json();void 0!==a.exito?(msjalertToast("success","¡Éxito!",a.exito[0]),u.style.display="none",document.querySelector("#estadoOrden").textContent="Eliminada"):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}}))})()}(),document.removeEventListener("click",r))}y.subtotal=Number(null===(e=document.querySelector("#subTotal"))||void 0===e?void 0:e.textContent),y.total=Number(null===(o=null===(t=document.querySelector("#total"))||void 0===t?void 0:t.textContent)||void 0===o?void 0:o.replace(/[^\d]/g,"")),null==g||g.addEventListener("click",()=>{const e=window.open("/printfacturacarta?id=1","_blank");null==e||e.focus(),null==e||e.print(),setTimeout(()=>{null==e||e.close()},90)}),null==l||l.addEventListener("click",()=>{!function(){document.querySelector("#totalPagar").textContent=""+y.total.toLocaleString();let e=0;v.forEach((t,o)=>{o>0&&(e+=parseInt(t.value.replace(/[,.]/g,"")))}),y.total<e&&(e=0,b.clear(),$(".mediopago").val(0));document.querySelector(".Efectivo").value=""+(y.total-e),b.set("1",y.total-e),y.total-e==0&&b.has("1")&&b.delete("1");i(document.querySelector("#recibio").value)}(),c.showModal(),document.addEventListener("click",r)}),null==u||u.addEventListener("click",()=>{d.showModal(),document.addEventListener("click",r)}),p.forEach(e=>{e.addEventListener("change",e=>{var t;null===(t=document.querySelector("#productsInv"))||void 0===t||t.classList.toggle("hidden"),"1"===e.target.value?document.querySelectorAll(".inputInv").forEach(e=>e.setAttribute("required","")):document.querySelectorAll(".inputInv").forEach(e=>e.removeAttribute("required"))})}),f.forEach(e=>{e.addEventListener("input",e=>{var t,o;const a=e.target;a.value!=(null===(t=a.parentElement)||void 0===t?void 0:t.dataset.qty)?(a.classList.add("border-2","border-rose-600"),document.querySelector(".alerta")||msjAlert("error","Cantidad diferente a devolver a inventario",document.querySelector("#divmsjalerta1"))):(a.classList.remove("border-2","border-rose-600"),null===(o=document.querySelector(".alerta"))||void 0===o||o.remove())})}),v.forEach(e=>{e.addEventListener("input",e=>{!function(e){var t;let o=0;v.forEach((e,t)=>{t>0&&(o+=parseInt(e.value.replace(/[,.]/g,"")))}),o<=y.total?(b.set("1",y.total-o),y.total-o==0&&b.has("1")&&b.delete("1"),b.set(e.target.id,parseInt(e.target.value.replace(/[,.]/g,""))),"0"==e.target.value&&b.has(e.target.id)&&b.delete(e.target.id)):b.has(e.target.id)?e.target.value=b.get(e.target.id).toLocaleString():e.target.value="0";v[0].value=null!==(t=b.get("1"))&&void 0!==t?t:0,i(document.querySelector("#recibio").value)}(e)})}),null===(a=document.querySelector("#recibio"))||void 0===a||a.addEventListener("input",e=>{i(e.target.value)}),null===(n=document.querySelector("#formfacturar"))||void 0===n||n.addEventListener("submit",e=>{e.preventDefault(),function(e){__awaiter(this,void 0,void 0,(function*(){const t=new FormData;t.append("id",document.querySelector("#idorden").dataset.idorden),t.append("idcaja",s.value),t.append("idconsecutivo",m.value),t.append("caja",document.querySelector("#caja option:checked").textContent),t.append("tipofacturador",m.options[m.selectedIndex].textContent),t.append("mediosPago",JSON.stringify(Array.from(b,([e,t])=>({idmediopago:e,id_factura:0,valor:t})))),t.append("recibido",document.querySelector("#recibio").value),t.append("transaccion",""),t.append("estado",e),t.append("cambioaventa","1"),t.append("observacion",document.querySelector("#observacion").value);try{const e="/admin/api/facturarCotizacion",o=yield fetch(e,{method:"POST",body:t}),a=yield o.json();console.log(a),void 0!==a.exito?(msjalertToast("success","¡Éxito!",a.exito[0]),function(){l&&(l.style.display="none");document.querySelector("#abrirOrden").style.display="none",document.querySelector("#estadoOrden").textContent="Paga"}()):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}c.close(),document.removeEventListener("click",r)}))}("Paga")})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};!function(){var e,t,o;if(document.querySelector(".empleado")){const n=document.querySelector("#crearempleado"),i=document.getElementById("miDialogoEmpleado"),r=document.getElementById("miDialogoSkills"),c=document.querySelector("#upImage"),d=document.querySelector("#customUpImage"),l=document.querySelector("#imginputfile"),u=document.querySelector("#nombre"),s=document.querySelector("#apellido"),m=document.querySelector("#movil "),v=document.querySelector("#email"),p=document.querySelector("#departamento"),f=document.querySelector("#ciudad"),g=document.querySelector("#direccion"),y=document.querySelector("#perfil");let b,S,h=0,q=0,E=[];function a(e){e.target!==i&&e.target!==r&&"cancelar"!==e.target.value&&"Actualizar"!==e.target.value||(i.close(),null==r||r.close(),document.removeEventListener("click",a))}b=$("#tablaempleados").DataTable(configdatatables),n.addEventListener("click",e=>{q=0,function(){var e;l.src=" ",null===(e=document.querySelector("#formCrearUpdateEmpleado"))||void 0===e||e.reset()}(),document.querySelector("#modalEmpleado").textContent="Crear empleado",document.querySelector("#btnEditarCrearEmpleado").value="Crear",i.showModal(),document.addEventListener("click",a)}),d.addEventListener("click",()=>c.click()),c.addEventListener("change",(function(){var e;const t=null===(e=this.files)||void 0===e?void 0:e[0];if(t){const e=new FileReader;e.onload=function(){const t=e.result;"string"==typeof t&&(l.src=t)},e.readAsDataURL(t)}})),null===(e=document.querySelector("#tablaempleados"))||void 0===e||e.addEventListener("click",e=>{var t,o,n,c,d;const y=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarEmpleado"))||(null===(o=e.target.parentElement)||void 0===o?void 0:o.classList.contains("editarEmpleado")))&&function(e){var t,o,n,r,c,d,y,x,w,C,L,k;let j=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(o=e.target)||void 0===o?void 0:o.tagName)&&(j=null===(r=null===(n=e.target.parentElement)||void 0===n?void 0:n.parentElement)||void 0===r?void 0:r.id);q=1,document.querySelector("#modalEmpleado").textContent="Actualizar Empleado",document.querySelector("#btnEditarCrearEmpleado").value="Actualizar",S=E.find(e=>e.id==j),l.src="/build/img/"+(null==S?void 0:S.img),u.value=null!==(c=null==S?void 0:S.nombre)&&void 0!==c?c:"",s.value=null!==(d=null==S?void 0:S.apellido)&&void 0!==d?d:"",m.value=null!==(y=null==S?void 0:S.movil)&&void 0!==y?y:"",v.value=null!==(x=null==S?void 0:S.email)&&void 0!==x?x:"",p.value=null!==(w=null==S?void 0:S.departamento)&&void 0!==w?w:"",f.value=null!==(C=null==S?void 0:S.ciudad)&&void 0!==C?C:"",g.value=null!==(L=null==S?void 0:S.direccion)&&void 0!==L?L:"",$("#perfil").val(null!==(k=null==S?void 0:S.perfil)&&void 0!==k?k:""),h=b.row(e.target.closest("tr")).index(),i.showModal(),document.addEventListener("click",a)}(e),((null===(n=e.target)||void 0===n?void 0:n.classList.contains("empleadoSkills"))||(null===(c=e.target.parentElement)||void 0===c?void 0:c.classList.contains("empleadoSkills")))&&function(e){var t,o,n;let i=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===e.target.tagName&&(i=null===(n=null===(o=e.target.parentElement)||void 0===o?void 0:o.parentElement)||void 0===n?void 0:n.id);document.querySelectorAll('.inputskills input[type="checkbox"]').forEach(e=>{e.checked=!1}),S=E.find(e=>e.id==i);var c=null==S?void 0:S.idservicios;null==c||c.forEach(e=>{document.querySelector(`input[data-skillid="${e.idservicio}"]`).checked=!0}),null==r||r.showModal(),document.addEventListener("click",a)}(e),((null==y?void 0:y.classList.contains("eliminarEmpleado"))||(null===(d=y.parentElement)||void 0===d?void 0:d.classList.contains("eliminarEmpleado")))&&function(e){let t=e.target.parentElement.id,o=b.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);h=b.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el empleado?",text:"El empleado sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarEmpleado",a=yield fetch(t,{method:"POST",body:e}),n=yield a.json();void 0!==n.exito?(Swal.fire(n.exito[0],"","success")(b).row(h+o.start).remove().draw(),b.page(o.page).draw("page")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateEmpleado"))||void 0===t||t.addEventListener("submit",e=>{var t;if(q){e.preventDefault();var o,a=b.page.info();if(o=S.img,!l.src.includes(S.img)&&(o=null===(t=e.target.elements.namedItem("upImage").files)||void 0===t?void 0:t[0])){if("image/png"!==o.type&&"image/jpeg"!==o.type)return void msjAlert("error","No es un formato valido para la foto",document.querySelector("#divmsjalerta1"));if(o.size>55e4)return void msjAlert("error","La imagen no debe superar los 500KB",document.querySelector("#divmsjalerta1"))}(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("idempleado",S.id),e.append("img",o),e.append("nombre",u.value),e.append("apellido",s.value),e.append("movil",m.value),e.append("email",v.value),e.append("departamento",p.value),e.append("ciudad",f.value),e.append("direccion",g.value),e.append("perfil",y.value);try{const t="/admin/api/actualizarEmpleado",o=yield fetch(t,{method:"POST",body:e}),n=yield o.json();if(void 0!==n.exito){msjalertToast("success","¡Éxito!",n.exito[0]);const e=b.row(h+=a.start).data();e[1]=u.value+" "+s.value,e[2]=`<div class="text-center"><img style="width: 40px;" src="/build/img/${n.rutaimg[0]}" alt=""></div>`,e[3]=m.value,e[4]=v.value,e[5]=" ",e[6]="1"===y.value?"Empleado":"2"==y.value?"Admin":"Propietario",b.row(h).data(e).draw(),b.page(a.page).draw("page")}else msjalertToast("error","¡Error!",n.error[0])}catch(e){console.log(e)}}))})()}}),null===(o=document.querySelector("#formSkills"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault();var t=[];document.querySelectorAll('.inputskills input[type="checkbox"]').forEach(e=>{e.checked&&(t=[...t,e.value])}),(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("idempleado",S.id),e.append("idservicio",t.toString());try{const o="/admin/api/actualizarSkillsEmpleado",a=yield fetch(o,{method:"POST",body:e}),n=yield a.json();void 0!==n.exito?(msjalertToast("success","¡Éxito!",n.exito[0]),E.forEach(e=>{if(e.id==S.id)for(let o=0;o<t.length;o++)e.idservicios=[...e.idservicios,{idempleado:S.id,idservicio:t[o]}]})):msjalertToast("error","¡Error!",n.exito[0])}catch(e){console.log(e)}}))})()})}}();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gestioncajas")){const a=document.querySelector("#crearCaja"),n=document.querySelector("#miDialogoCaja");let i,r,c=0,d=0,l=[];function o(e){e.target!==n&&"Salir"!==e.target.value||(n.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allcajas",t=yield fetch(e);l=yield t.json(),console.log(l)}catch(e){console.log(e)}})),i=$("#tablaCajas").DataTable(configdatatables),a.addEventListener("click",()=>{d=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateCaja"))||void 0===e||e.reset()}(),document.querySelector("#modalCaja").textContent="Crear caja",document.querySelector("#btnEditarCrearCaja").value="Crear",n.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaCajas"))||void 0===e||e.addEventListener("click",e=>{var t,a,u;const s=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarCaja"))||(null===(a=e.target.parentElement)||void 0===a?void 0:a.classList.contains("editarCaja")))&&function(e){var t,a,u,s,m;let v=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(a=e.target)||void 0===a?void 0:a.tagName)&&(v=null===(s=null===(u=e.target.parentElement)||void 0===u?void 0:u.parentElement)||void 0===s?void 0:s.id);d=1,document.querySelector("#modalCaja").textContent="Actualizar caja",document.querySelector("#btnEditarCrearCaja").value="Actualizar",r=l.find(e=>e.id==v),document.querySelector("#nombrecaja").value=null==r?void 0:r.nombre,$("#idtipoconsecutivo").val(null!==(m=null==r?void 0:r.idtipoconsecutivo)&&void 0!==m?m:""),$("#negociogestioncaja").val(1),c=i.row(e.target.closest("tr")).index(),n.showModal(),document.addEventListener("click",o)}(e),((null==s?void 0:s.classList.contains("eliminarCaja"))||(null===(u=s.parentElement)||void 0===u?void 0:u.classList.contains("eliminarCaja")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);c=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar la caja?",text:"La caja sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarCaja",a=yield fetch(t,{method:"POST",body:e}),n=yield a.json();void 0!==n.exito?(i.row(c+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateCaja"))||void 0===t||t.addEventListener("submit",e=>{let t="crearCaja";d&&(t="actualizarCaja"),e.preventDefault();var a=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==r?void 0:r.id)?null==r?void 0:r.id:""),e.append("idtipoconsecutivo",$("#idtipoconsecutivo").val()),e.append("nombre",$("#nombrecaja").val()),e.append("negocio",$("#negociogestioncaja").val());try{const u="/admin/api/"+t,s=yield fetch(u,{method:"POST",body:e}),m=yield s.json();if(void 0!==m.exito)if(n.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),d){l.forEach(e=>{e.id==(null==r?void 0:r.id)&&(e=Object.assign(e,m.caja[0]))});const e=i.row(c+=a.start).data();e[1]=m.caja[0].nombre,e[2]=$("#idtipoconsecutivo option:selected").text(),e[3]=$("#negociogestioncaja option:selected").text(),i.row(c).data(e).draw(),i.page(a.page).draw("page")}else l=[...l,m.caja],i.row.add([i.rows().count()+1,m.caja.nombre,m.caja.nombreconsecutivo.nombre,m.caja.negocio,`<div class="acciones-btns" id="${m.caja.id}" data-caja="${m.caja.nombre}">\n                          <button class="btn-md btn-turquoise editarCaja"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarCaja"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})(),(()=>{if(document.querySelector(".gestionfacturadores")){const o=document.querySelector("#crearCompañia"),a=document.querySelector("#obtenerresolucion"),n=document.querySelector("#setpruebas"),i=document.querySelector("#miDialogoCompañia"),r=document.querySelector("#miDialogoGetResolucion"),c=document.querySelector("#miDialogosetpruebas");let d=0;function e(t){t.target!==i&&t.target!==c&&t.target!==r&&"Salir"!==t.target.value&&"Cancelar"!==t.target.value||(i.close(),r.close(),c.close(),document.removeEventListener("click",e))}function t(){var e;null===(e=document.querySelector("#formCrearUpdateCompañia"))||void 0===e||e.reset()}o.addEventListener("click",()=>{d=0,t(),document.querySelector("#modalCompañia").textContent="Crear compañia",document.querySelector("#btnEditarCrearCompañia").value="Crear",i.showModal(),document.addEventListener("click",e)}),a.addEventListener("click",()=>{d=0,t(),r.showModal(),document.addEventListener("click",e)}),n.addEventListener("click",()=>{d=0,t(),c.showModal(),document.addEventListener("click",e)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e,t;if(document.querySelector(".gestionfacturadores")){const a=document.querySelector("#crearFacturador"),n=document.querySelector("#miDialogoFacturador");let i,r,c=0,d=0,l=[];function o(e){e.target!==n&&"Salir"!==e.target.value||(n.close(),document.removeEventListener("click",o))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allfacturadores",t=yield fetch(e);l=yield t.json(),console.log(l)}catch(e){console.log(e)}})),i=$("#tablaFacturadores").DataTable(configdatatables),a.addEventListener("click",()=>{d=0,function(){var e;null===(e=document.querySelector("#formCrearUpdateFacturador"))||void 0===e||e.reset()}(),document.querySelector("#modalFacturador").textContent="Crear facturador",document.querySelector("#btnEditarCrearFacturador").value="Crear",n.showModal(),document.addEventListener("click",o)}),null===(e=document.querySelector("#tablaFacturadores"))||void 0===e||e.addEventListener("click",e=>{var t,a,u;const s=e.target;((null===(t=e.target)||void 0===t?void 0:t.classList.contains("editarFacturador"))||(null===(a=e.target.parentElement)||void 0===a?void 0:a.classList.contains("editarFacturador")))&&function(e){var t,a,u,s,m,v,p,f,g,y,b,S;let h=null===(t=e.target.parentElement)||void 0===t?void 0:t.id;"I"===(null===(a=e.target)||void 0===a?void 0:a.tagName)&&(h=null===(s=null===(u=e.target.parentElement)||void 0===u?void 0:u.parentElement)||void 0===s?void 0:s.id);d=1,document.querySelector("#modalFacturador").textContent="Actualizar facturador",document.querySelector("#btnEditarCrearFacturador").value="Actualizar",r=l.find(e=>e.id==h),document.querySelector("#nombrefacturador").value=null==r?void 0:r.nombre,$("#idtipofacturador").val(null!==(m=null==r?void 0:r.idtipofacturador)&&void 0!==m?m:""),$("#rangoinicial").val(null!==(v=null==r?void 0:r.rangoinicial)&&void 0!==v?v:""),$("#rangofinal").val(null!==(p=null==r?void 0:r.rangofinal)&&void 0!==p?p:""),$("#siguientevalor").val(null!==(f=null==r?void 0:r.siguientevalor)&&void 0!==f?f:""),$("#fechainicio").val(null!==(g=null==r?void 0:r.fechainicio)&&void 0!==g?g:""),$("#fechafin").val(null!==(y=null==r?void 0:r.fechafin)&&void 0!==y?y:""),$("#resolucion").val(null!==(b=null==r?void 0:r.resolucion)&&void 0!==b?b:""),$("#prefijo").val(null!==(S=null==r?void 0:r.prefijo)&&void 0!==S?S:""),$("#negociofacturador").val(1),c=i.row(e.target.closest("tr")).index(),n.showModal(),document.addEventListener("click",o)}(e),((null==s?void 0:s.classList.contains("eliminarFacturador"))||(null===(u=s.parentElement)||void 0===u?void 0:u.classList.contains("eliminarFacturador")))&&function(e){let t=e.target.parentElement.id,o=i.page.info();"I"===e.target.tagName&&(t=e.target.parentElement.parentElement.id);c=i.row(e.target.closest("tr")).index(),Swal.fire({customClass:{confirmButton:"sweetbtnconfirm",cancelButton:"sweetbtncancel"},icon:"question",title:"Desea eliminar el facturador?",text:"El facturador sera eliminado definitivamente.",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&(()=>{__awaiter(this,void 0,void 0,(function*(){const e=new FormData;e.append("id",t);try{const t="/admin/api/eliminarFacturador",a=yield fetch(t,{method:"POST",body:e}),n=yield a.json();void 0!==n.exito?(i.row(c+o.start).remove().draw(),i.page(o.page).draw("page"),Swal.fire(n.exito[0],"","success")):Swal.fire(n.error[0],"","error")}catch(e){console.log(e)}}))})()})}(e)}),null===(t=document.querySelector("#formCrearUpdateFacturador"))||void 0===t||t.addEventListener("submit",e=>{let t="crearFacturador";d&&(t="actualizarFacturador"),e.preventDefault();var a=i.page.info();__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("id",(null==r?void 0:r.id)?null==r?void 0:r.id:""),e.append("idtipoconsecutivo",$("#idtipoconsecutivo").val()),e.append("nombre",$("#nombrecaja").val()),e.append("negocio",$("#negociogestioncaja").val());try{const u="/admin/api/"+t,s=yield fetch(u,{method:"POST",body:e}),m=yield s.json();if(void 0!==m.exito)if(n.close(),document.removeEventListener("click",o),msjalertToast("success","¡Éxito!",m.exito[0]),d){l.forEach(e=>{e.id==(null==r?void 0:r.id)&&(e=Object.assign(e,m.facturador[0]))});const e=i.row(c+=a.start).data();e[1]=m.facturador[0].nombre,e[2]=$("#idtipoconsecutivo option:selected").text(),e[3]=$("#negociogestioncaja option:selected").text(),i.row(c).data(e).draw(),i.page(a.page).draw("page")}else l=[...l,m.facturador],i.row.add([i.rows().count()+1,m.facturador.nombre,m.facturador.nombreconsecutivo.nombre,m.facturador.negocio,`<div class="acciones-btns" id="${m.facturador.id}" data-facturador="${m.facturador.nombre}">\n                          <button class="btn-md btn-turquoise editarFacturador"><i class="fa-solid fa-pen-to-square"></i></button>\n                          <button class="btn-md btn-red eliminarFacturador"><i class="fa-solid fa-trash-can"></i></button>\n                      </div>`]).draw(!1);else msjalertToast("error","¡Error!",m.error[0])}catch(e){console.log(e)}}))})}})(),function(){var e,t;if(document.querySelector(".reportes")){const a=null===(e=document.getElementById("chartventas"))||void 0===e?void 0:e.getContext("2d"),n=null===(t=document.getElementById("chartutilidad"))||void 0===t?void 0:t.getContext("2d"),i=document.querySelector("#ventasgenerales"),r=document.querySelector("#cierrescaja"),c=(document.querySelector("#modalFecha"),{inicio:"",fin:""});function o(e){Swal.fire({title:"<strong>Seleccionar <u>Fecha</u></strong>",html:'\n        <div class="campodaterange">\n          <label class="formulario__label" for="fechapersonalizada">Fecha personalizada</label>\n          <input type="text" name="daterange" class="formulario__input" id="fechapersonalizada" /></div>\n        ',showCloseButton:!0,showCancelButton:!0,focusConfirm:!1,width:"auto"}).then(t=>{t.isConfirmed&&""!=c.inicio&&""!=c.fin&&(window.location.href=`/admin/reportes/${e}?inicio=${c.inicio}&fin=${c.fin}`)})}new Chart(a,{type:"bar",data:{labels:["Red","Blue","Yellow","Green","Purple","Orange","Red","Blue","Yellow","Green","Purple","Orange","Red","Blue","Yellow","Green","Purple","Orange","Red","Blue","Yellow","Green","Purple","Orange","Red","Blue","Yellow","Green","Purple","Orange"],datasets:[{label:"Total Ventas",data:[12,19,3,5,2,3],borderWidth:1}]},options:{scales:{y:{beginAtZero:!0,grid:{display:!1}},x:{grid:{display:!1}}},responsive:!0}}),new Chart(n,{type:"doughnut",data:{labels:["Ventas total:","Costo:","Utilidad:"],datasets:[{label:"Total Ventas",data:[19,7,12],backgroundColor:["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 205, 86)"],hoverOffset:4}]},options:{responsive:!0}}),$('input[name="daterange"]').daterangepicker({opens:"right",alwaysShowCalendars:!0}),null==i||i.addEventListener("click",()=>{c.inicio="",c.fin="",o("ventasgenerales"),$('input[name="daterange"]').daterangepicker({opens:"right",alwaysShowCalendars:!0}),$('input[name="daterange"]').on("apply.daterangepicker",(function(e,t){var o=t.startDate.format("YYYY-MM-DD"),a=t.endDate.format("YYYY-MM-DD");c.inicio=o,c.fin=a}))}),r.addEventListener("click",()=>{c.inicio="",c.fin="",o("cierrescaja"),$('input[name="daterange"]').daterangepicker(),$('input[name="daterange"]').on("apply.daterangepicker",(function(e,t){c.inicio=t.startDate.format("YYYY-MM-DD"),c.fin=t.endDate.format("YYYY-MM-DD")}))})}}(),(()=>{if(document.querySelector(".paginadorventas")){const o=document.querySelectorAll(".filtrocategorias");var e=new List("hacker-list",{valueNames:["card-producto",{data:["categoria","code"]}],page:18,pagination:!0});o.forEach(t=>{t.addEventListener("click",t=>{const o=t.target.dataset.categoria;e.filter(e=>"Todos"===o||e.values().categoria===o)})});const a=document.querySelector("#btnCarritoMovil"),n=document.getElementById("contenidocarrito"),i=document.getElementById("contenedorDesktop"),r=document.getElementById("miDialogoCarritoMovil"),c=document.querySelector("#btnCerrarCarritoMovil");function t(e){e.target===r&&(r.close(),document.removeEventListener("click",t))}window.innerWidth<992&&r.appendChild(n),window.addEventListener("resize",()=>{window.innerWidth>=992?(i.appendChild(n),r.close(),document.removeEventListener("click",t)):r.appendChild(n)}),null==a||a.addEventListener("click",e=>{r.showModal(),document.addEventListener("click",t)}),c.addEventListener("click",()=>{r.close(),document.removeEventListener("click",t)})}})();__awaiter=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function c(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,c)}d((a=a.apply(e,t||[])).next())}))};(()=>{var e,t,o,a,n,i;if(document.querySelector(".ventas")){const p=document.querySelector("#addcliente"),f=document.querySelector("#adddir"),g=document.querySelector("#selectCliente"),y=document.querySelector("#direccionEntrega"),b=document.querySelector("#facturarA"),S=(document.querySelectorAll("#producto"),document.querySelector("#productos")),h=document.querySelector("#btnotros"),q=document.querySelector("#btndescuento"),E=document.querySelector("#btnEntrega"),x=document.querySelector("#modalidadEntrega"),w=document.querySelector("#totalunidades"),C=document.querySelector("#tablaventa tbody"),L=document.querySelector("#btnvaciar"),k=document.querySelector("#btnguardar"),j=document.querySelector("#btnfacturar"),_=document.querySelector("#miDialogoAddCliente"),D=document.querySelector("#miDialogoAddDir"),T=document.querySelector("#miDialogoOtrosProductos"),P=document.querySelector("#miDialogoFacturarA"),N=document.querySelector("#miDialogoDescuento"),A=document.querySelector("#miDialogoVaciar"),I=document.querySelector("#miDialogoGuardar"),M=document.querySelector("#miDialogoFacturar"),B=document.querySelector("#caja"),F=document.querySelector("#facturador"),O=document.querySelectorAll(".mediopago"),U=document.querySelectorAll('input[name="tipodescuento"]'),z=document.querySelector("#inputDescuento");let Y=[];const R={subtotal:0,base:0,valorimpuestototal:0,dctox100:0,descuento:0,idtarifa:0,valortarifa:0,total:0};let G=[],H="",J=0;const V={0:0,5:.0476190476190476,8:.0740740740740741,16:.1379310344827586,19:.1596638655462185};let W={id:0,nombre:"",cantidad:0,valorunidad:0,total:0},X=[];const Z=new Map;function r(e){for(;null==y?void 0:y.firstChild;)y.removeChild(null==y?void 0:y.firstChild);const t=new Set;G.length=0,e.forEach(e=>{const o=document.createElement("option");o.textContent=e.direccion,o.value=e.id,o.dataset.idcliente=e.idcliente,o.dataset.idtarifa=e.idtarifa,o.dataset.ciudad=e.ciudad,y.appendChild(o),e.tarifa.idcliente=e.idcliente,t.has(e.tarifa.id)||(G=[...G,e.tarifa],t.add(e.tarifa.id))}),t.clear(),c(),l(),document.querySelector("#ciudadEntrega").value=e[0].ciudad}function c(){const e=y.options[y.selectedIndex];if(": Presencial"==x.textContent||-1==y.selectedIndex)return R.valortarifa=0,void(H="");if((null==e?void 0:e.dataset.idtarifa)&&": Domicilio"==x.textContent){const t=G.find(t=>{if(t.idcliente==e.dataset.idcliente&&t.id==e.dataset.idtarifa)return!0});R.valortarifa=Number(null==t?void 0:t.valor),R.idtarifa=Number(null==t?void 0:t.id),H=null==t?void 0:t.nombre}}function d(e,t,o,a){var n,i;const r=Y.findIndex(t=>t.idproducto==e);if(r>-1)t<=0&&(t=0,Y[r].total=0),o?Y[r].cantidad+=t:Y[r].cantidad=t,Y[r].total=parseInt(Y[r].valorunidad)*Y[r].cantidad,Y[r].valorimp=parseFloat((Y[r].total*V[Y[r].impuesto]).toFixed(3)),Y[r].base=parseFloat((Y[r].total-Y[r].valorimp).toFixed(3)),l(),a&&((null==C?void 0:C.querySelector(`TR[data-id="${e}"] .inputcantidad`)).value=Y[r].cantidad+""),(null===(i=null===(n=null==C?void 0:C.querySelector(`TR[data-id="${e}"]`))||void 0===n?void 0:n.children)||void 0===i?void 0:i[3]).textContent="$"+Y[r].total.toLocaleString();else{const o=X.find(t=>t.id==e),a=Number(o.precio_venta)*t*V[o.impuesto],n=Number(o.precio_venta)*t;var c={id:null==o?void 0:o.id,idproducto:null==o?void 0:o.id,tipoproducto:o.tipoproducto,tipoproduccion:o.tipoproduccion,idcategoria:o.idcategoria,nombreproducto:o.nombre,rendimientoestandar:o.rendimientoestandar,foto:o.foto,valorunidad:o.precio_venta,cantidad:t,subtotal:n,base:n-a,impuesto:o.impuesto,valorimp:a,descuento:0,total:n};Y=[...Y,c],l(),function(e){const t=Y.find(t=>t.id==e),o=document.createElement("TR");o.classList.add("productselect"),o.dataset.id=""+e,o.insertAdjacentHTML("afterbegin",`<td class="!px-0 !py-2 text-xl text-gray-500 leading-5">${null==t?void 0:t.nombreproducto}</td> \n\n      <td class="!px-0 !py-2">\n        <div class="flex items-center gap-2 px-4">\n          <button type="button" class="w-8 h-8 bg-indigo-700 text-white rounded-full flex items-center justify-center">\n            <span class="menos material-symbols-outlined text-base">remove</span>\n          </button>\n\n          <input type="text" class="inputcantidad w-20 px-2 text-center" value="${t.cantidad}"\n            >\n\n          <button type="button" class="w-8 h-8 bg-indigo-700 text-white rounded-full flex items-center justify-center">\n            <span class="mas material-symbols-outlined text-base">add</span>\n          </button>\n        </div>\n      </td>\n\n\n      <td class="!p-2 text-xl text-gray-500 leading-5">$${Number(null==t?void 0:t.valorunidad).toLocaleString()}</td>\n      <td class="!p-2 text-xl text-gray-500 leading-5">$${Number(null==t?void 0:t.total).toLocaleString()}</td>\n      <td class="accionestd"><div class="acciones-btns"><button class="btn-md btn-red eliminarProducto"><i class="fa-solid fa-trash-can"></i></button></div></td>`),null==C||C.appendChild(o)}(e)}}function l(){const e=new Map;Y.forEach(t=>{if(e.has(t.impuesto)){const o=e.get(t.impuesto)+t.total*V[t.impuesto];e.set(t.impuesto,o)}else e.set(t.impuesto,t.total*V[t.impuesto])});let t=0;for(let o of e.values())t+=o;R.valorimpuestototal=parseFloat(t.toFixed(3)),R.subtotal=Y.reduce((e,t)=>t.total+e,0),R.base=R.subtotal-R.valorimpuestototal,R.total=R.subtotal+R.valortarifa-R.descuento,document.querySelector("#subTotal").textContent="$"+R.subtotal.toLocaleString(),document.querySelector("#impuesto").textContent="$"+t.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}),document.querySelector("#valorTarifa").textContent="$"+R.valortarifa.toLocaleString(),document.querySelector("#total").textContent="$ "+R.total.toLocaleString(),w.textContent=Y.reduce((e,t)=>t.cantidad+e,0)+""}function u(e){e=e.replace(/[,.]/g,""),Number(e)>Z.get("1")?document.querySelector("#cambio").textContent=(Number(e)-Z.get("1")).toLocaleString()+"":document.querySelector("#cambio").textContent="0"}function s(e){const t=e.target;(t===N||t===A||t===I||t===M||t===_||t===T||t===P||t===D||t.closest(".salir")||t.closest(".novaciar")||t.closest(".sivaciar")||t.closest(".noguardar")||t.closest(".siguardar")||"Cancelar"==t.value)&&(N.close(),A.close(),I.close(),M.close(),_.close(),D.close(),P.close(),T.close(),document.removeEventListener("click",s),t.closest(".siguardar")&&v("Guardado","1"),t.closest(".sivaciar")&&m())}function m(){for(Z.clear(),$(".mediopago").val(0),Y.length=0;null==C?void 0:C.firstChild;)C.removeChild(null==C?void 0:C.firstChild);document.querySelector("#subTotal").textContent="$0",document.querySelector("#descuento").textContent="$0",document.querySelector("#total").textContent="$0",$("#selectCliente").val(1).trigger("change");for(const e in R)R[e]=0}function v(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=new FormData;o.append("idcliente",document.querySelector("#selectCliente").value),o.append("idvendedor",document.querySelector("#vendedor").dataset.idvendedor),o.append("idcaja",B.value),o.append("idconsecutivo",F.value),o.append("iddireccion",y.value),o.append("idtarifazona",R.idtarifa+""),o.append("cliente",g.options[g.selectedIndex].textContent),o.append("vendedor",document.querySelector("#vendedor").value),o.append("caja",document.querySelector("#caja option:checked").textContent),o.append("tipofacturador",F.options[F.selectedIndex].textContent),o.append("direccion",y.options[y.selectedIndex].text),o.append("tarifazona",H||""),o.append("carrito",JSON.stringify(Y.filter(e=>e.cantidad>0))),o.append("totalunidades",w.textContent),o.append("mediosPago",JSON.stringify(Array.from(Z,([e,t])=>({idmediopago:e,id_factura:0,valor:t})))),o.append("recibido",document.querySelector("#recibio").value),o.append("transaccion",""),o.append("cotizacion",t),o.append("estado",e),o.append("subtotal",R.subtotal+""),o.append("base",R.base+""),o.append("valorimpuestototal",R.valorimpuestototal+""),o.append("dctox100",R.dctox100+""),o.append("descuento",R.descuento+""),o.append("total",R.total.toString()),o.append("observacion",document.querySelector("#observacion").value),o.append("departamento",""),o.append("ciudad",document.querySelector("#ciudadEntrega").value),o.append("entrega",x.textContent.replace(": ","")),o.append("valortarifa",R.valortarifa+""),o.append("opc1",""),o.append("opc2","");try{const e="/admin/api/facturar",t=yield fetch(e,{method:"POST",body:o}),a=yield t.json();console.log(a),void 0!==a.exito?(msjalertToast("success","¡Éxito!",a.exito[0]),m()):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}M.close(),document.getElementById("miDialogoCarritoMovil").close(),document.removeEventListener("click",s)}))}__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/allproducts",t=yield fetch(e);X=yield t.json(),console.log(X)}catch(e){console.log(e)}})),$("#selectCliente").select2(),null==p||p.addEventListener("click",e=>{_.showModal(),document.addEventListener("click",s)}),null==f||f.addEventListener("click",e=>{D.showModal(),document.addEventListener("click",s)}),null===(e=document.querySelector("#formAddCliente"))||void 0===e||e.addEventListener("submit",e=>{e.preventDefault(),__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("nombre",document.querySelector("#nombreclientenuevo").value),e.append("apellido",document.querySelector("#clientenuevoapellido").value),e.append("tipodocumento",document.querySelector("#tipodocumento").value),e.append("identificacion",document.querySelector("#identificacion").value),e.append("telefono",document.querySelector("#telefono").value),e.append("email",document.querySelector("#clientenuevoemail").value),e.append("idtarifa",document.querySelector("#clientenuevotarifa").value),e.append("direccion",document.querySelector("#clientenuevodireccion").value),e.append("departamento",document.querySelector("#departamento").value),e.append("ciudad",document.querySelector("#ciudad").value);try{const t="/admin/api/apiCrearCliente",o=yield fetch(t,{method:"POST",body:e}),a=yield o.json();void 0!==a.exito?(msjalertToast("success","¡Éxito!",a.exito[0]),function(e){const t=document.createElement("option");t.textContent=document.querySelector("#nombreclientenuevo").value+" "+document.querySelector("#clientenuevoapellido").value,t.value=e,t.dataset.tipodocumento=document.querySelector("#tipodocumento").value,t.dataset.identidad=document.querySelector("#identificacion").value,null==g||g.appendChild(t),$("#selectCliente").val(e).trigger("change")}(a.nextID),function(){var e;null===(e=document.querySelector("#formAddCliente"))||void 0===e||e.reset()}()):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}})),_.close(),document.removeEventListener("click",s)}),$("#selectCliente").on("change",e=>{const t=e.target.value;__awaiter(void 0,void 0,void 0,(function*(){try{const e="/admin/api/direccionesXcliente?id="+t,o=yield fetch(e);r(yield o.json())}catch(e){console.log(e)}}));const o=e.target,a=o.options[o.selectedIndex].dataset.identidad||"";document.querySelector("#documento").value=a}),null==y||y.addEventListener("change",e=>{const t=e.target,o=t.options[t.selectedIndex].dataset.ciudad||"";document.querySelector("#ciudadEntrega").value=o,c(),l()}),null===(t=document.querySelector("#formAddDir"))||void 0===t||t.addEventListener("submit",e=>{e.preventDefault(),__awaiter(void 0,void 0,void 0,(function*(){const e=new FormData;e.append("idcliente",g.value),e.append("departamento",document.querySelector("#adddepartamento").value),e.append("ciudad",document.querySelector("#addciudad").value),e.append("direccion",document.querySelector("#adddireccion").value),e.append("idtarifa",document.querySelector("#tarifa").value);try{const t="/admin/api/addDireccionCliente",o=yield fetch(t,{method:"POST",body:e}),a=yield o.json();void 0!==a.exito?(msjalertToast("success","¡Éxito!",a.exito[0]),r(a.direcciones)):msjalertToast("error","¡Error!",a.error[0])}catch(e){console.log(e)}})),D.close(),document.removeEventListener("click",s)}),null==E||E.addEventListener("click",e=>{": Presencial"==x.textContent?x.textContent=": Domicilio":x.textContent=": Presencial",c(),l()}),b.addEventListener("click",e=>{P.showModal(),document.addEventListener("click",s)}),h.addEventListener("click",e=>{T.showModal(),document.addEventListener("click",s)}),null===(o=document.querySelector("#formOtrosProductos"))||void 0===o||o.addEventListener("submit",e=>{e.preventDefault();const t=e.target.elements,o=Number(t.namedItem("cantidadotros").value),a=Number(t.namedItem("preciootros").value);W.id+=-1,W.nombre=t.namedItem("nombreotros").value,W.cantidad=o,W.valorunidad=a/o,W.total=a,X=[...X,{id:W.id+"",idcategoria:"-1",idunidadmedida:"1",nombre:W.nombre,foto:"na",impuesto:"0",marca:"na",tipoproducto:"-1",tipoproduccion:"",codigo:"-1",unidadmedida:"Unidad",descripcion:"na",peso:"na",medidas:"na",color:"na",funcion:"na",uso:"na",fabricante:"na",garantia:"na",stock:"0",stockminimo:"1",categoria:"na",rendimientoestandar:"1",precio_compra:"na",precio_venta:W.valorunidad+"",fecha_ingreso:"",estado:"1",visible:"1"}],d(W.id+"",o,!1,!1),T.close(),document.removeEventListener("click",s)}),null==S||S.addEventListener("click",e=>{var t;const o=null===(t=e.target)||void 0===t?void 0:t.closest(".producto");o&&d(o.dataset.id,1,!0,!0)}),null==C||C.addEventListener("click",e=>{var t,o,a;const n=(null===(t=e.target)||void 0===t?void 0:t.closest(".productselect")).dataset.id;if(e.target.classList.contains("menos")){const e=Y.find(e=>e.idproducto==n);d(n,e.cantidad-1,!1,!0)}if(e.target.classList.contains("inputcantidad")&&"eventInput"!=e.target.dataset.event&&(null===(o=e.target)||void 0===o||o.addEventListener("input",e=>{let t=e.target.value;t=t.replace(/[^0-9.]/g,"");const o=t.split(".");o.length>2&&(t=o[0]+"."+o.slice(1).join("")),t.startsWith(".")&&(t="1"),(""===t||isNaN(parseFloat(t)))&&(t="0"),e.target.value=t,d(n,Number(e.target.value),!1,!1)}),e.target.dataset.event="eventInput"),e.target.classList.contains("mas")){const e=Y.find(e=>e.idproducto==n);d(n,e.cantidad+1,!1,!0)}(e.target.classList.contains("eliminarProducto")||"I"==e.target.tagName)&&(Y=Y.filter(e=>e.idproducto!=n),l(),null===(a=null==C?void 0:C.querySelector(`TR[data-id="${n}"]`))||void 0===a||a.remove())}),null==q||q.addEventListener("click",()=>{Y.length&&(J=R.subtotal,N.showModal(),document.addEventListener("click",s))}),null==L||L.addEventListener("click",()=>{Y.length&&(A.showModal(),document.addEventListener("click",s))}),null==k||k.addEventListener("click",()=>{Y.length&&(I.showModal(),document.addEventListener("click",s))}),null==j||j.addEventListener("click",()=>{": Domicilio"!==x.textContent||"1"!=g.value&&"2"!=g.value&&y.value?Y.length&&(!function(){document.querySelector("#totalPagar").textContent=""+R.total.toLocaleString();let e=0;O.forEach((t,o)=>{o>0&&(e+=parseInt(t.value.replace(/[,.]/g,"")))}),R.total<e&&(e=0,Z.clear(),$(".mediopago").val(0));document.querySelector(".Efectivo").value=""+(R.total-e).toLocaleString(),Z.set("1",R.total-e),R.total-e==0&&Z.has("1")&&Z.delete("1");u(document.querySelector("#recibio").value)}(),M.showModal(),document.addEventListener("click",s)):msjAlert("error","Cliente o direccion no seleccionado",document.querySelector("#divmsjalerta1"))}),U.forEach(e=>{e.addEventListener("change",e=>{"porcentaje"===e.target.value&&(J=100,z.value=""),"valor"===e.target.value&&(z.value="",J=R.subtotal)})}),null==z||z.addEventListener("input",e=>{var t=Number(e.target.value);t>J&&(z.value=J+"",t=J)}),null===(a=document.querySelector("#formDescuento"))||void 0===a||a.addEventListener("submit",e=>{e.preventDefault();const t=Number(z.value);U[0].checked&&(R.dctox100=Math.round(100*t/R.subtotal),R.descuento=t),U[1].checked&&(R.descuento=R.subtotal*t/100,R.dctox100=t),R.total=R.subtotal-R.descuento+R.valortarifa,document.querySelector("#total").textContent="$ "+R.total.toLocaleString(),document.querySelector("#descuento").textContent="$"+R.descuento.toLocaleString(),N.close(),document.removeEventListener("click",s)}),O.forEach(e=>{e.addEventListener("input",e=>{!function(e){var t;let o=0;O.forEach((e,t)=>{t>0&&(o+=parseInt(e.value.replace(/[,.]/g,"")))}),o<=R.total?(Z.set("1",R.total-o),R.total-o==0&&Z.has("1")&&Z.delete("1"),Z.set(e.target.id,parseInt(e.target.value.replace(/[,.]/g,""))),"0"==e.target.value&&Z.has(e.target.id)&&Z.delete(e.target.id)):Z.has(e.target.id)?e.target.value=Z.get(e.target.id).toLocaleString():e.target.value="0";O[0].value=null!==(t=Z.get("1").toLocaleString())&&void 0!==t?t:0,u(document.querySelector("#recibio").value)}(e)})}),null===(n=document.querySelector("#recibio"))||void 0===n||n.addEventListener("input",e=>{u(e.target.value)}),null===(i=document.querySelector("#formfacturar"))||void 0===i||i.addEventListener("submit",e=>{e.preventDefault(),R.total<=0||R.subtotal<=0?msjAlert("error","No se puede procesar pago con $0",document.querySelector("#divmsjalerta2")):v("Paga","0")})}})();
//# sourceMappingURL=bundle.ts.js.map
